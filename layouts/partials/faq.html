{{/*
  FAQ Component with Schema Markup
  Usage in markdown frontmatter:

  faq:
    - question: "What is event-driven architecture?"
      answer: "Event-driven architecture is a software design pattern where components communicate through events rather than direct calls."
    - question: "Which message queue should I use?"
      answer: "For Go applications, NATS is great for lightweight scenarios, RabbitMQ for enterprise features, and Kafka for high-throughput needs."
*/}}

{{ with .Params.faq }}
{{ if gt (len .) 0 }}

<!-- FAQ Section -->
<div class="not-prose my-12 -mx-4 sm:-mx-6 lg:mx-0">
  <div class="max-w-full">
    <!-- Section Header -->
    <div class="mb-8">
      <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-2">
        {{ i18n "frequently_asked_questions" | default "Frequently Asked Questions" }}
      </h2>
      <p class="text-gray-600 dark:text-gray-400">
        {{ i18n "faq_description" | default "Find quick answers to common questions" }}
      </p>
    </div>

    <!-- FAQ Accordion -->
    <ul class="faq-list space-y-0 list-none p-0 m-0">
      {{ range $index, $item := . }}
      <li
        class="faq-item border-b border-gray-200 dark:border-gray-700"
        itemscope
        itemprop="mainEntity"
        itemtype="https://schema.org/Question"
      >
        <details class="faq-details">
          <summary
            class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150"
            itemprop="name"
          >
            <h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">
              {{ .question }}
            </h3>

            <!-- Arrow Icon -->
            <span class="faq-arrow flex-shrink-0 mt-1">
              <svg
                class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </span>
          </summary>

          <!-- Answer Content -->
          <div
            class="pb-6 pt-2"
            itemscope
            itemprop="acceptedAnswer"
            itemtype="https://schema.org/Answer"
          >
            <div
              class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono"
              itemprop="text"
            >
              {{ .answer | markdownify }}
            </div>
          </div>
        </details>
      </li>
      {{ end }}
    </ul>
  </div>
</div>

<!-- FAQ Schema Markup (JSON-LD) for SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {{ range $index, $item := . }}
    {{ if gt $index 0 }},{{ end }}
    {
      "@type": "Question",
      "name": {{ .question | jsonify }},
      "acceptedAnswer": {
        "@type": "Answer",
        "text": {{ .answer | plainify | jsonify }}
      }
    }
    {{ end }}
  ]
}
</script>

<!-- FAQ Arrow Rotation CSS -->
<style>
  details.faq-details[open] .faq-arrow svg {
    transform: rotate(180deg);
  }
</style>

<!-- FAQ Auto-Close Script (Optional: Close other FAQs when one is opened) -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const faqItems = document.querySelectorAll('.faq-item');

    faqItems.forEach(function(item) {
      item.addEventListener('toggle', function() {
        if (this.open) {
          // Close all other FAQ items when this one is opened
          faqItems.forEach(function(otherItem) {
            if (otherItem !== item && otherItem.open) {
              otherItem.open = false;
            }
          });
        }
      });
    });
  });
</script>

{{ end }}
{{ end }}
