<!doctype html><html lang=en data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>How to Implement Multi-Factor Authentication (2FA) in Laravel with Laravel Fortify | Buana Coding</title><meta name=description content="Complete guide to implementing Two-Factor Authentication (2FA) in Laravel using Laravel Fortify. Learn TOTP setup with Google Authenticator, QR code generation, recovery codes, security best practices, and production deployment."><meta name=keywords content="laravel 2fa,laravel fortify,two factor authentication laravel,laravel totp,google authenticator laravel,laravel fortify 2fa,laravel security,laravel authentication,2fa implementation,laravel recovery codes"><link rel=canonical href=https://www.buanacoding.com/2025/10/laravel-two-factor-authentication-2fa-fortify.html><link rel=alternate hreflang=en href=https://www.buanacoding.com/2025/10/laravel-two-factor-authentication-2fa-fortify.html><meta property="og:type" content="article"><meta property="og:title" content="How to Implement Multi-Factor Authentication (2FA) in Laravel with Laravel Fortify | Buana Coding"><meta property="og:description" content="Complete guide to implementing Two-Factor Authentication (2FA) in Laravel using Laravel Fortify. Learn TOTP setup with Google Authenticator, QR code generation, recovery codes, security best practices, and production deployment."><meta property="og:url" content="https://www.buanacoding.com/2025/10/laravel-two-factor-authentication-2fa-fortify.html"><meta property="og:image" content="https://www.buanacoding.com/images/og-image.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="How to Implement Multi-Factor Authentication (2FA) in Laravel with Laravel Fortify | Buana Coding"><meta name=twitter:description content="Complete guide to implementing Two-Factor Authentication (2FA) in Laravel using Laravel Fortify. Learn TOTP setup with Google Authenticator, QR code generation, recovery codes, security best practices, and production deployment."><meta name=twitter:image content="https://www.buanacoding.com/images/og-image.jpg"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to Implement Multi-Factor Authentication (2FA) in Laravel with Laravel Fortify | Buana Coding","description":"Complete guide to implementing Two-Factor Authentication (2FA) in Laravel using Laravel Fortify. Learn TOTP setup with Google Authenticator, QR code generation, recovery codes, security best practices, and production deployment.","inLanguage":"en","datePublished":"2025-10-22T10:00:00\u002b07:00","dateModified":"2025-10-22T10:00:00\u002b07:00","author":{"@type":"Person","name":"Wiku Karno"},"mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.buanacoding.com\/2025\/10\/laravel-two-factor-authentication-2fa-fortify.html"},"image":"https:\/\/www.buanacoding.com\/images\/og-image.jpg","publisher":{"@type":"Organization","name":"Buana Coding"}}</script><link rel=icon href=/favicon.ico type=image/x-icon><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel=stylesheet><link rel=stylesheet href="/style.css?v=1761550485"><link rel=stylesheet href="/css/overrides.css?v=1761550485"><link rel=stylesheet href="/css/syntax.css?v=1761550485"><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("consent","default",{ad_storage:"granted",ad_user_data:"granted",ad_personalization:"granted",analytics_storage:"granted"})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-0EN9J73FXF"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0EN9J73FXF")</script><script async src="https://fundingchoicesmessages.google.com/i/pub-3149036684216973?ers=1"></script><script>(function(){function e(){if(!window.frames.googlefcPresent)if(document.body){const e=document.createElement("iframe");e.style="width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;",e.style.display="none",e.name="googlefcPresent",document.body.appendChild(e)}else setTimeout(e,0)}e()})()</script><script>(function(){"use strict";function at(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}Z=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype?e:(e[t]=n.value,e)};function Ge(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t,n=0;n<e.length;++n)if(t=e[n],t&&t.Math==Math)return t;throw Error("Cannot find global object")}Pe=Ge(this);function c(e,t){if(t)a:{var n,o,s=Pe;e=e.split(".");for(n=0;n<e.length-1;n++){if(o=e[n],!(o in s))break a;s=s[o]}e=e[e.length-1],n=s[e],t=t(n),t!=n&&t!=null&&Z(s,e,{configurable:!0,writable:!0,value:t})}}function G(e){return e.raw=e}function b(e){var t=typeof Symbol!="undefined"&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if(typeof e.length=="number")return{next:at(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}function Xe(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}if(Se=typeof Object.create=="function"?Object.create:function(e){function t(){}return t.prototype=e,new t},typeof Object.setPrototypeOf=="function")R=Object.setPrototypeOf;else{a:{we={a:!0},V={};try{V.__proto__=we,P=V.a;break a}catch{}P=!1}R=P?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}W=R;function K(e,t){if(e.prototype=Se(t.prototype),e.prototype.constructor=e,W)W(e,t);else for(n in t)if(n!="prototype")if(Object.defineProperties){var n,s=Object.getOwnPropertyDescriptor(t,n);s&&Object.defineProperty(e,n,s)}else e[n]=t[n];e.A=t.prototype}function Q(){for(var t=Number(this),n=[],e=t;e<arguments.length;e++)n[e-t]=arguments[e];return n}c("Object.is",function(e){return e||function(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}}),c("Array.prototype.includes",function(e){return e||function(e,t){var s,o,n=this;n instanceof String&&(n=String(n)),s=n.length,t=t||0;for(t<0&&(t=Math.max(t+s,0));t<s;t++)if(o=n[t],o===e||Object.is(o,e))return!0;return!1}}),c("String.prototype.includes",function(e){return e||function(e,t){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(e,t||0)!==-1}}),c("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991}),c("Number.isFinite",function(e){return e||function(e){return typeof e=="number"&&!isNaN(e)&&e!==1/0&&e!==-(1/0)}}),c("Number.isInteger",function(e){return e||function(e){return!!Number.isFinite(e)&&e===Math.floor(e)}}),c("Number.isSafeInteger",function(e){return e||function(e){return Number.isInteger(e)&&(e<0?-e:e)<=Number.MAX_SAFE_INTEGER}}),c("Math.trunc",function(e){return e||function(e){if(e=Number(e),isNaN(e)||e===1/0||e===-(1/0)||e===0)return e;var t=Math.floor(e<0?-e:e);return e<0?-t:t}}),e=this||self;function _(t,n){a:{for(var s=["CLOSURE_FLAGS"],o=e,i=0;i<s.length;i++)if(o=o[s[i]],o==null){s=null;break a}s=o}return t=s&&s[t],t??n}function q(e){return e}function ct(t){e.setTimeout(function(){throw t},0)}var ae=_(610401301,!1),ot=_(188588736,!0),et=_(645172343,_(1,!0)),Oe=e.navigator,O=Oe?Oe.userAgentData||null:null;function L(e){return!!ae&&!!O&&O.brands.some(function(t){return(t=t.brand)&&t.indexOf(e)!=-1})}function s(t){var n;a:{if((n=e.navigator)&&(n=n.userAgent))break a;n=""}return n.indexOf(t)!=-1}function r(){return!!ae&&!!O&&O.brands.length>0}function F(){return r()?L("Chromium"):(s("Chrome")||s("CriOS"))&&!(r()?0:s("Edge"))||s("Silk")}be=!r()&&(s("Trident")||s("MSIE")),!s("Android")||F(),F(),s("Safari")&&(F()||(r()?0:s("Coast"))||(r()?0:s("Opera"))||(r()?0:s("Edge"))||(r()?L("Microsoft Edge"):s("Edg/"))||r()&&L("Opera")),M={},v=null,T=typeof Uint8Array!="undefined",He=!be&&typeof btoa=="function";function N(){return typeof BigInt=="function"}g=typeof Symbol=="function"&&typeof Symbol()=="symbol";function xe(e){return typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():e}var Z,Pe,Se,t,R,P,we,e,n,O,V,W,be,v,M,T,He,Te,m,g,X,oe,C,E,Ae,j,Fe,le,re,ie,x=xe(),H=xe("2ex"),ye=g?function(e,t){e[x]|=t}:function(e,t){e.g!==0[0]?e.g|=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}})},h=g?function(e){return e[x]|0}:function(e){return e.g|0},d=g?function(e){return e[x]}:function(e){return e.g},l=g?function(e,t){e[x]=t}:function(e,t){e.g!==0[0]?e.g=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}})};function it(e,t){l(t,(e|0)&-14591)}function U(e,t){l(t,(e|34)&-14557)}m={},X={};function Ie(e){return!(!e||typeof e!="object"||e.g!==X)}function S(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function y(e,t,n){if(!Array.isArray(e)||e.length)return!1;var s=h(e);return!!(s&1)||!!(t&&(Array.isArray(t)?t.includes(n):t.has(n)))&&(l(e,s|1),!0)}t=0,n=0;function J(e){var s=e>>>0;t=s,n=(e-s)/4294967296>>>0}function ee(e){if(e<0){J(-e);var s=b(A(t,n));e=s.next().value,s=s.next().value,t=e>>>0,n=s>>>0}else J(e)}function te(e,t){if(t>>>=0,e>>>=0,t<=2097151)var n=""+(4294967296*t+e);else N()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(n=(e>>>24|t<<8)&16777215,t=t>>16&65535,e=(e&16777215)+n*6777216+t*6710656,n+=t*8147497,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+ne(n)+ne(e));return n}function ne(e){return e=String(e),"0000000".slice(e.length)+e}function A(e,t){return t=~t,e?e=~e+1:t+=1,[e,t]}oe=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function $(e,t){return E=t,e=new e(t),E=0[0],e}function k(e,t,n){if(e==null&&(e=E),E=0[0],e==null){var o,i,s=96;n?(e=[n],s|=512):e=[],t&&(s=s&-16760833|(t&1023)<<14)}else{if(!Array.isArray(e))throw Error("narr");if(s=h(e),s&2048)throw Error("farr");if(s&64)return e;if(s|=64,n&&(s|=512,n!==e[0]))throw Error("mid");a:{if(n=e,o=n.length,o&&(i=o-1,S(n[i]))){if(s|=256,t=i-(+!!(s&512)-1),t>=1024)throw Error("pvtlmt");s=s&-16760833|(t&1023)<<14;break a}if(t){if(t=Math.max(t,o-(+!!(s&512)-1)),t>1024)throw Error("spvt");s=s&-16760833|(t&1023)<<14}}}return l(e,s),e}function st(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"boolean":return e?1:0;case"object":if(e)if(Array.isArray(e)){if(y(e,0[0],0))return}else if(T&&e!=null&&e instanceof Uint8Array){if(He){for(var n,o,i,a,c,l,t="",s=0,r=e.length-10240;s<r;)t+=String.fromCharCode.apply(null,e.subarray(s,s+=10240));t+=String.fromCharCode.apply(null,s?e.subarray(s):e),e=btoa(t)}else{if(t===0[0]&&(t=0),!v){v={},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),r=["+/=","+/","-_=","-_.","-_"];for(a=0;a<5;a++){n=s.concat(r[a].split("")),M[a]=n;for(o=0;o<n.length;o++)i=n[o],v[i]===0[0]&&(v[i]=o)}}t=M[t],s=Array(Math.floor(e.length/3)),r=t[64]||"";for(a=n=0;n<e.length-2;n+=3)c=e[n],l=e[n+1],i=e[n+2],o=t[c>>2],c=t[(c&3)<<4|l>>4],l=t[(l&15)<<2|i>>6],i=t[i&63],s[a++]=o+c+l+i;switch(o=0,i=r,e.length-n){case 2:o=e[n+1],i=t[(o&15)<<2]||r;case 1:e=e[n],s[a]=t[e>>2]+t[(e&3)<<4|o>>4]+i+r}e=s.join("")}return e}}return e}function nt(e,t,n){e=Array.prototype.slice.call(e);var i,o=e.length,s=t&256?e[o-1]:0[0];o+=s?-1:0;for(t=t&512?1:0;t<o;t++)e[t]=n(e[t]);if(s){t=e[t]={};for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=n(s[i]))}return e}function de(e,t,n,s,o){if(e!=null){if(Array.isArray(e))e=y(e,0[0],0)?0[0]:o&&h(e)&2?e:B(e,t,n,s!==0[0],o);else if(S(e)){var i,a={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=de(e[i],t,n,s,o));e=a}else e=t(e,s);return e}}function B(e,t,n,s,o){var i,a=s||n?h(e):0;s=s?!!(a&32):0[0],e=Array.prototype.slice.call(e);for(i=0;i<e.length;i++)e[i]=de(e[i],t,n,s,o);return n&&n(a,e),e}function We(e){return e.s===m?e.toJSON():st(e)}function me(e,t,n){if(n=n===0[0]?U:n,e!=null){if(T&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var s=h(e);return s&2?e:(t&&(t=s===0||!!(s&32)&&!(s&64||!(s&16))),t?(l(e,(s|34)&-12293),e):B(e,me,s&4?U:n,!0,!0))}return e.s===m&&(n=e.h,s=d(n),e=s&2?e:$(e.constructor,fe(n,s,!0))),e}}function fe(e,t,n){var s=n||t&2?U:it,o=!!(t&32);return e=nt(e,t,function(e){return me(e,o,s)}),ye(e,32|(n?2:0)),e}function pe(e,t){return e=e.h,ve(e,d(e),t)}function ge(e,t,n,s){if(t=s+(+!!(t&512)-1),!(t<0||t>=e.length||t>=n))return e[t]}function ve(e,t,n,s){if(n===-1)return null;var o,a,i=t>>14&1023||536870912;if(n>=i){if(t&256)return e[e.length-1][n]}else return a=e.length,s&&t&256&&(s=e[a-1][n],s!=null)?(ge(e,t,i,n)&&H!=null&&(e=(o=Te)!=null?o:Te={},o=e[H]||0,o>=4||(e[H]=o+1,o=Error(),o.__closure__error__context__984382||(o.__closure__error__context__984382={}),o.__closure__error__context__984382.severity="incident",ct(o))),s):ge(e,t,i,n)}function Y(e,t,n,s,o){var i,a=t>>14&1023||536870912;if(n>=a||o&&!et){if(i=t,t&256)o=e[e.length-1];else{if(s==null)return;o=e[a+(+!!(t&512)-1)]={},i|=256}o[n]=s,n<a&&(e[n+(+!!(t&512)-1)]=0[0]),i!==t&&l(e,i)}else e[n+(+!!(t&512)-1)]=s,t&256&&(e=e[e.length-1],n in e&&delete e[n])}function je(e,t){var a,r,s=he,c=c!==0[0]&&c,o=e.h,i=d(o),n=ve(o,i,t,c);return n!=null&&typeof n=="object"&&n.s===m?s=n:Array.isArray(n)?(a=h(n),r=a,r===0&&(r|=i&32),r|=i&2,r!==a&&l(n,r),s=new s(n)):s=0[0],s!==n&&s!=null&&Y(o,i,t,s,c),o=s,o==null?o:(e=e.h,i=d(e),i&2||(n=o,s=n.h,a=d(s),n=a&2?$(n.constructor,fe(s,a,!1)):n,n!==o&&(o=n,Y(e,i,t,o,c))),o)}function I(e,t){return e=pe(e,t),e==null||typeof e=="string"?e:0[0]}function _e(e,s){if(i=i===0[0]?0:i,e=pe(e,s),e!=null)if(s=typeof e,s==="number"?Number.isFinite(e):s!=="string"?0:oe.test(e)){if(typeof e=="number")e=e|0,!Number.isSafeInteger(e)&&(ee(e),s=t,o=n,(e=o&2147483648)&&(s=~s+1>>>0,o=~o>>>0,s==0&&(o=o+1>>>0)),s=o*4294967296+(s>>>0),e=e?-s:s);else if(s=Number(e)|0,Number.isSafeInteger(s))e=String(s);else if(s=e.indexOf("."),s!==-1&&(e=e.substring(0,s)),!(e[0]==="-"?e.length<20||e.length===20&&Number(e.substring(0,7))>-922337:e.length<19||e.length===19&&Number(e.substring(0,6))<922337)){if(e.length<16)ee(Number(e));else if(N())e=BigInt(e),t=Number(e&BigInt(4294967295))>>>0,n=Number(e>>BigInt(32)&BigInt(4294967295));else{s=+(e[0]==="-"),n=t=0,o=e.length;for(var o,i,a=s,r=(o-s)%6+s;r<=o;a=r,r+=6)a=Number(e.slice(a,r)),n*=1e6,t=t*1e6+a,t>=4294967296&&(n+=t/4294967296|0,n>>>=0,t>>>=0);s&&(s=b(A(t,n)),e=s.next().value,s=s.next().value,t=e,n=s)}e=t,s=n,s&2147483648?N()?e=""+(BigInt(s|0)<<BigInt(32)|BigInt(e>>>0)):(s=b(A(e,s)),e=s.next().value,s=s.next().value,e="-"+te(e,s)):e=te(e,s)}}else e=0[0];return e??i}function a(e,t){var n=n===0[0]?"":n;return e=I(e,t),e??n}function u(e,t,n){this.h=k(e,t,n)}u.prototype.toJSON=function(){return Ce(this)},u.prototype.s=m,u.prototype.toString=function(){try{return C=!0,Ce(this).toString()}finally{C=!1}};function Ce(e){if(a=C?e.h:B(e.h,We,0[0],0[0],!1),m=!C,h=ot?0[0]:e.constructor.v,l=d(m?e.h:a),e=a.length){var t,n,s,o,i,a,l,u,h,m,f,c=a[e-1],r=S(c);if(r?e--:c=0[0],l=+!!(l&512)-1,i=a,r){b:{if(s=c,n={},r=!1,s)for(t in s)Object.prototype.hasOwnProperty.call(s,t)&&(isNaN(+t)?n[t]=s[t]:(o=s[t],Array.isArray(o)&&(y(o,h,+t)||Ie(o)&&o.size===0)&&(o=null),o==null&&(r=!0),o!=null&&(n[t]=o)));if(r){for(u in n)break b;n=null}else n=s}s=n==null?c!=null:n!==c}for(;e>0;e--){if(u=e-1,t=i[u],u-=l,!(t==null||y(t,h,u)||Ie(t)&&t.size===0))break;f=!0}(i!==a||s||f)&&(m?(f||s||n)&&(i.length=e):i=Array.prototype.slice.call(i,0,e),n&&i.push(n)),a=i}return a}function Ee(e){return function(t){if(t==null||t=="")t=new e;else{if(t=JSON.parse(t),!Array.isArray(t))throw Error("dnarr");ye(t,32),t=$(e,t)}return t}}function ke(e){this.h=k(e)}K(ke,u),Ae=Ee(ke);function w(e){this.g=e}w.prototype.toString=function(){return this.g+""},Fe={};function D(t){if(j===0[0]){var n=null,s=e.trustedTypes;if(s&&s.createPolicy){try{n=s.createPolicy("goog#html",{createHTML:q,createScript:q,createScriptURL:q})}catch(t){e.console&&e.console.error(t.message)}j=n}else j=n}return t=(n=j)?n.createScriptURL(t):t,new w(t,Fe)}function ze(e){if(t=Q.apply(1,arguments),t.length===0)return D(e[0]);for(var t,s=e[0],n=0;n<t.length;n++)s+=encodeURIComponent(t[n])+e[n+1];return D(s)}function Ye(e,t){e.src=t instanceof w&&t.constructor===w?t.g:"type_error:TrustedResourceUrl";var n,s;(n=(t=(s=(n=(e.ownerDocument&&e.ownerDocument.defaultView||window).document).querySelector)==null?0[0]:s.call(n,"script[nonce]"))?t.nonce||t.getAttribute("nonce")||"":"")&&e.setAttribute("nonce",n)}function Ne(){return Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)}function Le(e,t){return t=String(t),e.contentType==="application/xhtml+xml"&&(t=t.toLowerCase()),e.createElement(t)}function Re(t){this.g=t||e.document||document}function qe(e){return e=e===0[0]?document:e,e.createElement("script")}function z(e,t,n,s,o,i){try{var r=e.g,a=qe(r);a.async=!0,Ye(a,t),r.head.appendChild(a),a.addEventListener("load",function(){o(),s&&r.head.removeChild(a)}),a.addEventListener("error",function(){n>0?z(e,t,n-1,s,o,i):(s&&r.head.removeChild(a),i())})}catch{i()}}var Ke=e.atob("aHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vaW1hZ2VzL2ljb25zL21hdGVyaWFsL3N5c3RlbS8xeC93YXJuaW5nX2FtYmVyXzI0ZHAucG5n"),Ue=e.atob("WW91IGFyZSBzZWVpbmcgdGhpcyBtZXNzYWdlIGJlY2F1c2UgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlIGlzIGludGVyZmVyaW5nIHdpdGggdGhpcyBwYWdlLg=="),Je=e.atob("RGlzYWJsZSBhbnkgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlLCB0aGVuIHJlbG9hZCB0aGlzIHBhZ2Uu");function tt(e,t,n){this.i=e,this.u=t,this.o=n,this.g=null,this.j=[],this.m=!1,this.l=new Re(this.i)}function Ve(t){if(t.i.body&&!t.m){var n=function(){Be(t),e.setTimeout(function(){Me(t,3)},50)};z(t.l,t.u,2,!0,function(){e[t.o]||n()},n),t.m=!0}}function Be(e){for(var s,a,r,c,t=o(1,5),n=0;n<t;n++)s=i(e),e.i.body.appendChild(s),e.j.push(s);t=i(e),t.style.bottom="0",t.style.left="0",t.style.position="fixed",t.style.width=o(100,110).toString()+"%",t.style.zIndex=o(2147483544,2147483644).toString(),t.style.backgroundColor=De(249,259,242,252,219,229),t.style.boxShadow="0 0 12px #888",t.style.color=De(0,10,0,10,0,10),t.style.display="flex",t.style.justifyContent="center",t.style.fontFamily="Roboto, Arial",n=i(e),n.style.width=o(80,85).toString()+"%",n.style.maxWidth=o(750,775).toString()+"px",n.style.margin="24px",n.style.display="flex",n.style.alignItems="flex-start",n.style.justifyContent="center",s=Le(e.l.g,"IMG"),s.className=Ne(),s.src=Ke,s.alt="Warning icon",s.style.height="24px",s.style.width="24px",s.style.paddingRight="16px",a=i(e),r=i(e),r.style.fontWeight="bold",r.textContent=Ue,c=i(e),c.textContent=Je,p(e,a,r),p(e,a,c),p(e,n,s),p(e,n,a),p(e,t,n),e.g=t,e.i.body.appendChild(e.g),t=o(1,5);for(n=0;n<t;n++)s=i(e),e.i.body.appendChild(s),e.j.push(s)}function p(e,t,n){for(var r,s=o(1,5),a=0;a<s;a++)r=i(e),t.appendChild(r);t.appendChild(n),n=o(1,5);for(s=0;s<n;s++)a=i(e),t.appendChild(a)}function o(e,t){return Math.floor(e+Math.random()*(t-e))}function De(e,t,n,s,i,a){return"rgb("+o(Math.max(e,0),Math.min(t,255)).toString()+","+o(Math.max(n,0),Math.min(s,255)).toString()+","+o(Math.max(i,0),Math.min(a,255)).toString()+")"}function i(e){return e=Le(e.l.g,"DIV"),e.className=Ne(),e}function Me(t,n){n<=0||t.g!=null&&t.g.offsetHeight!==0&&t.g.offsetWidth!==0||(Qe(t),Be(t),e.setTimeout(function(){Me(t,n-1)},50))}function Qe(e){for(var n=b(e.j),t=n.next();!t.done;t=n.next())(t=t.value)&&t.parentNode&&t.parentNode.removeChild(t);e.j=[],(n=e.g)&&n.parentNode&&n.parentNode.removeChild(n),e.g=null}function Ze(t,n,s,o,i){function r(t){document.body?c(document.body):t>0?e.setTimeout(function(){r(t-1)},i):n()}function c(s){s.appendChild(a),e.setTimeout(function(){a?(a.offsetHeight!==0&&a.offsetWidth!==0?n():t(),a.parentNode&&a.parentNode.removeChild(a)):t()},o)}var a=$e(s);r(3)}function $e(e){var t=document.createElement("div");return t.className=e,t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.left="-10000px",t.style.top="-10000px",t.style.zIndex="-10000",t}function he(e){this.h=k(e)}K(he,u);function ue(e){this.h=k(e)}K(ue,u),le=Ee(ue);function ce(e){if(!e)return null;e=I(e,4);var t;return e==null?t=null:t=D(e),t}re=G([""]),ie=G([""]);function se(e,t){this.m=e,this.o=new Re(e.document),this.g=t,this.j=a(this.g,1),this.u=ce(je(this.g,2))||ze(re),this.i=!1,t=ce(je(this.g,13))||ze(ie),this.l=new tt(e.document,t,a(this.g,12))}se.prototype.start=function(){rt(this)};function rt(t){lt(t),z(t.o,t.u,3,!1,function(){a:{var o,n=t.j,s=e.btoa(n);if(s=e[s]){try{o=Ae(e.atob(s))}catch{n=!1;break a}n=n===I(o,1)}else n=!1}n?f(t,a(t.g,14)):(f(t,a(t.g,8)),Ve(t.l))},function(){Ze(function(){f(t,a(t.g,7)),Ve(t.l)},function(){return f(t,a(t.g,6))},a(t.g,9),_e(t.g,10),_e(t.g,11))})}function f(e,t){e.i||(e.i=!0,e=new e.m.XMLHttpRequest,e.open("GET",t,!0),e.send())}function lt(t){var n=e.btoa(t.j);t.m[n]&&f(t,a(t.g,5))}(function(t,n){e[t]=function(){var s=Q.apply(0,arguments);e[t]=function(){},n.call.apply(n,[null].concat(s instanceof Array?s:Xe(b(s))))}})("__h82AlnkH6D91__",function(e){typeof window.atob=="function"&&new se(window,le(window.atob(e))).start()})}).call(this),window.__h82AlnkH6D91__("WyJwdWItMzE0OTAzNjY4NDIxNjk3MyIsW251bGwsbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9iL3B1Yi0zMTQ5MDM2Njg0MjE2OTczIl0sbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9lbC9BR1NLV3hXRW1tb2ZrZGEwZHlSNkcxMkdNSnNEZDF5UFF4a3FSYS11R2NVem9LZHh6NGFxNndzZm5DN3VPekxfWmljWUZvSW5iYnNKRGtFUUU1a1RUNFFGb25MMF9nXHUwMDNkXHUwMDNkP3RlXHUwMDNkVE9LRU5fRVhQT1NFRCIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFZVeXNCQ3NSc2llS3ExOENZVDNibVVqbFREbTVKM01FR1BSdUVoRjFsV3c3UjVNdGRwWnhNM2hJQm1tMnZhbjNmVWxZcVNLSnoycE5xMWNSTUJZYUxfLXdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QxXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFVvQ2JlQlRkS2gzZmU0NnB1VERhek9PdHN0b0p3NjhKUU5SOGQ1OFgwWm9QRlV0LUZPUm1HU1ZJajM2WXQwQjU3c0t1bUFmcjFNWU5JV3U3U3JXNi1EQkFcdTAwM2RcdTAwM2Q/YWJcdTAwM2QyXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFdORXhuRXA0STJueGlBNXdiejVRMDZzT0Njek53bFltRXo4cWhOY0sxZzd2N1UwR2ZVZ0hJOFlPeWk1Qms2NGljWTNzU3BMRE9IZ3pSNTg0VlA5ak5sZmdcdTAwM2RcdTAwM2Q/c2JmXHUwMDNkMiIsImRpdi1ncHQtYWQiLDIwLDEwMCwiY0hWaUxUTXhORGt3TXpZMk9EUXlNVFk1TnpNXHUwMDNkIixbbnVsbCxudWxsLG51bGwsImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tLzBlbW4vZi9wL3B1Yi0zMTQ5MDM2Njg0MjE2OTczLmpzP3VzcXBcdTAwM2RDQWMiXSwiaHR0cHM6Ly9mdW5kaW5nY2hvaWNlc21lc3NhZ2VzLmdvb2dsZS5jb20vZWwvQUdTS1d4VmpzRmdxZHhwME1yZFNEMjF6Q2l2TkR3cjZvM0FfNEQyYVlaRUJJZXZNSmN1eUVvNmRmX29XMUNiZFVRdVR1WW52cGZUdWhteS1NTXZfcGlqVlB0NUQxZ1x1MDAzZFx1MDAzZCJd")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3149036684216973" crossorigin=anonymous></script></head><body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen flex flex-col"><header class="bg-[#0f7ea9] dark:bg-[#094d66] text-white shadow"><div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center"><h1 class="text-2xl font-extrabold tracking-wide"><a href=/ class=hover:opacity-90>BUANACODING</a></h1><nav class="hidden md:flex items-center space-x-6 font-semibold uppercase tracking-wide"><a href=/tags/general class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">General
</a><a href=/tags/go class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Go
</a><a href=/tags/laravel class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Laravel
</a><a href=/tags/linux class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Linux
</a><a href=/tags/python class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Python
</a><a href=/tags/security class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Security</a><div class="hidden md:flex items-center"><div class="flex border border-white/30 rounded overflow-hidden text-xs font-medium"><a href=/2025/10/laravel-two-factor-authentication-2fa-fortify.html data-lang=en data-has-trans=true class="js-lang-link px-2 py-1 bg-white/20 text-white">EN
</a><a href=/id/ data-lang=id data-has-trans=false class="js-lang-link px-2 py-1 bg-transparent hover:bg-white/10 text-white/80">ID</a></div></div><button id=openSearchModal class="text-white transition duration-300 cursor-pointer focus:outline-none dark:hover:text-[#0f7ea9] hover:text-cyan-300" aria-label=Search>
<i data-feather=search class="w-5 h-5"></i>
</button>
<button id=theme-toggle class="ml-2 text-white hover:text-yellow-300 transition duration-300 focus:outline-none cursor-pointer" aria-label="Toggle Dark Mode">
<i id=icon-sun data-feather=sun class="w-5 h-5 hidden"></i>
<i id=icon-moon data-feather=moon class="w-5 h-5"></i></button></nav><button id=menu-toggle class="md:hidden text-2xl focus:outline-none">
☰</button></div><div id=mobile-menu class="hidden md:hidden px-4 pb-4 space-y-2"><a href=/tags/general class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">General
</a><a href=/tags/go class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Go
</a><a href=/tags/laravel class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Laravel
</a><a href=/tags/linux class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Linux
</a><a href=/tags/python class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Python
</a><a href=/tags/security class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Security</a><div class="mt-8 space-y-6"><button id=openSearchModalMobile class="w-full text-left text-white hover:text-cyan-300 transition duration-300 flex items-center gap-4 py-2" aria-label=Search>
<i data-feather=search class="w-5 h-5"></i>
<span class="text-sm font-medium">Search</span></button><div class="flex items-center justify-between py-2"><div class="flex items-center gap-4"><i data-feather=globe class="w-5 h-5 text-white/80"></i>
<span class="text-sm font-medium text-white">Language</span></div><div class="flex text-xs"><a href=/2025/10/laravel-two-factor-authentication-2fa-fortify.html data-lang=en data-has-trans=true class="js-lang-link px-3 py-1.5 text-white font-medium">EN
</a><a href=/id/ data-lang=id data-has-trans=false class="js-lang-link px-3 py-1.5 text-white/60 hover:text-white">ID</a></div></div><button id=theme-toggle-mobile class="w-full text-left text-white hover:text-cyan-300 transition duration-300 flex items-center gap-4 py-2" aria-label="Toggle Dark Mode">
<i id=icon-sun-mobile data-feather=sun class="w-5 h-5 hidden"></i>
<i id=icon-moon-mobile data-feather=moon class="w-5 h-5"></i>
<span class="text-sm font-medium">Theme</span></button></div></div></header><div class="bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 py-2"><div class="max-w-7xl mx-auto px-4"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-3149036684216973 data-ad-slot=9616560861 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><div id=searchModal class="fixed inset-0 z-50 hidden flex justify-center items-center bg-black/30 dark:bg-black/60 backdrop-blur-md p-4"><div class="bg-white dark:bg-[#1f2937] rounded-xl shadow-2xl w-full max-w-xl p-6 relative"><button id=closeSearchModal class="absolute -top-4 -right-4 bg-white dark:bg-[#374151] rounded-full p-1 shadow hover:bg-gray-100 dark:hover:bg-gray-600 transition duration-200 ease-in-out transform hover:scale-110">
<i data-feather=x class="w-5 h-5 text-gray-600 dark:text-white hover:text-red-500"></i>
</button>
<input type=text id=searchBox placeholder="Search articles..." class="w-full px-4 py-3 mb-4 border border-cyan-400 text-gray-800 dark:text-white dark:bg-[#374151] placeholder-gray-400 dark:placeholder-gray-400 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500"><div id=searchAdBanner class="mt-4 mb-8 hidden"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><ins class="adsbygoogle search-results-ad" style=display:block;min-height:100px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><style>#searchAdBanner{transition:opacity .3s ease-in-out,transform .3s ease-in-out}#searchAdBanner.show{display:block!important;opacity:1;transform:translateY(0)}#searchAdBanner.hide{opacity:0;transform:translateY(-10px)}.search-results-ad{max-height:100px;overflow:hidden}</style><ul id=results class="bg-white dark:bg-[#1f2937] rounded-lg shadow max-h-60 overflow-y-auto divide-y divide-gray-200 dark:divide-gray-600"></ul></div></div><main class="flex-1 w-full"><div class="max-w-7xl mx-auto py-8 px-4"><div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-8 py-8"><article class="prose prose-blue dark:prose-invert lg:col-span-2"><nav class="text-sm text-gray-600 dark:text-gray-300 mb-4"><a href=/ class="text-gray-600 dark:text-gray-300 hover:text-[#0f7ea9] no-underline">Home</a>
<span class="mx-2 text-gray-400 dark:text-gray-500">/</span>
<a href=/tags/laravel class="text-gray-600 dark:text-gray-300 hover:text-[#0f7ea9] no-underline">#Laravel</a></nav><h1>How to Implement Multi-Factor Authentication (2FA) in Laravel with Laravel Fortify</h1><div class="flex items-center gap-4 my-4 py-3 border-b border-gray-200 dark:border-gray-700"><span class="text-sm text-gray-500 dark:text-gray-400 font-medium mr-2">Share:</span>
<a href="https://twitter.com/intent/tweet?text=How+to+Implement+Multi-Factor+Authentication+%282FA%29+in+Laravel+with+Laravel+Fortify&url=https%3A%2F%2Fwww.buanacoding.com%2F2025%2F10%2Flaravel-two-factor-authentication-2fa-fortify.html&via=buanacoding" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-black hover:bg-gray-100 dark:hover:text-white dark:hover:bg-gray-700 rounded-full transition-all duration-200" title="Share on Twitter"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.buanacoding.com%2F2025%2F10%2Flaravel-two-factor-authentication-2fa-fortify.html" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all duration-200" title="Share on Facebook"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312.0 2.686.235 2.686.235v2.953H15.83c-1.491.0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.buanacoding.com%2F2025%2F10%2Flaravel-two-factor-authentication-2fa-fortify.html" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-700 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all duration-200" title="Share on LinkedIn"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
</a><a href="https://wa.me/?text=How+to+Implement+Multi-Factor+Authentication+%282FA%29+in+Laravel+with+Laravel+Fortify%20https%3A%2F%2Fwww.buanacoding.com%2F2025%2F10%2Flaravel-two-factor-authentication-2fa-fortify.html" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:text-green-400 dark:hover:bg-green-900/20 rounded-full transition-all duration-200" title="Share on WhatsApp"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893A11.821 11.821.0 0020.484 3.488"/></svg>
</a><button onclick='copyLinkHeader("https://www.buanacoding.com/2025/10/laravel-two-factor-authentication-2fa-fortify.html")' class="p-2 text-gray-500 dark:text-gray-400 hover:text-gray-800 hover:bg-gray-100 dark:hover:text-gray-200 dark:hover:bg-gray-700 rounded-full transition-all duration-200" title="Copy Link">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</button>
<span id=copy-header-success class="hidden text-xs text-green-600 dark:text-green-400 font-medium">Copied!</span></div><script>function copyLinkHeader(e){navigator.clipboard.writeText(e).then(function(){showHeaderSuccess()}).catch(function(){const n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),showHeaderSuccess()})}function showHeaderSuccess(){const e=document.getElementById("copy-header-success");e.classList.remove("hidden"),setTimeout(function(){e.classList.add("hidden")},2e3)}</script><p>Two-factor authentication (2FA) adds an extra layer of security to your Laravel application. Users need both their password and a time-based code from an authenticator app to log in. Laravel Fortify handles all the backend logic, and you build the frontend however you want.</p><p>This guide walks through the complete setup: installing Fortify, enabling 2FA, generating QR codes for Google Authenticator, managing recovery codes, confirming codes before activation to prevent lockouts, and testing everything. We&rsquo;ll also cover security practices and common problems you might run into.</p><h2 id=when-to-use-2fa>When to use 2FA</h2><p>You should use 2FA for applications that handle sensitive data like financial systems, healthcare records, admin panels, or HR systems. If someone breaking into an account would cause real damage, you need 2FA.</p><div class="my-8 flex justify-center"><div class="w-full max-w-2xl"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3149036684216973 data-ad-slot=2492895769></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><p>It&rsquo;s required for applications with privileged access, multi-tenant SaaS platforms, or when compliance standards like PCI-DSS, HIPAA, or SOC 2 demand it.</p><p>For low-risk applications it&rsquo;s optional, but offering 2FA to users who want extra security is always good practice.</p><p>Laravel Fortify provides TOTP-based 2FA that works with Google Authenticator, Authy, 1Password, and any other app that follows RFC 6238.</p><h2 id=install-laravel-fortify>Install Laravel Fortify</h2><p>Laravel Fortify is a headless authentication backend. Install it via Composer:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require laravel/fortify
</span></span></code></pre></div><p>Publish Fortify&rsquo;s resources and run migrations:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan vendor:publish --provider<span class=o>=</span><span class=s2>&#34;Laravel\Fortify\FortifyServiceProvider&#34;</span>
</span></span><span class=line><span class=cl>php artisan migrate
</span></span></code></pre></div><p>This creates the <code>config/fortify.php</code> configuration file, <code>app/Actions/Fortify</code> action classes, <code>app/Providers/FortifyServiceProvider.php</code>, and adds columns to the <code>users</code> table for 2FA (two_factor_secret, two_factor_recovery_codes, two_factor_confirmed_at).</p><p>Register the service provider in <code>config/app.php</code> (Laravel 10 and below) or it will auto-register in Laravel 11+:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=s1>&#39;providers&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>App\Providers\FortifyServiceProvider</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>],</span>
</span></span></code></pre></div><h2 id=enable-2fa-in-fortify-configuration>Enable 2FA in Fortify configuration</h2><p>Open <code>config/fortify.php</code> and enable the two-factor authentication feature:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=s1>&#39;features&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=nx>Features</span><span class=o>::</span><span class=na>registration</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=nx>Features</span><span class=o>::</span><span class=na>resetPasswords</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=nx>Features</span><span class=o>::</span><span class=na>emailVerification</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=nx>Features</span><span class=o>::</span><span class=na>updateProfileInformation</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=nx>Features</span><span class=o>::</span><span class=na>updatePasswords</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=nx>Features</span><span class=o>::</span><span class=na>twoFactorAuthentication</span><span class=p>([</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;confirm&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;confirmPassword&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>]),</span>
</span></span><span class=line><span class=cl><span class=p>],</span>
</span></span></code></pre></div><p>Key options:</p><ul><li><code>'confirm' => true</code>: Users must enter a valid TOTP code before 2FA is fully enabled. This prevents lockouts if they scan the QR code wrong.</li><li><code>'confirmPassword' => true</code>: Users must confirm their password before enabling or disabling 2FA.</li></ul><h2 id=add-the-twofactorauthenticatable-trait-to-user-model>Add the TwoFactorAuthenticatable trait to User model</h2><p>Update your <code>app/Models/User.php</code> to use the <code>TwoFactorAuthenticatable</code> trait:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Models</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Database\Eloquent\Factories\HasFactory</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Foundation\Auth\User</span> <span class=k>as</span> <span class=nx>Authenticatable</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Notifications\Notifiable</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Laravel\Fortify\TwoFactorAuthenticatable</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Laravel\Sanctum\HasApiTokens</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span> <span class=k>extends</span> <span class=nx>Authenticatable</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>use</span> <span class=nx>HasApiTokens</span><span class=p>,</span> <span class=nx>HasFactory</span><span class=p>,</span> <span class=nx>Notifiable</span><span class=p>,</span> <span class=nx>TwoFactorAuthenticatable</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><p>This trait adds methods like <code>twoFactorQrCodeSvg()</code>, <code>recoveryCodes()</code>, and database columns for the 2FA secret and recovery codes.</p><h2 id=fortify-routes-overview>Fortify routes overview</h2><p>Fortify automatically registers these routes when 2FA is enabled:</p><ul><li><code>POST /user/two-factor-authentication</code> — Enable 2FA (generates secret and recovery codes)</li><li><code>DELETE /user/two-factor-authentication</code> — Disable 2FA</li><li><code>GET /user/two-factor-qr-code</code> — Get QR code SVG for scanning</li><li><code>GET /user/two-factor-recovery-codes</code> — Get recovery codes as JSON</li><li><code>POST /user/two-factor-recovery-codes</code> — Regenerate recovery codes</li><li><code>POST /user/confirmed-two-factor-authentication</code> — Confirm 2FA by validating a code</li></ul><p>All routes require authentication and are under the <code>web</code> middleware group. Password confirmation may be required based on your config.</p><h2 id=enable-2fa-generate-secret-and-qr-code>Enable 2FA: Generate secret and QR code</h2><p>When a user wants to enable 2FA, make a POST request to <code>/user/two-factor-authentication</code>. Fortify generates a secret and recovery codes and stores them encrypted in the database.</p><p><strong>Frontend flow (example with Axios):</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Enable 2FA
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-authentication&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Fetch the QR code SVG
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>qrResponse</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-qr-code&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;qr-code&#39;</span><span class=p>).</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=nx>qrResponse</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>svg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Fetch recovery codes
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>recoveryResponse</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-recovery-codes&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>displayRecoveryCodes</span><span class=p>(</span><span class=nx>recoveryResponse</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span></code></pre></div><p><strong>Controller example (custom UI):</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Http\Request</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Laravel\Fortify\Actions\EnableTwoFactorAuthentication</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>enable</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>,</span> <span class=nx>EnableTwoFactorAuthentication</span> <span class=nv>$enable</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$enable</span><span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>user</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;qr_code&#39;</span> <span class=o>=&gt;</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>user</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>twoFactorQrCodeSvg</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;recovery_codes&#39;</span> <span class=o>=&gt;</span> <span class=nx>json_decode</span><span class=p>(</span><span class=nx>decrypt</span><span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>user</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>two_factor_recovery_codes</span><span class=p>),</span> <span class=k>true</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Show the QR code and recovery codes to the user. The QR code is an SVG you can embed directly in your HTML. Display the recovery codes clearly and tell users to save them somewhere safe.</p><h2 id=confirm-2fa-before-fully-enabling>Confirm 2FA before fully enabling</h2><p>With <code>'confirm' => true</code>, users must enter a valid TOTP code from their authenticator app before 2FA is fully active. This ensures the QR code was scanned correctly.</p><p><strong>Confirmation request:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/user/confirmed-two-factor-authentication&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>code</span><span class=o>:</span> <span class=s1>&#39;123456&#39;</span> <span class=c1>// 6-digit code from authenticator app
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span></code></pre></div><p>If the code is valid, Fortify sets the <code>two_factor_confirmed_at</code> timestamp, and 2FA is now active. If invalid, the endpoint returns a 422 error.</p><p><strong>Custom controller example:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>Laravel\Fortify\Actions\ConfirmTwoFactorAuthentication</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>confirm</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>,</span> <span class=nx>ConfirmTwoFactorAuthentication</span> <span class=nv>$confirm</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$confirmed</span> <span class=o>=</span> <span class=nv>$confirm</span><span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>user</span><span class=p>(),</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>code</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span> <span class=nv>$confirmed</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span><span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Invalid code&#39;</span><span class=p>],</span> <span class=mi>422</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span><span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;2FA enabled successfully&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Only show the &ldquo;2FA enabled&rdquo; success message after confirmation. Until then, keep showing the QR code and the input field for the code.</p><h2 id=login-flow-with-2fa-enabled>Login flow with 2FA enabled</h2><p>Once 2FA is enabled, the login process changes:</p><ol><li>User submits email and password to <code>/login</code>.</li><li>If credentials are valid and 2FA is enabled, Laravel redirects to <code>/two-factor-challenge</code> (or returns a JSON response indicating 2FA is required).</li><li>User submits a 6-digit TOTP code or a recovery code to <code>/two-factor-challenge</code>.</li><li>If code is valid, user is authenticated and session starts.</li></ol><p><strong>Two-factor challenge endpoint:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>POST</span> <span class=o>/</span><span class=nx>two</span><span class=o>-</span><span class=nx>factor</span><span class=o>-</span><span class=nx>challenge</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;code&#34;</span><span class=o>:</span> <span class=s2>&#34;123456&#34;</span>           <span class=c1>// TOTP code from authenticator app
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// OR
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=s2>&#34;recovery_code&#34;</span><span class=o>:</span> <span class=s2>&#34;abcd-efgh-ijkl&#34;</span>  <span class=c1>// One-time recovery code
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><p><strong>Customize the challenge view:</strong></p><p>Fortify looks for a <code>two-factor-challenge</code> view. Create <code>resources/views/auth/two-factor-challenge.blade.php</code>:</p><pre tabindex=0><code class=language-blade data-lang=blade>&lt;form method=&#34;POST&#34; action=&#34;/two-factor-challenge&#34;&gt;
    @csrf
    &lt;label&gt;Enter authentication code&lt;/label&gt;
    &lt;input type=&#34;text&#34; name=&#34;code&#34; placeholder=&#34;123456&#34; autofocus&gt;
    &lt;p&gt;Or enter a recovery code:&lt;/p&gt;
    &lt;input type=&#34;text&#34; name=&#34;recovery_code&#34; placeholder=&#34;abcd-efgh-ijkl&#34;&gt;
    &lt;button type=&#34;submit&#34;&gt;Verify&lt;/button&gt;
&lt;/form&gt;
</code></pre><p>Register the view in <code>FortifyServiceProvider</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>Laravel\Fortify\Fortify</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>boot</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Fortify</span><span class=o>::</span><span class=na>twoFactorChallengeView</span><span class=p>(</span><span class=nx>fn</span><span class=p>()</span> <span class=o>=&gt;</span> <span class=nx>view</span><span class=p>(</span><span class=s1>&#39;auth.two-factor-challenge&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=recovery-codes-backup-access>Recovery codes: Backup access</h2><p>Recovery codes are one-time-use codes that allow users to log in if they lose access to their authenticator app. Fortify generates 8 recovery codes by default when 2FA is enabled.</p><p><strong>Show recovery codes after enabling 2FA:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>codes</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-recovery-codes&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>codes</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>code</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>code</span><span class=p>));</span>
</span></span></code></pre></div><p><strong>Regenerate recovery codes</strong> (invalidates old codes):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-recovery-codes&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>newCodes</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-recovery-codes&#39;</span><span class=p>);</span>
</span></span></code></pre></div><p>Best practices:</p><ul><li>Make users confirm they&rsquo;ve saved the codes before closing the setup dialog. Use a checkbox or an &ldquo;I&rsquo;ve saved these&rdquo; button.</li><li>Show recovery codes only once during setup, unless the user regenerates them later.</li><li>Recovery codes are stored hashed in the database. Fortify does this automatically.</li><li>Log when recovery codes are used so you can monitor for suspicious activity.</li></ul><h2 id=disable-2fa>Disable 2FA</h2><p>Users can disable 2FA by making a DELETE request:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=k>delete</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-authentication&#39;</span><span class=p>);</span>
</span></span></code></pre></div><p>This clears the <code>two_factor_secret</code>, <code>two_factor_recovery_codes</code>, and <code>two_factor_confirmed_at</code> columns.</p><p>You should require password confirmation before disabling 2FA. Fortify does this automatically if you set <code>'confirmPassword' => true</code> in the config.</p><h2 id=customize-2fa-secret-length-and-algorithm>Customize 2FA secret length and algorithm</h2><p>Fortify uses the <code>pragmarx/google2fa</code> package. Default secret length is 32 characters (160 bits of entropy). You can customize this by binding a custom Google2FA instance:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>PragmaRX\Google2FA\Google2FA</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// In a service provider
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>singleton</span><span class=p>(</span><span class=nx>Google2FA</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$google2fa</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Google2FA</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$google2fa</span><span class=o>-&gt;</span><span class=na>setSecretLength</span><span class=p>(</span><span class=mi>64</span><span class=p>);</span> <span class=c1>// Increase to 64 characters
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nv>$google2fa</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><p>Most authenticator apps support the default length. Only customize this if you have specific security requirements.</p><h2 id=testing-the-2fa-flow>Testing the 2FA flow</h2><p>Write feature tests to ensure 2FA works end-to-end:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Models\User</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Laravel\Fortify\Features</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>PragmaRX\Google2FA\Google2FA</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>test_user_can_enable_two_factor_authentication</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span> <span class=nx>Features</span><span class=o>::</span><span class=na>enabled</span><span class=p>(</span><span class=nx>Features</span><span class=o>::</span><span class=na>twoFactorAuthentication</span><span class=p>()))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>markTestSkipped</span><span class=p>(</span><span class=s1>&#39;Two factor authentication is not enabled.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span> <span class=o>=</span> <span class=nx>User</span><span class=o>::</span><span class=na>factory</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>actingAs</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$response</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-authentication&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>assertSessionHasNoErrors</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>refresh</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>assertNotNull</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_secret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>assertNotNull</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_recovery_codes</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>test_user_must_confirm_two_factor_before_it_is_active</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span> <span class=o>=</span> <span class=nx>User</span><span class=o>::</span><span class=na>factory</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>actingAs</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-authentication&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>refresh</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$google2fa</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Google2FA</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$secret</span> <span class=o>=</span> <span class=nx>decrypt</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_secret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$validCode</span> <span class=o>=</span> <span class=nv>$google2fa</span><span class=o>-&gt;</span><span class=na>getCurrentOtp</span><span class=p>(</span><span class=nv>$secret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$response</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/user/confirmed-two-factor-authentication&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;code&#39;</span> <span class=o>=&gt;</span> <span class=nv>$validCode</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>refresh</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>assertNotNull</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_confirmed_at</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>test_user_can_login_with_two_factor_code</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span> <span class=o>=</span> <span class=nx>User</span><span class=o>::</span><span class=na>factory</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>([</span><span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=nx>bcrypt</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)]);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>actingAs</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-authentication&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$google2fa</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Google2FA</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$secret</span> <span class=o>=</span> <span class=nx>decrypt</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_secret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$validCode</span> <span class=o>=</span> <span class=nv>$google2fa</span><span class=o>-&gt;</span><span class=na>getCurrentOtp</span><span class=p>(</span><span class=nv>$secret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/user/confirmed-two-factor-authentication&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;code&#39;</span> <span class=o>=&gt;</span> <span class=nv>$validCode</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/logout&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;email&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;password&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$response</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/two-factor-challenge&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;code&#39;</span> <span class=o>=&gt;</span> <span class=nv>$google2fa</span><span class=o>-&gt;</span><span class=na>getCurrentOtp</span><span class=p>(</span><span class=nv>$secret</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>assertRedirect</span><span class=p>(</span><span class=s1>&#39;/dashboard&#39;</span><span class=p>);</span> <span class=c1>// or wherever you redirect after login
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>assertAuthenticatedAs</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>test_user_can_login_with_recovery_code</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span> <span class=o>=</span> <span class=nx>User</span><span class=o>::</span><span class=na>factory</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>([</span><span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=nx>bcrypt</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)]);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>actingAs</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-authentication&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$recoveryCodes</span> <span class=o>=</span> <span class=nx>json_decode</span><span class=p>(</span><span class=nx>decrypt</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>fresh</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>two_factor_recovery_codes</span><span class=p>),</span> <span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$validRecoveryCode</span> <span class=o>=</span> <span class=nv>$recoveryCodes</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$google2fa</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Google2FA</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$secret</span> <span class=o>=</span> <span class=nx>decrypt</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_secret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$validCode</span> <span class=o>=</span> <span class=nv>$google2fa</span><span class=o>-&gt;</span><span class=na>getCurrentOtp</span><span class=p>(</span><span class=nv>$secret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/user/confirmed-two-factor-authentication&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;code&#39;</span> <span class=o>=&gt;</span> <span class=nv>$validCode</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/logout&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;email&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;password&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$response</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/two-factor-challenge&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;recovery_code&#39;</span> <span class=o>=&gt;</span> <span class=nv>$validRecoveryCode</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>assertRedirect</span><span class=p>(</span><span class=s1>&#39;/dashboard&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>assertAuthenticatedAs</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recovery code should be used and no longer valid
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>refresh</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$updatedCodes</span> <span class=o>=</span> <span class=nx>json_decode</span><span class=p>(</span><span class=nx>decrypt</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_recovery_codes</span><span class=p>),</span> <span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>assertNotContains</span><span class=p>(</span><span class=nv>$validRecoveryCode</span><span class=p>,</span> <span class=nv>$updatedCodes</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=implementing-2fa-for-api--sanctum-token-authentication>Implementing 2FA for API / Sanctum token authentication</h2><p>Fortify&rsquo;s 2FA is designed for session-based auth. For API authentication with Sanctum, you need a custom flow:</p><ol><li>User logs in with credentials via API and receives a temporary session or token.</li><li>Check if <code>$user->two_factor_secret</code> exists.</li><li>If yes, return a response indicating 2FA is required (e.g., <code>{ "two_factor_required": true }</code>).</li><li>Client prompts for TOTP code and sends it in a second request.</li><li>Validate the code using <code>Google2FA::verifyKey()</code>.</li><li>If valid, issue a full Sanctum token with appropriate abilities.</li></ol><p><strong>Example controller:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>PragmaRX\Google2FA\Google2FA</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Hash</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>login</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>validate</span><span class=p>([</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;email&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;required|email&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;required&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span> <span class=o>=</span> <span class=nx>User</span><span class=o>::</span><span class=na>where</span><span class=p>(</span><span class=s1>&#39;email&#39;</span><span class=p>,</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>email</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>first</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span> <span class=nv>$user</span> <span class=o>||</span> <span class=o>!</span> <span class=nx>Hash</span><span class=o>::</span><span class=na>check</span><span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>password</span><span class=p>,</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>password</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span><span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Invalid credentials&#39;</span><span class=p>],</span> <span class=mi>422</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_secret</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Store user ID in session or return a temporary token for 2FA step
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>session</span><span class=p>([</span><span class=s1>&#39;2fa_user_id&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span><span class=s1>&#39;two_factor_required&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$token</span> <span class=o>=</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>createToken</span><span class=p>(</span><span class=s1>&#39;api-token&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>plainTextToken</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span><span class=s1>&#39;token&#39;</span> <span class=o>=&gt;</span> <span class=nv>$token</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>verifyTwoFactor</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>,</span> <span class=nx>Google2FA</span> <span class=nv>$google2fa</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>validate</span><span class=p>([</span><span class=s1>&#39;code&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;required|digits:6&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$userId</span> <span class=o>=</span> <span class=nx>session</span><span class=p>(</span><span class=s1>&#39;2fa_user_id&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span> <span class=nv>$userId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span><span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Unauthorized&#39;</span><span class=p>],</span> <span class=mi>401</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span> <span class=o>=</span> <span class=nx>User</span><span class=o>::</span><span class=na>findOrFail</span><span class=p>(</span><span class=nv>$userId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$secret</span> <span class=o>=</span> <span class=nx>decrypt</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_secret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$valid</span> <span class=o>=</span> <span class=nv>$google2fa</span><span class=o>-&gt;</span><span class=na>verifyKey</span><span class=p>(</span><span class=nv>$secret</span><span class=p>,</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>code</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span> <span class=nv>$valid</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span><span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Invalid code&#39;</span><span class=p>],</span> <span class=mi>422</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>session</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>forget</span><span class=p>(</span><span class=s1>&#39;2fa_user_id&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$token</span> <span class=o>=</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>createToken</span><span class=p>(</span><span class=s1>&#39;api-token&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>plainTextToken</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span><span class=s1>&#39;token&#39;</span> <span class=o>=&gt;</span> <span class=nv>$token</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This is a basic example. For production, use encrypted temporary tokens instead of sessions, add rate limiting on 2FA attempts, and use token abilities to mark tokens as 2FA-verified.</p><h2 id=security-best-practices-for-production>Security best practices for production</h2><p>Always use HTTPS in production. TOTP secrets and recovery codes should never be sent over unencrypted connections.</p><p>Fortify encrypts <code>two_factor_secret</code> and <code>two_factor_recovery_codes</code> automatically using Laravel&rsquo;s encryption. Make sure your <code>APP_KEY</code> is secure and never commit it to version control.</p><p>Add throttle middleware to <code>/two-factor-challenge</code> to prevent brute-force attacks. Limit it to 5 attempts per minute per user:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/two-factor-challenge&#39;</span><span class=p>,</span> <span class=p>[</span><span class=o>...</span><span class=p>])</span><span class=o>-&gt;</span><span class=na>middleware</span><span class=p>(</span><span class=s1>&#39;throttle:5,1&#39;</span><span class=p>);</span>
</span></span></code></pre></div><p>Fortify stores recovery codes hashed. When users enter a recovery code, it&rsquo;s checked against the hash and then removed from the list.</p><p>Log when 2FA is enabled, disabled, or when recovery codes are used. Set up alerts for suspicious activity like multiple failed 2FA attempts or 2FA being disabled from a new location.</p><p>Give users clear instructions on setting up 2FA, saving recovery codes, and what to do if they lose access. A help page with screenshots is useful.</p><p>Let users contact support to verify their identity via email or phone if they get locked out. Document your account recovery process.</p><p>Keep <code>laravel/fortify</code> and <code>pragmarx/google2fa</code> updated for security patches.</p><h2 id=troubleshooting-common-issues>Troubleshooting common issues</h2><p>&ldquo;Invalid authentication code&rdquo; during confirmation:</p><ul><li>Check that the user&rsquo;s device time is synced. TOTP depends on accurate time. Even a 30-second drift will break the codes.</li><li>Make sure the secret decrypts correctly. If <code>APP_KEY</code> changed after you generated the secret, decryption fails.</li><li>Verify the QR code has the right secret. Print <code>decrypt($user->two_factor_secret)</code> and manually generate a code with Google Authenticator to test.</li></ul><p>Users locked out after enabling 2FA:</p><ul><li>Test the recovery code flow before you deploy 2FA.</li><li>Make sure the confirmation step works. Don&rsquo;t mark 2FA as enabled until <code>two_factor_confirmed_at</code> is set.</li><li>Give administrators a way to disable 2FA via CLI: <code>php artisan tinker</code> then <code>User::find($id)->update(['two_factor_secret' => null]);</code></li></ul><p>QR code not displaying:</p><ul><li>Check that the <code>/user/two-factor-qr-code</code> route works and returns SVG content.</li><li>If your frontend and backend are on different domains, check CORS settings. See: <a href=/2025/09/laravel-api-authentication-sanctum-2025.html>Laravel API Authentication with Sanctum
</a>.</li><li>Make sure the <code>twoFactorQrCodeSvg()</code> method exists on the User model. Check that the <code>TwoFactorAuthenticatable</code> trait is used.</li></ul><p>2FA works locally but fails in production:</p><ul><li>Check that <code>APP_KEY</code> is the same in both environments. Different keys break encryption.</li><li>Clear the config cache: <code>php artisan config:clear && php artisan config:cache</code>.</li><li>Make sure these database columns exist: <code>two_factor_secret</code>, <code>two_factor_recovery_codes</code>, <code>two_factor_confirmed_at</code>. Re-run migrations if they&rsquo;re missing.</li><li>Verify session and cookie settings for HTTPS: <a href=/2025/09/fixing-laravel-session-cache-issues.html>Fixing Laravel Session and Cache Issues
</a>.</li></ul><p>High server load during TOTP validation:</p><ul><li>TOTP validation doesn&rsquo;t use much CPU, but if you have millions of requests, cache failed attempts to avoid repeated database lookups.</li><li>Index the <code>two_factor_secret</code> column if you query it often, though it&rsquo;s usually only checked once per login.</li></ul><h2 id=advanced-custom-2fa-challenges-and-ui>Advanced: Custom 2FA challenges and UI</h2><p>Fortify is headless, so you have full control over the UI. Build a custom React, Vue, or mobile app frontend:</p><p><strong>React example (2FA setup component):</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Enable2FA</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>qrCode</span><span class=p>,</span> <span class=nx>setQrCode</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>recoveryCodes</span><span class=p>,</span> <span class=nx>setRecoveryCodes</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>([]);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>code</span><span class=p>,</span> <span class=nx>setCode</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>enable</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-authentication&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>qr</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-qr-code&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>codes</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/user/two-factor-recovery-codes&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>setQrCode</span><span class=p>(</span><span class=nx>qr</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>svg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>setRecoveryCodes</span><span class=p>(</span><span class=nx>codes</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>confirm</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/user/confirmed-two-factor-authentication&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>code</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;2FA enabled successfully!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;Invalid code&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>enable</span><span class=p>}&gt;</span><span class=nx>Enable</span> <span class=mi>2</span><span class=nx>FA</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>qrCode</span> <span class=o>&amp;&amp;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>div</span> <span class=na>dangerouslySetInnerHTML</span><span class=o>=</span><span class=p>{{</span> <span class=nx>__html</span><span class=o>:</span> <span class=nx>qrCode</span> <span class=p>}}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>input</span> <span class=na>value</span><span class=o>=</span><span class=p>{</span><span class=nx>code</span><span class=p>}</span> <span class=na>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>setCode</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;Enter code&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>confirm</span><span class=p>}&gt;</span><span class=nx>Confirm</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>h3</span><span class=p>&gt;</span><span class=nx>Recovery</span> <span class=nx>Codes</span> <span class=p>(</span><span class=nx>save</span> <span class=nx>these</span><span class=o>!</span><span class=p>)</span><span class=o>:</span><span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;{</span><span class=nx>recoveryCodes</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>c</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>&lt;</span><span class=nt>li</span> <span class=na>key</span><span class=o>=</span><span class=p>{</span><span class=nx>c</span><span class=p>}&gt;{</span><span class=nx>c</span><span class=p>}&lt;/</span><span class=nt>li</span><span class=p>&gt;)}&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>)}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>For a full SPA setup with Inertia.js, see: <a href=/2025/09/laravel-integration-react-vue-inertia.html>Laravel Integration with React and Vue
</a>.</p><h2 id=alternative-packages-and-approaches>Alternative packages and approaches</h2><p>spatie/laravel-one-time-passwords (released May 2025): A newer package with flexible OTP generation for email, SMS, or TOTP. Good if you need custom OTP delivery methods beyond TOTP.</p><p>pragmarx/google2fa-laravel: Direct Google2FA integration without Fortify. Use this if you want full control over all 2FA logic and don&rsquo;t need Fortify&rsquo;s other features.</p><p>Laravel Jetstream/Breeze: Pre-built 2FA UI using Fortify. Fastest setup for new projects but less flexible than using Fortify alone.</p><p>For most projects, Fortify gives you the best balance of flexibility and built-in security.</p><h2 id=summary>Summary</h2><p>Laravel Fortify makes TOTP-based 2FA simple to set up. Install the package, enable the feature, add the <code>TwoFactorAuthenticatable</code> trait to your User model, and build your frontend to work with Fortify&rsquo;s routes.</p><p>Always require code confirmation before enabling 2FA to prevent lockouts. Generate and display recovery codes, and enforce password confirmation for 2FA changes.</p><p>Add rate limiting on the challenge endpoint, monitor 2FA events, and teach users to save their recovery codes. Test the complete flow including login with TOTP codes and recovery codes. Make sure your production environment uses HTTPS with proper encryption.</p><p>Following these practices gives you a secure, user-friendly multi-factor authentication system that reduces account takeover risk. For more security layers, check out <a href=/2025/09/laravel-security-best-practices-production.html>Laravel Security Best Practices for Production
</a>and <a href=/2025/09/laravel-production-monitoring-error-tracking.html>Laravel Production Monitoring and Error Tracking
</a>.</p></p><div class="bg-gray-100 dark:bg-gray-800 p-4 my-8 rounded"><h2 class="text-lg font-semibold mb-2">📌 Read Also</h2><ul class="list-disc list-outside ml-5"><li><a href=/2025/10/how-to-build-multi-tenant-applications-laravel.html class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">How to Build Multi-Tenant Applications in Laravel</a></li><li><a href=/2025/10/how-to-implement-laravel-socialite-oauth-login-google-facebook-github.html class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">How to Implement Laravel Socialite for OAuth Login (Google, Facebook, GitHub)</a></li><li><a href=/2025/10/how-to-set-up-automated-testing-laravel-phpunit-pest.html class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">How to Set Up Automated Testing in Laravel with PHPUnit and Pest</a></li></ul></div><div class="hidden lg:block"><div class="my-8 py-6 border-t border-b border-gray-200 dark:border-gray-700"><div class="max-w-4xl mx-auto"><div class="text-center mb-3"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block;min-height:90px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></div><div class="block lg:hidden my-8 px-2 mb-10"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block;min-height:50px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><div class="lg:hidden mt-8 pt-8 border-t border-gray-200 dark:border-gray-700"><h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Popular Posts</h3><div class="grid gap-3"><a href=/2025/10/how-to-automate-tasks-cron-jobs-shell-scripts-linux.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Automate Tasks with Cron Jobs and Shell Scripts on Linux</h4><p class="text-xs text-gray-500 dark:text-gray-400">26 Oct 2025</p></a><a href=/2025/10/how-to-manage-linux-services-systemd-systemctl-guide.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Manage Linux Services with Systemd - Complete SystemCTL Guide</h4><p class="text-xs text-gray-500 dark:text-gray-400">26 Oct 2025</p></a><a href=/2025/10/how-to-manage-firewall-linux-ufw-firewalld.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Set Up and Manage Firewall on Linux with UFW and Firewalld</h4><p class="text-xs text-gray-500 dark:text-gray-400">25 Oct 2025</p></a><a href=/2025/10/how-to-secure-ssh-server-ubuntu-hardening-guide.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Secure SSH Server on Ubuntu - Complete Hardening Guide</h4><p class="text-xs text-gray-500 dark:text-gray-400">25 Oct 2025</p></a><a href=/2025/10/how-to-build-multi-tenant-applications-laravel.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Build Multi-Tenant Applications in Laravel</h4><p class="text-xs text-gray-500 dark:text-gray-400">24 Oct 2025</p></a></div></div><div class="my-8 py-6"><div class="max-w-4xl mx-auto"><div class="text-center mb-3"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block data-ad-format=autorelaxed data-ad-client=ca-pub-3149036684216973 data-ad-slot=7106179106></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><div class="not-prose my-12 -mx-4 sm:-mx-6 lg:mx-0"><div class=max-w-full><div class=mb-8><h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-2">Frequently Asked Questions</h2><p class="text-gray-600 dark:text-gray-400">Find quick answers to common questions</p></div><ul class="faq-list space-y-0 list-none p-0 m-0"><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">What is the difference between Laravel Fortify and Laravel Breeze/Jetstream for 2FA?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Laravel Fortify is a headless authentication backend that provides the logic for 2FA, password confirmation, email verification, and more without any UI. Laravel Breeze and Jetstream are full authentication starter kits that use Fortify under the hood and include pre-built views. Use Fortify directly when building custom frontends (SPAs, APIs) or when you need fine-grained control. Use Breeze/Jetstream for rapid development with pre-built Blade, React, or Vue views that include 2FA UI out of the box.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">How does TOTP (Time-based One-Time Password) work in Laravel Fortify?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>TOTP generates a 6-digit code based on the current time and a shared secret key. When enabling 2FA, Fortify creates a secret stored encrypted in the database. This secret is shown as a QR code that users scan with Google Authenticator or Authy. The app and server both use the same algorithm (RFC 6238) with the secret and current time to generate matching codes. Codes change every 30 seconds. During login, Fortify validates the user-provided code against codes generated for the current time window plus a small grace period to account for clock drift.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">What are recovery codes and why are they important?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Recovery codes are one-time-use backup codes generated when enabling 2FA. If users lose access to their authenticator app (lost phone, uninstalled app), they can use a recovery code instead of the TOTP code to regain access. Fortify generates 8 random recovery codes by default, stored hashed in the database. Each code can only be used once. Without recovery codes, users who lose their authenticator device would be permanently locked out. Always enforce showing and storing recovery codes during 2FA setup, and provide a way to regenerate them after authentication.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">How can I prevent users from locking themselves out when enabling 2FA?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Implement a two-step enable process: 1) Generate the secret and show the QR code. 2) Require the user to enter a valid TOTP code before fully enabling 2FA. This confirms they successfully scanned the QR code. Additionally, always generate and display recovery codes immediately after enabling 2FA, and require users to acknowledge saving them (use a confirmation checkbox). Consider sending an email notification when 2FA is enabled. For extra safety, implement a grace period where 2FA can be disabled without a code for 10-15 minutes after enabling, or allow support staff to manually disable 2FA after identity verification.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">Can I customize the 2FA secret length or code expiration time?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Yes. Fortify uses the pragmarx/google2fa package under the hood. You can customize secret length, code window, and QR code parameters. To change secret length from the default 32 characters, publish the Fortify config and modify the two_factor_authentication array. For code validation window, you can extend Fortify&rsquo;s TwoFactorAuthenticationProvider and override the verify method to use Google2FA&rsquo;s setWindow() method. The default window is ±1 interval (90 seconds total: 30s past, 30s current, 30s future). Increasing the window improves usability but slightly reduces security.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">How do I implement 2FA for API authentication with Sanctum tokens?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Fortify&rsquo;s 2FA is designed for session-based authentication. For API/token auth with Sanctum, you need a custom flow: 1) User logs in with credentials and receives a temporary token (or session). 2) Check if user has 2FA enabled ($user->two_factor_secret). 3) If yes, mark the session/token as pending-2fa and require a second request with the TOTP code. 4) Validate the code using Google2FA&rsquo;s verifyKey(). 5) Only after code validation, issue the full-access Sanctum token. Store a 2fa_verified flag in the session or token abilities. Protect sensitive routes by checking this flag. This separates the authentication step (password) from the authorization step (2FA code).</div></div></details></li></ul></div></div><script type=application/ld+json>{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"\"What is the difference between Laravel Fortify and Laravel Breeze/Jetstream for 2FA?\"","acceptedAnswer":{"@type":"Answer","text":"\"Laravel Fortify is a headless authentication backend that provides the logic for 2FA, password confirmation, email verification, and more without any UI. Laravel Breeze and Jetstream are full authentication starter kits that use Fortify under the hood and include pre-built views. Use Fortify directly when building custom frontends (SPAs, APIs) or when you need fine-grained control. Use Breeze/Jetstream for rapid development with pre-built Blade, React, or Vue views that include 2FA UI out of the box.\""}},{"@type":"Question","name":"\"How does TOTP (Time-based One-Time Password) work in Laravel Fortify?\"","acceptedAnswer":{"@type":"Answer","text":"\"TOTP generates a 6-digit code based on the current time and a shared secret key. When enabling 2FA, Fortify creates a secret stored encrypted in the database. This secret is shown as a QR code that users scan with Google Authenticator or Authy. The app and server both use the same algorithm (RFC 6238) with the secret and current time to generate matching codes. Codes change every 30 seconds. During login, Fortify validates the user-provided code against codes generated for the current time window plus a small grace period to account for clock drift.\""}},{"@type":"Question","name":"\"What are recovery codes and why are they important?\"","acceptedAnswer":{"@type":"Answer","text":"\"Recovery codes are one-time-use backup codes generated when enabling 2FA. If users lose access to their authenticator app (lost phone, uninstalled app), they can use a recovery code instead of the TOTP code to regain access. Fortify generates 8 random recovery codes by default, stored hashed in the database. Each code can only be used once. Without recovery codes, users who lose their authenticator device would be permanently locked out. Always enforce showing and storing recovery codes during 2FA setup, and provide a way to regenerate them after authentication.\""}},{"@type":"Question","name":"\"How can I prevent users from locking themselves out when enabling 2FA?\"","acceptedAnswer":{"@type":"Answer","text":"\"Implement a two-step enable process: 1) Generate the secret and show the QR code. 2) Require the user to enter a valid TOTP code before fully enabling 2FA. This confirms they successfully scanned the QR code. Additionally, always generate and display recovery codes immediately after enabling 2FA, and require users to acknowledge saving them (use a confirmation checkbox). Consider sending an email notification when 2FA is enabled. For extra safety, implement a grace period where 2FA can be disabled without a code for 10-15 minutes after enabling, or allow support staff to manually disable 2FA after identity verification.\""}},{"@type":"Question","name":"\"Can I customize the 2FA secret length or code expiration time?\"","acceptedAnswer":{"@type":"Answer","text":"\"Yes. Fortify uses the pragmarx/google2fa package under the hood. You can customize secret length, code window, and QR code parameters. To change secret length from the default 32 characters, publish the Fortify config and modify the two_factor_authentication array. For code validation window, you can extend Fortify's TwoFactorAuthenticationProvider and override the verify method to use Google2FA's setWindow() method. The default window is ±1 interval (90 seconds total: 30s past, 30s current, 30s future). Increasing the window improves usability but slightly reduces security.\""}},{"@type":"Question","name":"\"How do I implement 2FA for API authentication with Sanctum tokens?\"","acceptedAnswer":{"@type":"Answer","text":"\"Fortify's 2FA is designed for session-based authentication. For API/token auth with Sanctum, you need a custom flow: 1) User logs in with credentials and receives a temporary token (or session). 2) Check if user has 2FA enabled ($user-\\u003etwo_factor_secret). 3) If yes, mark the session/token as pending-2fa and require a second request with the TOTP code. 4) Validate the code using Google2FA's verifyKey(). 5) Only after code validation, issue the full-access Sanctum token. Store a 2fa_verified flag in the session or token abilities. Protect sensitive routes by checking this flag. This separates the authentication step (password) from the authorization step (2FA code).\""}}]}</script><style>details.faq-details[open] .faq-arrow svg{transform:rotate(180deg)}</style><script>document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".faq-item");e.forEach(function(t){t.addEventListener("toggle",function(){this.open&&e.forEach(function(e){e!==t&&e.open&&(e.open=!1)})})})})</script></article><aside class="space-y-10 hidden lg:block"><div><h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Popular Posts</h3><ul class="space-y-3 list-disc list-outside pl-5 text-sm text-gray-800 dark:text-gray-200"><li><a href=/2025/10/how-to-automate-tasks-cron-jobs-shell-scripts-linux.html class="hover:text-[#0f7ea9] transition">How to Automate Tasks with Cron Jobs and Shell Scripts on Linux</a></li><li><a href=/2025/10/how-to-manage-linux-services-systemd-systemctl-guide.html class="hover:text-[#0f7ea9] transition">How to Manage Linux Services with Systemd - Complete SystemCTL Guide</a></li><li><a href=/2025/10/how-to-manage-firewall-linux-ufw-firewalld.html class="hover:text-[#0f7ea9] transition">How to Set Up and Manage Firewall on Linux with UFW and Firewalld</a></li><li><a href=/2025/10/how-to-secure-ssh-server-ubuntu-hardening-guide.html class="hover:text-[#0f7ea9] transition">How to Secure SSH Server on Ubuntu - Complete Hardening Guide</a></li><li><a href=/2025/10/how-to-build-multi-tenant-applications-laravel.html class="hover:text-[#0f7ea9] transition">How to Build Multi-Tenant Applications in Laravel</a></li></ul></div></aside></div><section id=comments class=mt-12><script src=https://giscus.app/client.js data-repo=wikukarno/buanacoding data-repo-id=R_kgD0Oj4jAw data-category=General data-category-id=DIC_kwD0Oj4jA84Cr_fx data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></section></div></main><div class=py-6><div class="max-w-7xl mx-auto px-4"><div class="text-center mb-3"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block;min-height:90px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><div class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-white py-4 transition-colors duration-300"><div class="text-center space-x-4 text-sm font-medium"><a href=/about class="hover:text-cyan-500 dark:hover:text-cyan-400">About</a>
<span>-</span>
<a href=/contact class="hover:text-cyan-500 dark:hover:text-cyan-400">Contact</a>
<span>-</span>
<a href=/privacy-policy class="hover:text-cyan-500 dark:hover:text-cyan-400">Privacy Policy</a>
<span>-</span>
<a href=/disclaimer class="hover:text-cyan-500 dark:hover:text-cyan-400">Disclaimer</a></div></div><footer class="text-center text-sm text-gray-500 dark:text-gray-400 py-4 border-t border-gray-200 dark:border-gray-700">&copy; 2025 buanacoding.com</footer><button id=scrollToTop class="fixed bottom-6 right-6 lg:bottom-6 lg:right-6 bg-[#0f7ea9] hover:bg-cyan-600 text-white p-3 rounded-full shadow transition duration-300 z-50" aria-label="Scroll to top">
<svg fill="none" class="w-4 h-4" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/></svg></button><style>body.floating-ad-active #scrollToTop{bottom:100px!important}@media(min-width:1024px){body.floating-ad-active #scrollToTop{bottom:1.5rem!important}}</style><div id=google_translate_element style=display:none></div><script src=https://unpkg.com/feather-icons></script><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.4.6></script><script>feather.replace();const btn=document.getElementById("scrollToTop"),html=document.documentElement,toggleBtn=document.getElementById("theme-toggle"),toggleBtnMobile=document.getElementById("theme-toggle-mobile"),iconSun=document.getElementById("icon-sun"),iconMoon=document.getElementById("icon-moon"),iconSunMobile=document.getElementById("icon-sun-mobile"),iconMoonMobile=document.getElementById("icon-moon-mobile");document.getElementById("menu-toggle")?.addEventListener("click",()=>{document.getElementById("mobile-menu")?.classList.toggle("hidden")}),btn.style.display="none",window.addEventListener("scroll",()=>{window.scrollY>300?btn.style.display="flex":btn.style.display="none"}),btn.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});function updateIcons(e){iconSun.classList.toggle("hidden",!e),iconMoon.classList.toggle("hidden",e),iconSunMobile.classList.toggle("hidden",!e),iconMoonMobile.classList.toggle("hidden",e)}function setDarkMode(e){html.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light"),updateIcons(e)}const userPref=localStorage.getItem("theme"),systemPref=window.matchMedia("(prefers-color-scheme: dark)").matches,isDark=userPref==="dark"||!userPref&&systemPref;setDarkMode(isDark),toggleBtn?.addEventListener("click",()=>{const e=html.getAttribute("data-theme")==="dark";setDarkMode(!e)}),toggleBtnMobile?.addEventListener("click",()=>{const e=html.getAttribute("data-theme")==="dark";setDarkMode(!e)}),document.querySelectorAll("pre").forEach(e=>{const t=document.createElement("button");t.innerHTML=`
      <span>Copy</span>
    `,t.className=`
    copy-btn absolute top-2 right-2
    text-xs px-2 py-1 rounded flex items-center gap-1
    transition-colors duration-200
    bg-gray-200 text-gray-800 hover:bg-gray-300
    dark:bg-white/10 dark:text-white dark:hover:bg-white/20
  `.trim();const n=document.createElement("div");n.className="relative",e.parentNode.insertBefore(n,e),n.appendChild(e),n.appendChild(t),t.addEventListener("click",()=>{const n=e.innerText;navigator.clipboard.writeText(n).then(()=>{t.querySelector("span").innerText="Copied!",setTimeout(()=>{t.querySelector("span").innerText="Copy"},2e3)})})});const openBtn=document.getElementById("openSearchModal"),closeBtn=document.getElementById("closeSearchModal"),modal=document.getElementById("searchModal");openBtn.addEventListener("click",()=>{console.log("Search modal opened"),modal.classList.remove("hidden"),document.getElementById("searchBox").focus()}),closeBtn.addEventListener("click",()=>{modal.classList.add("hidden")}),document.addEventListener("keydown",e=>{e.key==="Escape"&&modal.classList.add("hidden")}),fetch("/index.json").then(e=>e.json()).then(e=>{const n=new Fuse(e,{keys:["title","content"],threshold:.3}),s=document.getElementById("searchBox"),t=document.getElementById("results");s.addEventListener("input",function(e){const o=e.target.value.trim(),s=document.getElementById("searchAdBanner");if(o.length<2){t.innerHTML="",s&&(s.classList.remove("show"),s.classList.add("hide"),setTimeout(()=>s.style.display="none",300));return}s&&(s.style.display="block",s.classList.remove("hide"),s.classList.add("show"));const i=n.search(o);if(i.length===0)t.innerHTML=`
            <li class='px-4 py-3 text-center text-gray-500 dark:text-gray-400'>
              <div class="mb-2">📄 No results found for "${o}"</div>
              <div class="text-xs">Try different keywords or browse categories below</div>
            </li>
          `;else{let e="";i.forEach((t,n)=>{e+=`
              <li class="px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition">
                <a href="${t.item.href}" class="block font-semibold text-gray-900 dark:text-white no-underline">${t.item.title}</a>
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${t.item.content.substring(0,100)}...</p>
              </li>
            `,(n+1)%3===0&&n<i.length-1&&(e+=`
                <li class="px-4 py-2 bg-blue-50 dark:bg-gray-800 border-l-4 border-blue-400">
                  <div class="text-xs text-blue-600 dark:text-blue-400 font-medium">📚 More related articles</div>
                </li>
              `)}),t.innerHTML=e}})});const openBtnMobile=document.getElementById("openSearchModalMobile"),closeBtnMobile=document.getElementById("closeSearchModal"),modalMobile=document.getElementById("searchModal");openBtnMobile.addEventListener("click",()=>{console.log("Search modal opened (mobile)"),modalMobile.classList.remove("hidden"),document.getElementById("searchBox").focus()}),closeBtnMobile.addEventListener("click",()=>{modalMobile.classList.add("hidden")}),document.addEventListener("keydown",e=>{e.key==="Escape"&&modalMobile.classList.add("hidden")}),function(){function t(e,t){if(window.google&&window.google.translate&&window.google.translate.TranslateElement){e&&e();return}if(window.__gtReadyCallbacks=window.__gtReadyCallbacks||[],e&&window.__gtReadyCallbacks.push(e),window.__gtLoading)return;window.__gtLoading=!0,window.initGoogleTranslate=function(){try{new window.google.translate.TranslateElement({pageLanguage:"en",includedLanguages:"id",autoDisplay:!1},"google_translate_element")}catch{}(window.__gtReadyCallbacks||[]).forEach(function(e){try{e()}catch{}}),window.__gtReadyCallbacks=[]};var s,n=document.createElement("script");n.src="https://translate.google.com/translate_a/element.js?cb=initGoogleTranslate",n.defer=!0,s=!1,n.onerror=function(){s=!0,t&&t()},setTimeout(function(){(!window.google||!window.google.translate)&&(s=!0,t&&t())},4e3),document.head.appendChild(n)}function n(e,t){document.cookie=e+"="+t+"; path=/; expires="+new Date(Date.now()+365*24*3600*1e3).toUTCString()}function e(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"}function s(){if(document.getElementById("translate-fallback"))return;var e=document.createElement("div");e.id="translate-fallback",e.style.cssText="position:fixed;bottom:12px;left:50%;transform:translateX(-50%);z-index:9999;background:#111827;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 4px 16px rgba(0,0,0,0.25);display:flex;gap:10px;align-items:center;",e.innerHTML='<span style="font-size:13px">Auto-translate tidak tersedia di perangkat ini.</span><button id="btnTryId" style="background:#0ea5e9;color:#fff;border:none;padding:6px 10px;border-radius:8px;font-size:12px">Coba versi Indonesia</button><button id="btnCloseTf" style="background:transparent;color:#fff;border:1px solid #fff3;padding:6px 10px;border-radius:8px;font-size:12px">Tutup</button>',document.body.appendChild(e),document.getElementById("btnCloseTf").onclick=function(){e.remove()},document.getElementById("btnTryId").onclick=function(){var t=new URL(location.href),e=location.pathname;e.startsWith("/id/")||(t.pathname="/id"+(e.startsWith("/")?e:"/"+e)),fetch(t,{method:"HEAD"}).then(function(e){e.ok?location.href=t:location.href="/id/"}).catch(function(){location.href="/id/"})}}function o(e){t(function(){var t=document.querySelector(".goog-te-combo");t?(t.value=e,t.dispatchEvent(new Event("change"))):(n("googtrans","/en/"+e),location.reload())},s)}function i(){e("googtrans"),e("GOOGTRANS")}document.querySelectorAll(".js-lang-link").forEach(function(e){e.addEventListener("click",function(t){var n=e.getAttribute("data-lang"),s=e.getAttribute("data-has-trans")==="true";if(n==="en"){i();return}s||(t.preventDefault(),o(n))})})}()</script></body></html>