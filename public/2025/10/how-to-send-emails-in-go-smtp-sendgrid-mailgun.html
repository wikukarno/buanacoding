<!doctype html><html lang=en data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>How to Send Emails in Go - SMTP, SendGrid, and Mailgun Integration | Buana Coding</title><meta name=description content="Complete guide to sending emails in Go using SMTP, SendGrid, and Mailgun. Learn email templates, attachments, HTML emails, error handling, and production best practices for transactional emails."><meta name=keywords content="go send email,golang smtp,sendgrid go tutorial,mailgun golang,email golang,smtp server go,transactional emails go,html email golang,email templates go,go email library"><link rel=canonical href=https://www.buanacoding.com/2025/10/how-to-send-emails-in-go-smtp-sendgrid-mailgun.html><link rel=alternate hreflang=en href=https://www.buanacoding.com/2025/10/how-to-send-emails-in-go-smtp-sendgrid-mailgun.html><meta property="og:type" content="article"><meta property="og:title" content="How to Send Emails in Go - SMTP, SendGrid, and Mailgun Integration | Buana Coding"><meta property="og:description" content="Complete guide to sending emails in Go using SMTP, SendGrid, and Mailgun. Learn email templates, attachments, HTML emails, error handling, and production best practices for transactional emails."><meta property="og:url" content="https://www.buanacoding.com/2025/10/how-to-send-emails-in-go-smtp-sendgrid-mailgun.html"><meta property="og:image" content="https://www.buanacoding.com/images/og-image.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="How to Send Emails in Go - SMTP, SendGrid, and Mailgun Integration | Buana Coding"><meta name=twitter:description content="Complete guide to sending emails in Go using SMTP, SendGrid, and Mailgun. Learn email templates, attachments, HTML emails, error handling, and production best practices for transactional emails."><meta name=twitter:image content="https://www.buanacoding.com/images/og-image.jpg"><script type=application/ld+json>
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "How to Send Emails in Go - SMTP, SendGrid, and Mailgun Integration | Buana Coding",
    "description": "Complete guide to sending emails in Go using SMTP, SendGrid, and Mailgun. Learn email templates, attachments, HTML emails, error handling, and production best practices for transactional emails.",
    "inLanguage": "en",
    "datePublished": "2025-10-06T18:00:00\u002b07:00",
    "dateModified": "2025-10-06T18:00:00\u002b07:00",
    "author": {
      "@type": "Person",
      "name": "Wiku Karno"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/www.buanacoding.com\/2025\/10\/how-to-send-emails-in-go-smtp-sendgrid-mailgun.html"
    },
    "image": {
      "@type": "ImageObject",
      "url": "https:\/\/www.buanacoding.com\/images\/og-image.jpg",
      "width": 1200,
      "height": 630
    },
    "publisher": {
      "@type": "Organization",
      "name": "Buana Coding",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/www.buanacoding.com\/images\/og-image.jpg",
        "width": 600,
        "height": 60
      }
    }
  }
  </script><link rel=icon href=/favicon.ico type=image/x-icon><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel=stylesheet><link rel=stylesheet href="/style.css?v=1762707387"><link rel=stylesheet href="/css/overrides.css?v=1762707387"><link rel=stylesheet href="/css/syntax.css?v=1762707387"><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("consent","default",{ad_storage:"granted",ad_user_data:"granted",ad_personalization:"granted",analytics_storage:"granted"})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-0EN9J73FXF"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0EN9J73FXF")</script><script async src="https://fundingchoicesmessages.google.com/i/pub-3149036684216973?ers=1"></script><script>(function(){function e(){if(!window.frames.googlefcPresent)if(document.body){const e=document.createElement("iframe");e.style="width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;",e.style.display="none",e.name="googlefcPresent",document.body.appendChild(e)}else setTimeout(e,0)}e()})()</script><script>(function(){"use strict";function at(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}Z=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype?e:(e[t]=n.value,e)};function Ge(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t,n=0;n<e.length;++n)if(t=e[n],t&&t.Math==Math)return t;throw Error("Cannot find global object")}Pe=Ge(this);function c(e,t){if(t)a:{var n,o,s=Pe;e=e.split(".");for(n=0;n<e.length-1;n++){if(o=e[n],!(o in s))break a;s=s[o]}e=e[e.length-1],n=s[e],t=t(n),t!=n&&t!=null&&Z(s,e,{configurable:!0,writable:!0,value:t})}}function G(e){return e.raw=e}function b(e){var t=typeof Symbol!="undefined"&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if(typeof e.length=="number")return{next:at(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}function Xe(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}if(Se=typeof Object.create=="function"?Object.create:function(e){function t(){}return t.prototype=e,new t},typeof Object.setPrototypeOf=="function")R=Object.setPrototypeOf;else{a:{we={a:!0},V={};try{V.__proto__=we,P=V.a;break a}catch{}P=!1}R=P?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}W=R;function K(e,t){if(e.prototype=Se(t.prototype),e.prototype.constructor=e,W)W(e,t);else for(n in t)if(n!="prototype")if(Object.defineProperties){var n,s=Object.getOwnPropertyDescriptor(t,n);s&&Object.defineProperty(e,n,s)}else e[n]=t[n];e.A=t.prototype}function Q(){for(var t=Number(this),n=[],e=t;e<arguments.length;e++)n[e-t]=arguments[e];return n}c("Object.is",function(e){return e||function(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}}),c("Array.prototype.includes",function(e){return e||function(e,t){var s,o,n=this;n instanceof String&&(n=String(n)),s=n.length,t=t||0;for(t<0&&(t=Math.max(t+s,0));t<s;t++)if(o=n[t],o===e||Object.is(o,e))return!0;return!1}}),c("String.prototype.includes",function(e){return e||function(e,t){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(e,t||0)!==-1}}),c("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991}),c("Number.isFinite",function(e){return e||function(e){return typeof e=="number"&&!isNaN(e)&&e!==1/0&&e!==-(1/0)}}),c("Number.isInteger",function(e){return e||function(e){return!!Number.isFinite(e)&&e===Math.floor(e)}}),c("Number.isSafeInteger",function(e){return e||function(e){return Number.isInteger(e)&&(e<0?-e:e)<=Number.MAX_SAFE_INTEGER}}),c("Math.trunc",function(e){return e||function(e){if(e=Number(e),isNaN(e)||e===1/0||e===-(1/0)||e===0)return e;var t=Math.floor(e<0?-e:e);return e<0?-t:t}}),e=this||self;function _(t,n){a:{for(var s=["CLOSURE_FLAGS"],o=e,i=0;i<s.length;i++)if(o=o[s[i]],o==null){s=null;break a}s=o}return t=s&&s[t],t??n}function q(e){return e}function ct(t){e.setTimeout(function(){throw t},0)}var ae=_(610401301,!1),ot=_(188588736,!0),et=_(645172343,_(1,!0)),Oe=e.navigator,O=Oe?Oe.userAgentData||null:null;function L(e){return!!ae&&!!O&&O.brands.some(function(t){return(t=t.brand)&&t.indexOf(e)!=-1})}function s(t){var n;a:{if((n=e.navigator)&&(n=n.userAgent))break a;n=""}return n.indexOf(t)!=-1}function r(){return!!ae&&!!O&&O.brands.length>0}function F(){return r()?L("Chromium"):(s("Chrome")||s("CriOS"))&&!(r()?0:s("Edge"))||s("Silk")}be=!r()&&(s("Trident")||s("MSIE")),!s("Android")||F(),F(),s("Safari")&&(F()||(r()?0:s("Coast"))||(r()?0:s("Opera"))||(r()?0:s("Edge"))||(r()?L("Microsoft Edge"):s("Edg/"))||r()&&L("Opera")),M={},v=null,T=typeof Uint8Array!="undefined",He=!be&&typeof btoa=="function";function N(){return typeof BigInt=="function"}g=typeof Symbol=="function"&&typeof Symbol()=="symbol";function xe(e){return typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():e}var Z,Pe,Se,t,R,P,we,e,n,O,V,W,be,v,M,T,He,Te,m,g,X,oe,C,E,Ae,j,Fe,le,re,ie,x=xe(),H=xe("2ex"),ye=g?function(e,t){e[x]|=t}:function(e,t){e.g!==0[0]?e.g|=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}})},h=g?function(e){return e[x]|0}:function(e){return e.g|0},d=g?function(e){return e[x]}:function(e){return e.g},l=g?function(e,t){e[x]=t}:function(e,t){e.g!==0[0]?e.g=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}})};function it(e,t){l(t,(e|0)&-14591)}function U(e,t){l(t,(e|34)&-14557)}m={},X={};function Ie(e){return!(!e||typeof e!="object"||e.g!==X)}function S(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function y(e,t,n){if(!Array.isArray(e)||e.length)return!1;var s=h(e);return!!(s&1)||!!(t&&(Array.isArray(t)?t.includes(n):t.has(n)))&&(l(e,s|1),!0)}t=0,n=0;function J(e){var s=e>>>0;t=s,n=(e-s)/4294967296>>>0}function ee(e){if(e<0){J(-e);var s=b(A(t,n));e=s.next().value,s=s.next().value,t=e>>>0,n=s>>>0}else J(e)}function te(e,t){if(t>>>=0,e>>>=0,t<=2097151)var n=""+(4294967296*t+e);else N()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(n=(e>>>24|t<<8)&16777215,t=t>>16&65535,e=(e&16777215)+n*6777216+t*6710656,n+=t*8147497,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+ne(n)+ne(e));return n}function ne(e){return e=String(e),"0000000".slice(e.length)+e}function A(e,t){return t=~t,e?e=~e+1:t+=1,[e,t]}oe=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function $(e,t){return E=t,e=new e(t),E=0[0],e}function k(e,t,n){if(e==null&&(e=E),E=0[0],e==null){var o,i,s=96;n?(e=[n],s|=512):e=[],t&&(s=s&-16760833|(t&1023)<<14)}else{if(!Array.isArray(e))throw Error("narr");if(s=h(e),s&2048)throw Error("farr");if(s&64)return e;if(s|=64,n&&(s|=512,n!==e[0]))throw Error("mid");a:{if(n=e,o=n.length,o&&(i=o-1,S(n[i]))){if(s|=256,t=i-(+!!(s&512)-1),t>=1024)throw Error("pvtlmt");s=s&-16760833|(t&1023)<<14;break a}if(t){if(t=Math.max(t,o-(+!!(s&512)-1)),t>1024)throw Error("spvt");s=s&-16760833|(t&1023)<<14}}}return l(e,s),e}function st(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"boolean":return e?1:0;case"object":if(e)if(Array.isArray(e)){if(y(e,0[0],0))return}else if(T&&e!=null&&e instanceof Uint8Array){if(He){for(var n,o,i,a,c,l,t="",s=0,r=e.length-10240;s<r;)t+=String.fromCharCode.apply(null,e.subarray(s,s+=10240));t+=String.fromCharCode.apply(null,s?e.subarray(s):e),e=btoa(t)}else{if(t===0[0]&&(t=0),!v){v={},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),r=["+/=","+/","-_=","-_.","-_"];for(a=0;a<5;a++){n=s.concat(r[a].split("")),M[a]=n;for(o=0;o<n.length;o++)i=n[o],v[i]===0[0]&&(v[i]=o)}}t=M[t],s=Array(Math.floor(e.length/3)),r=t[64]||"";for(a=n=0;n<e.length-2;n+=3)c=e[n],l=e[n+1],i=e[n+2],o=t[c>>2],c=t[(c&3)<<4|l>>4],l=t[(l&15)<<2|i>>6],i=t[i&63],s[a++]=o+c+l+i;switch(o=0,i=r,e.length-n){case 2:o=e[n+1],i=t[(o&15)<<2]||r;case 1:e=e[n],s[a]=t[e>>2]+t[(e&3)<<4|o>>4]+i+r}e=s.join("")}return e}}return e}function nt(e,t,n){e=Array.prototype.slice.call(e);var i,o=e.length,s=t&256?e[o-1]:0[0];o+=s?-1:0;for(t=t&512?1:0;t<o;t++)e[t]=n(e[t]);if(s){t=e[t]={};for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=n(s[i]))}return e}function de(e,t,n,s,o){if(e!=null){if(Array.isArray(e))e=y(e,0[0],0)?0[0]:o&&h(e)&2?e:B(e,t,n,s!==0[0],o);else if(S(e)){var i,a={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=de(e[i],t,n,s,o));e=a}else e=t(e,s);return e}}function B(e,t,n,s,o){var i,a=s||n?h(e):0;s=s?!!(a&32):0[0],e=Array.prototype.slice.call(e);for(i=0;i<e.length;i++)e[i]=de(e[i],t,n,s,o);return n&&n(a,e),e}function We(e){return e.s===m?e.toJSON():st(e)}function me(e,t,n){if(n=n===0[0]?U:n,e!=null){if(T&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var s=h(e);return s&2?e:(t&&(t=s===0||!!(s&32)&&!(s&64||!(s&16))),t?(l(e,(s|34)&-12293),e):B(e,me,s&4?U:n,!0,!0))}return e.s===m&&(n=e.h,s=d(n),e=s&2?e:$(e.constructor,fe(n,s,!0))),e}}function fe(e,t,n){var s=n||t&2?U:it,o=!!(t&32);return e=nt(e,t,function(e){return me(e,o,s)}),ye(e,32|(n?2:0)),e}function pe(e,t){return e=e.h,ve(e,d(e),t)}function ge(e,t,n,s){if(t=s+(+!!(t&512)-1),!(t<0||t>=e.length||t>=n))return e[t]}function ve(e,t,n,s){if(n===-1)return null;var o,a,i=t>>14&1023||536870912;if(n>=i){if(t&256)return e[e.length-1][n]}else return a=e.length,s&&t&256&&(s=e[a-1][n],s!=null)?(ge(e,t,i,n)&&H!=null&&(e=(o=Te)!=null?o:Te={},o=e[H]||0,o>=4||(e[H]=o+1,o=Error(),o.__closure__error__context__984382||(o.__closure__error__context__984382={}),o.__closure__error__context__984382.severity="incident",ct(o))),s):ge(e,t,i,n)}function Y(e,t,n,s,o){var i,a=t>>14&1023||536870912;if(n>=a||o&&!et){if(i=t,t&256)o=e[e.length-1];else{if(s==null)return;o=e[a+(+!!(t&512)-1)]={},i|=256}o[n]=s,n<a&&(e[n+(+!!(t&512)-1)]=0[0]),i!==t&&l(e,i)}else e[n+(+!!(t&512)-1)]=s,t&256&&(e=e[e.length-1],n in e&&delete e[n])}function je(e,t){var a,r,s=he,c=c!==0[0]&&c,o=e.h,i=d(o),n=ve(o,i,t,c);return n!=null&&typeof n=="object"&&n.s===m?s=n:Array.isArray(n)?(a=h(n),r=a,r===0&&(r|=i&32),r|=i&2,r!==a&&l(n,r),s=new s(n)):s=0[0],s!==n&&s!=null&&Y(o,i,t,s,c),o=s,o==null?o:(e=e.h,i=d(e),i&2||(n=o,s=n.h,a=d(s),n=a&2?$(n.constructor,fe(s,a,!1)):n,n!==o&&(o=n,Y(e,i,t,o,c))),o)}function I(e,t){return e=pe(e,t),e==null||typeof e=="string"?e:0[0]}function _e(e,s){if(i=i===0[0]?0:i,e=pe(e,s),e!=null)if(s=typeof e,s==="number"?Number.isFinite(e):s!=="string"?0:oe.test(e)){if(typeof e=="number")e=e|0,!Number.isSafeInteger(e)&&(ee(e),s=t,o=n,(e=o&2147483648)&&(s=~s+1>>>0,o=~o>>>0,s==0&&(o=o+1>>>0)),s=o*4294967296+(s>>>0),e=e?-s:s);else if(s=Number(e)|0,Number.isSafeInteger(s))e=String(s);else if(s=e.indexOf("."),s!==-1&&(e=e.substring(0,s)),!(e[0]==="-"?e.length<20||e.length===20&&Number(e.substring(0,7))>-922337:e.length<19||e.length===19&&Number(e.substring(0,6))<922337)){if(e.length<16)ee(Number(e));else if(N())e=BigInt(e),t=Number(e&BigInt(4294967295))>>>0,n=Number(e>>BigInt(32)&BigInt(4294967295));else{s=+(e[0]==="-"),n=t=0,o=e.length;for(var o,i,a=s,r=(o-s)%6+s;r<=o;a=r,r+=6)a=Number(e.slice(a,r)),n*=1e6,t=t*1e6+a,t>=4294967296&&(n+=t/4294967296|0,n>>>=0,t>>>=0);s&&(s=b(A(t,n)),e=s.next().value,s=s.next().value,t=e,n=s)}e=t,s=n,s&2147483648?N()?e=""+(BigInt(s|0)<<BigInt(32)|BigInt(e>>>0)):(s=b(A(e,s)),e=s.next().value,s=s.next().value,e="-"+te(e,s)):e=te(e,s)}}else e=0[0];return e??i}function a(e,t){var n=n===0[0]?"":n;return e=I(e,t),e??n}function u(e,t,n){this.h=k(e,t,n)}u.prototype.toJSON=function(){return Ce(this)},u.prototype.s=m,u.prototype.toString=function(){try{return C=!0,Ce(this).toString()}finally{C=!1}};function Ce(e){if(a=C?e.h:B(e.h,We,0[0],0[0],!1),m=!C,h=ot?0[0]:e.constructor.v,l=d(m?e.h:a),e=a.length){var t,n,s,o,i,a,l,u,h,m,f,c=a[e-1],r=S(c);if(r?e--:c=0[0],l=+!!(l&512)-1,i=a,r){b:{if(s=c,n={},r=!1,s)for(t in s)Object.prototype.hasOwnProperty.call(s,t)&&(isNaN(+t)?n[t]=s[t]:(o=s[t],Array.isArray(o)&&(y(o,h,+t)||Ie(o)&&o.size===0)&&(o=null),o==null&&(r=!0),o!=null&&(n[t]=o)));if(r){for(u in n)break b;n=null}else n=s}s=n==null?c!=null:n!==c}for(;e>0;e--){if(u=e-1,t=i[u],u-=l,!(t==null||y(t,h,u)||Ie(t)&&t.size===0))break;f=!0}(i!==a||s||f)&&(m?(f||s||n)&&(i.length=e):i=Array.prototype.slice.call(i,0,e),n&&i.push(n)),a=i}return a}function Ee(e){return function(t){if(t==null||t=="")t=new e;else{if(t=JSON.parse(t),!Array.isArray(t))throw Error("dnarr");ye(t,32),t=$(e,t)}return t}}function ke(e){this.h=k(e)}K(ke,u),Ae=Ee(ke);function w(e){this.g=e}w.prototype.toString=function(){return this.g+""},Fe={};function D(t){if(j===0[0]){var n=null,s=e.trustedTypes;if(s&&s.createPolicy){try{n=s.createPolicy("goog#html",{createHTML:q,createScript:q,createScriptURL:q})}catch(t){e.console&&e.console.error(t.message)}j=n}else j=n}return t=(n=j)?n.createScriptURL(t):t,new w(t,Fe)}function ze(e){if(t=Q.apply(1,arguments),t.length===0)return D(e[0]);for(var t,s=e[0],n=0;n<t.length;n++)s+=encodeURIComponent(t[n])+e[n+1];return D(s)}function Ye(e,t){e.src=t instanceof w&&t.constructor===w?t.g:"type_error:TrustedResourceUrl";var n,s;(n=(t=(s=(n=(e.ownerDocument&&e.ownerDocument.defaultView||window).document).querySelector)==null?0[0]:s.call(n,"script[nonce]"))?t.nonce||t.getAttribute("nonce")||"":"")&&e.setAttribute("nonce",n)}function Ne(){return Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)}function Le(e,t){return t=String(t),e.contentType==="application/xhtml+xml"&&(t=t.toLowerCase()),e.createElement(t)}function Re(t){this.g=t||e.document||document}function qe(e){return e=e===0[0]?document:e,e.createElement("script")}function z(e,t,n,s,o,i){try{var r=e.g,a=qe(r);a.async=!0,Ye(a,t),r.head.appendChild(a),a.addEventListener("load",function(){o(),s&&r.head.removeChild(a)}),a.addEventListener("error",function(){n>0?z(e,t,n-1,s,o,i):(s&&r.head.removeChild(a),i())})}catch{i()}}var Ke=e.atob("aHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vaW1hZ2VzL2ljb25zL21hdGVyaWFsL3N5c3RlbS8xeC93YXJuaW5nX2FtYmVyXzI0ZHAucG5n"),Ue=e.atob("WW91IGFyZSBzZWVpbmcgdGhpcyBtZXNzYWdlIGJlY2F1c2UgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlIGlzIGludGVyZmVyaW5nIHdpdGggdGhpcyBwYWdlLg=="),Je=e.atob("RGlzYWJsZSBhbnkgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlLCB0aGVuIHJlbG9hZCB0aGlzIHBhZ2Uu");function tt(e,t,n){this.i=e,this.u=t,this.o=n,this.g=null,this.j=[],this.m=!1,this.l=new Re(this.i)}function Ve(t){if(t.i.body&&!t.m){var n=function(){Be(t),e.setTimeout(function(){Me(t,3)},50)};z(t.l,t.u,2,!0,function(){e[t.o]||n()},n),t.m=!0}}function Be(e){for(var s,a,r,c,t=o(1,5),n=0;n<t;n++)s=i(e),e.i.body.appendChild(s),e.j.push(s);t=i(e),t.style.bottom="0",t.style.left="0",t.style.position="fixed",t.style.width=o(100,110).toString()+"%",t.style.zIndex=o(2147483544,2147483644).toString(),t.style.backgroundColor=De(249,259,242,252,219,229),t.style.boxShadow="0 0 12px #888",t.style.color=De(0,10,0,10,0,10),t.style.display="flex",t.style.justifyContent="center",t.style.fontFamily="Roboto, Arial",n=i(e),n.style.width=o(80,85).toString()+"%",n.style.maxWidth=o(750,775).toString()+"px",n.style.margin="24px",n.style.display="flex",n.style.alignItems="flex-start",n.style.justifyContent="center",s=Le(e.l.g,"IMG"),s.className=Ne(),s.src=Ke,s.alt="Warning icon",s.style.height="24px",s.style.width="24px",s.style.paddingRight="16px",a=i(e),r=i(e),r.style.fontWeight="bold",r.textContent=Ue,c=i(e),c.textContent=Je,p(e,a,r),p(e,a,c),p(e,n,s),p(e,n,a),p(e,t,n),e.g=t,e.i.body.appendChild(e.g),t=o(1,5);for(n=0;n<t;n++)s=i(e),e.i.body.appendChild(s),e.j.push(s)}function p(e,t,n){for(var r,s=o(1,5),a=0;a<s;a++)r=i(e),t.appendChild(r);t.appendChild(n),n=o(1,5);for(s=0;s<n;s++)a=i(e),t.appendChild(a)}function o(e,t){return Math.floor(e+Math.random()*(t-e))}function De(e,t,n,s,i,a){return"rgb("+o(Math.max(e,0),Math.min(t,255)).toString()+","+o(Math.max(n,0),Math.min(s,255)).toString()+","+o(Math.max(i,0),Math.min(a,255)).toString()+")"}function i(e){return e=Le(e.l.g,"DIV"),e.className=Ne(),e}function Me(t,n){n<=0||t.g!=null&&t.g.offsetHeight!==0&&t.g.offsetWidth!==0||(Qe(t),Be(t),e.setTimeout(function(){Me(t,n-1)},50))}function Qe(e){for(var n=b(e.j),t=n.next();!t.done;t=n.next())(t=t.value)&&t.parentNode&&t.parentNode.removeChild(t);e.j=[],(n=e.g)&&n.parentNode&&n.parentNode.removeChild(n),e.g=null}function Ze(t,n,s,o,i){function r(t){document.body?c(document.body):t>0?e.setTimeout(function(){r(t-1)},i):n()}function c(s){s.appendChild(a),e.setTimeout(function(){a?(a.offsetHeight!==0&&a.offsetWidth!==0?n():t(),a.parentNode&&a.parentNode.removeChild(a)):t()},o)}var a=$e(s);r(3)}function $e(e){var t=document.createElement("div");return t.className=e,t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.left="-10000px",t.style.top="-10000px",t.style.zIndex="-10000",t}function he(e){this.h=k(e)}K(he,u);function ue(e){this.h=k(e)}K(ue,u),le=Ee(ue);function ce(e){if(!e)return null;e=I(e,4);var t;return e==null?t=null:t=D(e),t}re=G([""]),ie=G([""]);function se(e,t){this.m=e,this.o=new Re(e.document),this.g=t,this.j=a(this.g,1),this.u=ce(je(this.g,2))||ze(re),this.i=!1,t=ce(je(this.g,13))||ze(ie),this.l=new tt(e.document,t,a(this.g,12))}se.prototype.start=function(){rt(this)};function rt(t){lt(t),z(t.o,t.u,3,!1,function(){a:{var o,n=t.j,s=e.btoa(n);if(s=e[s]){try{o=Ae(e.atob(s))}catch{n=!1;break a}n=n===I(o,1)}else n=!1}n?f(t,a(t.g,14)):(f(t,a(t.g,8)),Ve(t.l))},function(){Ze(function(){f(t,a(t.g,7)),Ve(t.l)},function(){return f(t,a(t.g,6))},a(t.g,9),_e(t.g,10),_e(t.g,11))})}function f(e,t){e.i||(e.i=!0,e=new e.m.XMLHttpRequest,e.open("GET",t,!0),e.send())}function lt(t){var n=e.btoa(t.j);t.m[n]&&f(t,a(t.g,5))}(function(t,n){e[t]=function(){var s=Q.apply(0,arguments);e[t]=function(){},n.call.apply(n,[null].concat(s instanceof Array?s:Xe(b(s))))}})("__h82AlnkH6D91__",function(e){typeof window.atob=="function"&&new se(window,le(window.atob(e))).start()})}).call(this),window.__h82AlnkH6D91__("WyJwdWItMzE0OTAzNjY4NDIxNjk3MyIsW251bGwsbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9iL3B1Yi0zMTQ5MDM2Njg0MjE2OTczIl0sbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9lbC9BR1NLV3hXRW1tb2ZrZGEwZHlSNkcxMkdNSnNEZDF5UFF4a3FSYS11R2NVem9LZHh6NGFxNndzZm5DN3VPekxfWmljWUZvSW5iYnNKRGtFUUU1a1RUNFFGb25MMF9nXHUwMDNkXHUwMDNkP3RlXHUwMDNkVE9LRU5fRVhQT1NFRCIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFZVeXNCQ3NSc2llS3ExOENZVDNibVVqbFREbTVKM01FR1BSdUVoRjFsV3c3UjVNdGRwWnhNM2hJQm1tMnZhbjNmVWxZcVNLSnoycE5xMWNSTUJZYUxfLXdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QxXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFVvQ2JlQlRkS2gzZmU0NnB1VERhek9PdHN0b0p3NjhKUU5SOGQ1OFgwWm9QRlV0LUZPUm1HU1ZJajM2WXQwQjU3c0t1bUFmcjFNWU5JV3U3U3JXNi1EQkFcdTAwM2RcdTAwM2Q/YWJcdTAwM2QyXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFdORXhuRXA0STJueGlBNXdiejVRMDZzT0Njek53bFltRXo4cWhOY0sxZzd2N1UwR2ZVZ0hJOFlPeWk1Qms2NGljWTNzU3BMRE9IZ3pSNTg0VlA5ak5sZmdcdTAwM2RcdTAwM2Q/c2JmXHUwMDNkMiIsImRpdi1ncHQtYWQiLDIwLDEwMCwiY0hWaUxUTXhORGt3TXpZMk9EUXlNVFk1TnpNXHUwMDNkIixbbnVsbCxudWxsLG51bGwsImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tLzBlbW4vZi9wL3B1Yi0zMTQ5MDM2Njg0MjE2OTczLmpzP3VzcXBcdTAwM2RDQWMiXSwiaHR0cHM6Ly9mdW5kaW5nY2hvaWNlc21lc3NhZ2VzLmdvb2dsZS5jb20vZWwvQUdTS1d4VmpzRmdxZHhwME1yZFNEMjF6Q2l2TkR3cjZvM0FfNEQyYVlaRUJJZXZNSmN1eUVvNmRmX29XMUNiZFVRdVR1WW52cGZUdWhteS1NTXZfcGlqVlB0NUQxZ1x1MDAzZFx1MDAzZCJd")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3149036684216973" crossorigin=anonymous></script></head><body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen flex flex-col"><header class="bg-[#0f7ea9] dark:bg-[#094d66] text-white shadow"><div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center"><h1 class="text-2xl font-extrabold tracking-wide"><a href=/ class=hover:opacity-90>BUANACODING</a></h1><nav class="hidden md:flex items-center space-x-6 font-semibold uppercase tracking-wide"><a href=/tags/general class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">General
</a><a href=/tags/go class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Go
</a><a href=/tags/laravel class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Laravel
</a><a href=/tags/linux class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Linux
</a><a href=/tags/python class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Python
</a><a href=/tags/security class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Security</a><div class="hidden md:flex items-center"><div class="flex border border-white/30 rounded overflow-hidden text-xs font-medium"><a href=/2025/10/how-to-send-emails-in-go-smtp-sendgrid-mailgun.html data-lang=en data-has-trans=true class="js-lang-link px-2 py-1 bg-white/20 text-white">EN
</a><a href=/id/ data-lang=id data-has-trans=false class="js-lang-link px-2 py-1 bg-transparent hover:bg-white/10 text-white/80">ID</a></div></div><button id=openSearchModal class="text-white transition duration-300 cursor-pointer focus:outline-none dark:hover:text-[#0f7ea9] hover:text-cyan-300" aria-label=Search>
<i data-feather=search class="w-5 h-5"></i>
</button>
<button id=theme-toggle class="ml-2 text-white hover:text-yellow-300 transition duration-300 focus:outline-none cursor-pointer" aria-label="Toggle Dark Mode">
<i id=icon-sun data-feather=sun class="w-5 h-5 hidden"></i>
<i id=icon-moon data-feather=moon class="w-5 h-5"></i></button></nav><button id=menu-toggle class="md:hidden text-2xl focus:outline-none">
â˜°</button></div><div id=mobile-menu class="hidden md:hidden px-4 pb-4 space-y-2"><a href=/tags/general class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">General
</a><a href=/tags/go class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Go
</a><a href=/tags/laravel class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Laravel
</a><a href=/tags/linux class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Linux
</a><a href=/tags/python class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Python
</a><a href=/tags/security class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Security</a><div class="mt-8 space-y-6"><button id=openSearchModalMobile class="w-full text-left text-white hover:text-cyan-300 transition duration-300 flex items-center gap-4 py-2" aria-label=Search>
<i data-feather=search class="w-5 h-5"></i>
<span class="text-sm font-medium">Search</span></button><div class="flex items-center justify-between py-2"><div class="flex items-center gap-4"><i data-feather=globe class="w-5 h-5 text-white/80"></i>
<span class="text-sm font-medium text-white">Language</span></div><div class="flex text-xs"><a href=/2025/10/how-to-send-emails-in-go-smtp-sendgrid-mailgun.html data-lang=en data-has-trans=true class="js-lang-link px-3 py-1.5 text-white font-medium">EN
</a><a href=/id/ data-lang=id data-has-trans=false class="js-lang-link px-3 py-1.5 text-white/60 hover:text-white">ID</a></div></div><button id=theme-toggle-mobile class="w-full text-left text-white hover:text-cyan-300 transition duration-300 flex items-center gap-4 py-2" aria-label="Toggle Dark Mode">
<i id=icon-sun-mobile data-feather=sun class="w-5 h-5 hidden"></i>
<i id=icon-moon-mobile data-feather=moon class="w-5 h-5"></i>
<span class="text-sm font-medium">Theme</span></button></div></div></header><div class="bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 py-2"><div class="max-w-7xl mx-auto px-4"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-3149036684216973 data-ad-slot=9616560861 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><div id=searchModal class="fixed inset-0 z-50 hidden flex justify-center items-center bg-black/30 dark:bg-black/60 backdrop-blur-md p-4"><div class="bg-white dark:bg-[#1f2937] rounded-xl shadow-2xl w-full max-w-xl p-6 relative"><button id=closeSearchModal class="absolute -top-4 -right-4 bg-white dark:bg-[#374151] rounded-full p-1 shadow hover:bg-gray-100 dark:hover:bg-gray-600 transition duration-200 ease-in-out transform hover:scale-110">
<i data-feather=x class="w-5 h-5 text-gray-600 dark:text-white hover:text-red-500"></i>
</button>
<input type=text id=searchBox placeholder="Search articles..." class="w-full px-4 py-3 mb-4 border border-cyan-400 text-gray-800 dark:text-white dark:bg-[#374151] placeholder-gray-400 dark:placeholder-gray-400 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500"><div id=searchAdBanner class="mt-4 mb-8 hidden"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><ins class="adsbygoogle search-results-ad" style=display:block;min-height:100px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><style>#searchAdBanner{transition:opacity .3s ease-in-out,transform .3s ease-in-out}#searchAdBanner.show{display:block!important;opacity:1;transform:translateY(0)}#searchAdBanner.hide{opacity:0;transform:translateY(-10px)}.search-results-ad{max-height:100px;overflow:hidden}</style><ul id=results class="bg-white dark:bg-[#1f2937] rounded-lg shadow max-h-60 overflow-y-auto divide-y divide-gray-200 dark:divide-gray-600"></ul></div></div><main class="flex-1 w-full"><div class="max-w-7xl mx-auto py-8 px-4"><div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-8 py-8"><article class="prose prose-blue dark:prose-invert lg:col-span-2"><nav class="text-sm text-gray-600 dark:text-gray-300 mb-4"><a href=/ class="text-gray-600 dark:text-gray-300 hover:text-[#0f7ea9] no-underline">Home</a>
<span class="mx-2 text-gray-400 dark:text-gray-500">/</span>
<a href=/tags/go class="text-gray-600 dark:text-gray-300 hover:text-[#0f7ea9] no-underline">#Go</a></nav><h1>How to Send Emails in Go - SMTP, SendGrid, and Mailgun Integration</h1><div class="flex items-center gap-4 my-4 py-3 border-b border-gray-200 dark:border-gray-700"><span class="text-sm text-gray-500 dark:text-gray-400 font-medium mr-2">Share:</span>
<a href="https://twitter.com/intent/tweet?text=How+to+Send+Emails+in+Go+-+SMTP%2C+SendGrid%2C+and+Mailgun+Integration&url=https%3A%2F%2Fwww.buanacoding.com%2F2025%2F10%2Fhow-to-send-emails-in-go-smtp-sendgrid-mailgun.html&via=buanacoding" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-black hover:bg-gray-100 dark:hover:text-white dark:hover:bg-gray-700 rounded-full transition-all duration-200" title="Share on Twitter"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.buanacoding.com%2F2025%2F10%2Fhow-to-send-emails-in-go-smtp-sendgrid-mailgun.html" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all duration-200" title="Share on Facebook"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312.0 2.686.235 2.686.235v2.953H15.83c-1.491.0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.buanacoding.com%2F2025%2F10%2Fhow-to-send-emails-in-go-smtp-sendgrid-mailgun.html" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-700 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all duration-200" title="Share on LinkedIn"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
</a><a href="https://wa.me/?text=How+to+Send+Emails+in+Go+-+SMTP%2C+SendGrid%2C+and+Mailgun+Integration%20https%3A%2F%2Fwww.buanacoding.com%2F2025%2F10%2Fhow-to-send-emails-in-go-smtp-sendgrid-mailgun.html" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:text-green-400 dark:hover:bg-green-900/20 rounded-full transition-all duration-200" title="Share on WhatsApp"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893A11.821 11.821.0 0020.484 3.488"/></svg>
</a><button onclick='copyLinkHeader("https://www.buanacoding.com/2025/10/how-to-send-emails-in-go-smtp-sendgrid-mailgun.html")' class="p-2 text-gray-500 dark:text-gray-400 hover:text-gray-800 hover:bg-gray-100 dark:hover:text-gray-200 dark:hover:bg-gray-700 rounded-full transition-all duration-200" title="Copy Link">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</button>
<span id=copy-header-success class="hidden text-xs text-green-600 dark:text-green-400 font-medium">Copied!</span></div><script>function copyLinkHeader(e){navigator.clipboard.writeText(e).then(function(){showHeaderSuccess()}).catch(function(){const n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),showHeaderSuccess()})}function showHeaderSuccess(){const e=document.getElementById("copy-header-success");e.classList.remove("hidden"),setTimeout(function(){e.classList.add("hidden")},2e3)}</script><p>Your application needs to send emails. Welcome messages after signup, password reset links, order confirmations, notification alerts. Email is still the most reliable way to reach users, but sending emails programmatically is harder than it looks.</p><p><strong>What is email sending in Go?</strong> Email sending in Go refers to programmatically delivering emails from your application using either SMTP protocol directly or third-party email service APIs like SendGrid and Mailgun. Instead of manually composing and sending emails, your Go code automatically sends transactional emails triggered by user actions.</p><p>You could use SMTP directly, but deliverability is a nightmare. ISPs block mail from unknown servers. Your emails land in spam. Bounce handling becomes your problem. That&rsquo;s why production applications use email service providers.</p><div class="my-8 flex justify-center"><div class="w-full max-w-2xl"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3149036684216973 data-ad-slot=2492895769></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><p>This guide covers everything - from basic SMTP to production-ready SendGrid and Mailgun integration. You&rsquo;ll learn HTML emails, templates, attachments, error handling, and avoiding spam filters. We&rsquo;ll build real examples that you can deploy to production.</p><h2 id=why-email-services-matter>Why Email Services Matter</h2><p>Sending email sounds simple. Connect to an SMTP server, send message, done. Reality is different.</p><p>I once built an app that sent password resets using a basic SMTP server. Worked fine in testing. In production, 60% of emails never arrived. Gmail marked them as spam. Outlook blocked them entirely. Users complained they couldn&rsquo;t reset passwords.</p><p>The problem: deliverability. Major email providers don&rsquo;t trust random SMTP servers. Your emails need proper authentication (SPF, DKIM, DMARC), good sender reputation, and correct headers. Setting this up yourself takes weeks and ongoing maintenance.</p><p><strong>What email services handle for you:</strong></p><p>Deliverability infrastructure - Established relationships with ISPs, authenticated domains, good sender reputation.</p><p>Bounce management - Automatic handling of bounced emails, maintaining clean sender lists.</p><p>Analytics - Track opens, clicks, bounces, spam complaints.</p><p>Templates - Store and manage email templates without code deploys.</p><p>Scale - Handle millions of emails without worrying about server capacity.</p><p>Compliance - GDPR compliance, unsubscribe handling, spam regulations.</p><p>Using an email service costs money but saves time and ensures emails actually get delivered. For production applications, it&rsquo;s not optional.</p><h2 id=understanding-email-delivery-methods>Understanding Email Delivery Methods</h2><p>Go offers several ways to send emails, each with tradeoffs.</p><p><strong>Net/smtp package</strong> - Go&rsquo;s standard library for SMTP. Simple for basic emails but requires managing SMTP servers, authentication, and deliverability yourself. Good for development, risky for production.</p><p><strong>Third-party SMTP services</strong> - Use Gmail, Amazon SES, or other SMTP providers. Better deliverability than your own server but still SMTP limitations. You handle connection pooling, retries, and errors.</p><p><strong>Email service APIs</strong> - SendGrid, Mailgun, Postmark use HTTP APIs instead of SMTP. Better error handling, richer features, detailed analytics. Most production apps use these.</p><p><strong>When to use each:</strong></p><p>Development - net/smtp with Gmail or Mailtrap for testing.</p><p>Small projects - SendGrid free tier (100 emails/day).</p><p>Production apps - SendGrid or Mailgun APIs with proper error handling.</p><p>High volume - Mailgun or AWS SES for cost efficiency.</p><p>This guide focuses on production approaches: basic SMTP for understanding, then SendGrid and Mailgun for real applications.</p><h2 id=sending-email-with-smtp-in-go>Sending Email with SMTP in Go</h2><p>Let&rsquo;s start with SMTP using Go&rsquo;s standard library. This teaches fundamentals even if you&rsquo;ll use services later.</p><h3 id=basic-smtp-example>Basic SMTP Example</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;net/smtp&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// SMTP server configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpHost</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;smtp.gmail.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpPort</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;587&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Sender credentials</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>from</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;your-email@gmail.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>password</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;your-app-password&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Recipient</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>to</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;recipient@example.com&#34;</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Message</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>subject</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;Test Email from Go&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>body</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;This is a test email sent from Go using SMTP.&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;Subject: %s\r\n\r\n%s&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Authentication</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>auth</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>smtp</span><span class=p>.</span><span class=nf>PlainAuth</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>from</span><span class=p>,</span><span class=w> </span><span class=nx>password</span><span class=p>,</span><span class=w> </span><span class=nx>smtpHost</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Send email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>smtp</span><span class=p>.</span><span class=nf>SendMail</span><span class=p>(</span><span class=nx>smtpHost</span><span class=o>+</span><span class=s>&#34;:&#34;</span><span class=o>+</span><span class=nx>smtpPort</span><span class=p>,</span><span class=w> </span><span class=nx>auth</span><span class=p>,</span><span class=w> </span><span class=nx>from</span><span class=p>,</span><span class=w> </span><span class=nx>to</span><span class=p>,</span><span class=w> </span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Failed to send email:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Email sent successfully!&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>This works but has problems. The message is plain text only, no proper MIME headers, error handling is basic, and credentials are hardcoded.</p><h3 id=improved-smtp-with-proper-headers>Improved SMTP with Proper Headers</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;net/smtp&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>Email</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>From</span><span class=w>    </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>To</span><span class=w>      </span><span class=p>[]</span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Subject</span><span class=w> </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Body</span><span class=w>    </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>e</span><span class=w> </span><span class=o>*</span><span class=nx>Email</span><span class=p>)</span><span class=w> </span><span class=nf>BuildMessage</span><span class=p>()</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;From: %s\r\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>From</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;To: %s\r\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>To</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;Subject: %s\r\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>Subject</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=s>&#34;MIME-Version: 1.0\r\n&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=s>&#34;Content-Type: text/plain; charset=UTF-8\r\n&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=s>&#34;\r\n&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>Body</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>SendEmail</span><span class=p>(</span><span class=nx>email</span><span class=w> </span><span class=o>*</span><span class=nx>Email</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpHost</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_HOST&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpPort</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PORT&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpUser</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_USER&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpPass</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PASS&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>smtpHost</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=nx>smtpPort</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;SMTP configuration missing&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>auth</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>smtp</span><span class=p>.</span><span class=nf>PlainAuth</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>smtpUser</span><span class=p>,</span><span class=w> </span><span class=nx>smtpPass</span><span class=p>,</span><span class=w> </span><span class=nx>smtpHost</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>addr</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>smtpHost</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;:&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>smtpPort</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nf>BuildMessage</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>smtp</span><span class=p>.</span><span class=nf>SendMail</span><span class=p>(</span><span class=nx>addr</span><span class=p>,</span><span class=w> </span><span class=nx>auth</span><span class=p>,</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nx>From</span><span class=p>,</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nx>To</span><span class=p>,</span><span class=w> </span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;failed to send email: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>email</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=o>&amp;</span><span class=nx>Email</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>From</span><span class=p>:</span><span class=w>    </span><span class=s>&#34;sender@example.com&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>To</span><span class=p>:</span><span class=w>      </span><span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;recipient@example.com&#34;</span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Subject</span><span class=p>:</span><span class=w> </span><span class=s>&#34;Welcome to Our Service&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Body</span><span class=p>:</span><span class=w>    </span><span class=s>&#34;Thank you for signing up! We&#39;re excited to have you.&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nf>SendEmail</span><span class=p>(</span><span class=nx>email</span><span class=p>);</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Error:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Email sent successfully!&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Better. We added proper headers, environment variables for configuration, and error wrapping. But this is still plain text emails.</p><h3 id=sending-html-emails-with-smtp>Sending HTML Emails with SMTP</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;net/smtp&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>HTMLEmail</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>From</span><span class=w>    </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>To</span><span class=w>      </span><span class=p>[]</span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Subject</span><span class=w> </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Body</span><span class=w>    </span><span class=kt>string</span><span class=w> </span><span class=c1>// HTML content</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>e</span><span class=w> </span><span class=o>*</span><span class=nx>HTMLEmail</span><span class=p>)</span><span class=w> </span><span class=nf>BuildMessage</span><span class=p>()</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>headers</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>headers</span><span class=p>[</span><span class=s>&#34;From&#34;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>From</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>headers</span><span class=p>[</span><span class=s>&#34;To&#34;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>To</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>headers</span><span class=p>[</span><span class=s>&#34;Subject&#34;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>Subject</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>headers</span><span class=p>[</span><span class=s>&#34;MIME-Version&#34;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#34;1.0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>headers</span><span class=p>[</span><span class=s>&#34;Content-Type&#34;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#34;text/html; charset=UTF-8&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>k</span><span class=p>,</span><span class=w> </span><span class=nx>v</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>headers</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>message</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%s: %s\r\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>k</span><span class=p>,</span><span class=w> </span><span class=nx>v</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=s>&#34;\r\n&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>Body</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>SendHTMLEmail</span><span class=p>(</span><span class=nx>email</span><span class=w> </span><span class=o>*</span><span class=nx>HTMLEmail</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpHost</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_HOST&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpPort</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PORT&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpUser</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_USER&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpPass</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PASS&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>auth</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>smtp</span><span class=p>.</span><span class=nf>PlainAuth</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>smtpUser</span><span class=p>,</span><span class=w> </span><span class=nx>smtpPass</span><span class=p>,</span><span class=w> </span><span class=nx>smtpHost</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>addr</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>smtpHost</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;:&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>smtpPort</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nf>BuildMessage</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>smtp</span><span class=p>.</span><span class=nf>SendMail</span><span class=p>(</span><span class=nx>addr</span><span class=p>,</span><span class=w> </span><span class=nx>auth</span><span class=p>,</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nx>From</span><span class=p>,</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nx>To</span><span class=p>,</span><span class=w> </span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>htmlBody</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>&lt;!DOCTYPE html&gt;
</span></span></span><span class=line><span class=cl><span class=s>&lt;html&gt;
</span></span></span><span class=line><span class=cl><span class=s>&lt;head&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;style&gt;
</span></span></span><span class=line><span class=cl><span class=s>        body { font-family: Arial, sans-serif; }
</span></span></span><span class=line><span class=cl><span class=s>        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
</span></span></span><span class=line><span class=cl><span class=s>        .header { background-color: #4CAF50; color: white; padding: 20px; text-align: center; }
</span></span></span><span class=line><span class=cl><span class=s>        .content { padding: 20px; background-color: #f9f9f9; }
</span></span></span><span class=line><span class=cl><span class=s>        .button { background-color: #4CAF50; color: white; padding: 10px 20px; text-decoration: none; display: inline-block; margin: 10px 0; }
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/style&gt;
</span></span></span><span class=line><span class=cl><span class=s>&lt;/head&gt;
</span></span></span><span class=line><span class=cl><span class=s>&lt;body&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;div class=&#34;container&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;div class=&#34;header&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s>            &lt;h1&gt;Welcome to Our Service!&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;div class=&#34;content&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s>            &lt;p&gt;Hi there,&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>            &lt;p&gt;Thank you for signing up. We&#39;re excited to have you on board!&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>            &lt;p&gt;Click the button below to get started:&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>            &lt;a href=&#34;https://example.com/get-started&#34; class=&#34;button&#34;&gt;Get Started&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>            &lt;p&gt;Best regards,&lt;br&gt;The Team&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=s>&lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=s>&lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    `</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>email</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=o>&amp;</span><span class=nx>HTMLEmail</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>From</span><span class=p>:</span><span class=w>    </span><span class=s>&#34;noreply@example.com&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>To</span><span class=p>:</span><span class=w>      </span><span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;user@example.com&#34;</span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Subject</span><span class=p>:</span><span class=w> </span><span class=s>&#34;Welcome to Our Service&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Body</span><span class=p>:</span><span class=w>    </span><span class=nx>htmlBody</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nf>SendHTMLEmail</span><span class=p>(</span><span class=nx>email</span><span class=p>);</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Error:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;HTML email sent successfully!&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Now we&rsquo;re sending styled HTML emails. But there&rsquo;s a problem - what if the recipient&rsquo;s email client doesn&rsquo;t support HTML? We should send both plain text and HTML.</p><h3 id=multipart-emails-plain-text--html>Multipart Emails (Plain Text + HTML)</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;bytes&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;mime/multipart&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;net/smtp&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;net/textproto&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>MultipartEmail</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>From</span><span class=w>        </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>To</span><span class=w>          </span><span class=p>[]</span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Subject</span><span class=w>     </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>TextBody</span><span class=w>    </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>HTMLBody</span><span class=w>    </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>e</span><span class=w> </span><span class=o>*</span><span class=nx>MultipartEmail</span><span class=p>)</span><span class=w> </span><span class=nf>BuildMessage</span><span class=p>()</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>buf</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>bytes</span><span class=p>.</span><span class=nf>NewBuffer</span><span class=p>(</span><span class=kc>nil</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Write headers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>buf</span><span class=p>,</span><span class=w> </span><span class=s>&#34;From: %s\r\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>From</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>buf</span><span class=p>,</span><span class=w> </span><span class=s>&#34;To: %s\r\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>To</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>buf</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Subject: %s\r\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>Subject</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>buf</span><span class=p>,</span><span class=w> </span><span class=s>&#34;MIME-Version: 1.0\r\n&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Create multipart writer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>writer</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>multipart</span><span class=p>.</span><span class=nf>NewWriter</span><span class=p>(</span><span class=nx>buf</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>boundary</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>writer</span><span class=p>.</span><span class=nf>Boundary</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>buf</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Content-Type: multipart/alternative; boundary=%s\r\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>boundary</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>buf</span><span class=p>,</span><span class=w> </span><span class=s>&#34;\r\n&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Plain text part</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>textHeader</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>textproto</span><span class=p>.</span><span class=nx>MIMEHeader</span><span class=p>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>textHeader</span><span class=p>.</span><span class=nf>Set</span><span class=p>(</span><span class=s>&#34;Content-Type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;text/plain; charset=UTF-8&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>textHeader</span><span class=p>.</span><span class=nf>Set</span><span class=p>(</span><span class=s>&#34;Content-Transfer-Encoding&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;quoted-printable&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>textPart</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>writer</span><span class=p>.</span><span class=nf>CreatePart</span><span class=p>(</span><span class=nx>textHeader</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>textPart</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>TextBody</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// HTML part</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>htmlHeader</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>textproto</span><span class=p>.</span><span class=nx>MIMEHeader</span><span class=p>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>htmlHeader</span><span class=p>.</span><span class=nf>Set</span><span class=p>(</span><span class=s>&#34;Content-Type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;text/html; charset=UTF-8&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>htmlHeader</span><span class=p>.</span><span class=nf>Set</span><span class=p>(</span><span class=s>&#34;Content-Transfer-Encoding&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;quoted-printable&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>htmlPart</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>writer</span><span class=p>.</span><span class=nf>CreatePart</span><span class=p>(</span><span class=nx>htmlHeader</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>htmlPart</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>HTMLBody</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>writer</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>buf</span><span class=p>.</span><span class=nf>Bytes</span><span class=p>(),</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>SendMultipartEmail</span><span class=p>(</span><span class=nx>email</span><span class=w> </span><span class=o>*</span><span class=nx>MultipartEmail</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpHost</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_HOST&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpPort</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PORT&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpUser</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_USER&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>smtpPass</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PASS&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>auth</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>smtp</span><span class=p>.</span><span class=nf>PlainAuth</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>smtpUser</span><span class=p>,</span><span class=w> </span><span class=nx>smtpPass</span><span class=p>,</span><span class=w> </span><span class=nx>smtpHost</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nf>BuildMessage</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;failed to build message: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>addr</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>smtpHost</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;:&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>smtpPort</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>smtp</span><span class=p>.</span><span class=nf>SendMail</span><span class=p>(</span><span class=nx>addr</span><span class=p>,</span><span class=w> </span><span class=nx>auth</span><span class=p>,</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nx>From</span><span class=p>,</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nx>To</span><span class=p>,</span><span class=w> </span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>email</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=o>&amp;</span><span class=nx>MultipartEmail</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>From</span><span class=p>:</span><span class=w>     </span><span class=s>&#34;noreply@example.com&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>To</span><span class=p>:</span><span class=w>       </span><span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;user@example.com&#34;</span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Subject</span><span class=p>:</span><span class=w>  </span><span class=s>&#34;Welcome to Our Service&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>TextBody</span><span class=p>:</span><span class=w> </span><span class=s>&#34;Hi there,\n\nThank you for signing up!\n\nBest regards,\nThe Team&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>HTMLBody</span><span class=p>:</span><span class=w> </span><span class=s>`&lt;html&gt;&lt;body&gt;&lt;h1&gt;Welcome!&lt;/h1&gt;&lt;p&gt;Thank you for signing up!&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;`</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nf>SendMultipartEmail</span><span class=p>(</span><span class=nx>email</span><span class=p>);</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Error:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Multipart email sent!&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>This sends both plain text and HTML. Email clients show HTML if supported, otherwise fall back to plain text.</p><p>SMTP works, but building MIME messages manually is tedious. Let&rsquo;s look at libraries that make this easier.</p><h2 id=using-gomail-library-for-smtp>Using Gomail Library for SMTP</h2><p>Gomail is a popular Go library that simplifies email sending. It handles MIME encoding, attachments, and embedded images.</p><h3 id=installing-gomail>Installing Gomail</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go get gopkg.in/gomail.v2
</span></span></code></pre></div><h3 id=basic-email-with-gomail>Basic Email with Gomail</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;strconv&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;gopkg.in/gomail.v2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>gomail</span><span class=p>.</span><span class=nf>NewMessage</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Set headers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetHeader</span><span class=p>(</span><span class=s>&#34;From&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;sender@example.com&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetHeader</span><span class=p>(</span><span class=s>&#34;To&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;recipient@example.com&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetHeader</span><span class=p>(</span><span class=s>&#34;Subject&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Hello from Gomail&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Set body</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetBody</span><span class=p>(</span><span class=s>&#34;text/html&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;&lt;h1&gt;Hello!&lt;/h1&gt;&lt;p&gt;This is an HTML email.&lt;/p&gt;&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Alternative plain text</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>AddAlternative</span><span class=p>(</span><span class=s>&#34;text/plain&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Hello! This is a plain text fallback.&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// SMTP configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>port</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PORT&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>d</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>gomail</span><span class=p>.</span><span class=nf>NewDialer</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_HOST&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>port</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_USER&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PASS&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Send email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>d</span><span class=p>.</span><span class=nf>DialAndSend</span><span class=p>(</span><span class=nx>m</span><span class=p>);</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Failed to send email:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Email sent successfully!&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Much cleaner than manual MIME construction. Gomail handles all the encoding automatically.</p><h3 id=sending-email-with-attachments>Sending Email with Attachments</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;strconv&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;gopkg.in/gomail.v2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>SendEmailWithAttachment</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=p>,</span><span class=w> </span><span class=nx>attachmentPath</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>gomail</span><span class=p>.</span><span class=nf>NewMessage</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetHeader</span><span class=p>(</span><span class=s>&#34;From&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_USER&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetHeader</span><span class=p>(</span><span class=s>&#34;To&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>to</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetHeader</span><span class=p>(</span><span class=s>&#34;Subject&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetBody</span><span class=p>(</span><span class=s>&#34;text/html&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Attach file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>Attach</span><span class=p>(</span><span class=nx>attachmentPath</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>port</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PORT&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>d</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>gomail</span><span class=p>.</span><span class=nf>NewDialer</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_HOST&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>port</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_USER&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PASS&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>d</span><span class=p>.</span><span class=nf>DialAndSend</span><span class=p>(</span><span class=nx>m</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>htmlBody</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    &lt;html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;body&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;h2&gt;Invoice Attached&lt;/h2&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;Please find your invoice attached to this email.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;Thank you for your business!&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    `</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nf>SendEmailWithAttachment</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;customer@example.com&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;Your Invoice&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>htmlBody</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;./invoice.pdf&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Error:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Email with attachment sent!&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Gomail makes attachments trivial. Just call <code>Attach()</code> with the file path.</p><h3 id=embedded-images-in-html>Embedded Images in HTML</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;strconv&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;gopkg.in/gomail.v2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>SendEmailWithEmbeddedImage</span><span class=p>()</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>gomail</span><span class=p>.</span><span class=nf>NewMessage</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetHeader</span><span class=p>(</span><span class=s>&#34;From&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;noreply@example.com&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetHeader</span><span class=p>(</span><span class=s>&#34;To&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;user@example.com&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetHeader</span><span class=p>(</span><span class=s>&#34;Subject&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Newsletter with Logo&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// HTML body referencing embedded image</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>htmlBody</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    &lt;html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;body&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;img src=&#34;cid:company-logo&#34; alt=&#34;Company Logo&#34; width=&#34;200&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;h1&gt;Monthly Newsletter&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;Here&#39;s what&#39;s new this month...&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    `</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>SetBody</span><span class=p>(</span><span class=s>&#34;text/html&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>htmlBody</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Embed image with Content-ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nf>Embed</span><span class=p>(</span><span class=s>&#34;./logo.png&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>gomail</span><span class=p>.</span><span class=nf>Rename</span><span class=p>(</span><span class=s>&#34;company-logo&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>port</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PORT&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>d</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>gomail</span><span class=p>.</span><span class=nf>NewDialer</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_HOST&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>port</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_USER&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SMTP_PASS&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>d</span><span class=p>.</span><span class=nf>DialAndSend</span><span class=p>(</span><span class=nx>m</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nf>SendEmailWithEmbeddedImage</span><span class=p>();</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Error:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Email with embedded image sent!&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>The <code>cid:</code> reference in HTML links to the embedded image. Email clients display it inline.</p><p>Gomail is great for SMTP, but for production we want better deliverability. Let&rsquo;s move to SendGrid.</p><h2 id=sending-emails-with-sendgrid>Sending Emails with SendGrid</h2><p>SendGrid is one of the most popular email services. It has excellent deliverability, generous free tier (100 emails/day), and simple API.</p><h3 id=setting-up-sendgrid>Setting Up SendGrid</h3><ol><li>Sign up at <a href=https://sendgrid.com target=_blank rel="nofollow noopener noreferrer">sendgrid.com</a></li><li>Verify your sender email or domain</li><li>Create an API key in Settings > API Keys</li><li>Install the Go SDK:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go get github.com/sendgrid/sendgrid-go
</span></span></code></pre></div><h3 id=basic-sendgrid-email>Basic SendGrid Email</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;log&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/sendgrid/sendgrid-go&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/sendgrid/sendgrid-go/helpers/mail&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>from</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewEmail</span><span class=p>(</span><span class=s>&#34;Your App&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;noreply@yourdomain.com&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>to</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewEmail</span><span class=p>(</span><span class=s>&#34;User Name&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;user@example.com&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>subject</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;Welcome to Our Service&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>plainTextContent</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;Thank you for signing up!&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>htmlContent</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;&lt;strong&gt;Thank you for signing up!&lt;/strong&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewSingleEmail</span><span class=p>(</span><span class=nx>from</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>to</span><span class=p>,</span><span class=w> </span><span class=nx>plainTextContent</span><span class=p>,</span><span class=w> </span><span class=nx>htmlContent</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>client</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>sendgrid</span><span class=p>.</span><span class=nf>NewSendClient</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SENDGRID_API_KEY&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>response</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>client</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Error sending email:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Email sent! Status: %d\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>StatusCode</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Response Body:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>Body</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>SendGrid returns HTTP status codes. 202 means accepted for delivery.</p><h3 id=sendgrid-email-service-package>SendGrid Email Service Package</h3><p>Create a reusable email service:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// internal/email/sendgrid.go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>package</span><span class=w> </span><span class=nx>email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/sendgrid/sendgrid-go&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/sendgrid/sendgrid-go/helpers/mail&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>SendGridService</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>apiKey</span><span class=w>     </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fromEmail</span><span class=w>  </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fromName</span><span class=w>   </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>NewSendGridService</span><span class=p>(</span><span class=nx>apiKey</span><span class=p>,</span><span class=w> </span><span class=nx>fromEmail</span><span class=p>,</span><span class=w> </span><span class=nx>fromName</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>SendGridService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>SendGridService</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>apiKey</span><span class=p>:</span><span class=w>    </span><span class=nx>apiKey</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fromEmail</span><span class=p>:</span><span class=w> </span><span class=nx>fromEmail</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fromName</span><span class=p>:</span><span class=w>  </span><span class=nx>fromName</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>SendGridService</span><span class=p>)</span><span class=w> </span><span class=nf>SendWelcomeEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>from</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewEmail</span><span class=p>(</span><span class=nx>s</span><span class=p>.</span><span class=nx>fromName</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>to</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewEmail</span><span class=p>(</span><span class=nx>toName</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>subject</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;Welcome to Our Platform&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>plainText</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;Hi %s,\n\nWelcome to our platform!\n\nBest regards,\nThe Team&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>html</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    &lt;html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;body&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;h1&gt;Welcome, %s!&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;Thank you for joining our platform.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;We&#39;re excited to have you on board.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;a href=&#34;https://yourapp.com/get-started&#34; style=&#34;background-color: #4CAF50; color: white; padding: 10px 20px; text-decoration: none;&#34;&gt;Get Started&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    `</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewSingleEmail</span><span class=p>(</span><span class=nx>from</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>to</span><span class=p>,</span><span class=w> </span><span class=nx>plainText</span><span class=p>,</span><span class=w> </span><span class=nx>html</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>client</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>sendgrid</span><span class=p>.</span><span class=nf>NewSendClient</span><span class=p>(</span><span class=nx>s</span><span class=p>.</span><span class=nx>apiKey</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>response</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>client</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;sendgrid error: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>StatusCode</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>400</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;sendgrid returned status %d: %s&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>StatusCode</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>Body</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>SendGridService</span><span class=p>)</span><span class=w> </span><span class=nf>SendPasswordReset</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>resetToken</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>from</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewEmail</span><span class=p>(</span><span class=nx>s</span><span class=p>.</span><span class=nx>fromName</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>to</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewEmail</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>subject</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;Password Reset Request&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>resetURL</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;https://yourapp.com/reset-password?token=%s&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>resetToken</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>plainText</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;Click this link to reset your password: %s\n\nIf you didn&#39;t request this, ignore this email.&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>resetURL</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>html</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    &lt;html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;body&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;h2&gt;Password Reset Request&lt;/h2&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;We received a request to reset your password.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;Click the button below to reset your password:&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;a href=&#34;%s&#34; style=&#34;background-color: #007bff; color: white; padding: 12px 24px; text-decoration: none; display: inline-block;&#34;&gt;Reset Password&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;If you didn&#39;t request this, you can safely ignore this email.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;This link expires in 1 hour.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    `</span><span class=p>,</span><span class=w> </span><span class=nx>resetURL</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewSingleEmail</span><span class=p>(</span><span class=nx>from</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>to</span><span class=p>,</span><span class=w> </span><span class=nx>plainText</span><span class=p>,</span><span class=w> </span><span class=nx>html</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>client</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>sendgrid</span><span class=p>.</span><span class=nf>NewSendClient</span><span class=p>(</span><span class=nx>s</span><span class=p>.</span><span class=nx>apiKey</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>response</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>client</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;sendgrid error: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>StatusCode</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>400</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;sendgrid returned status %d: %s&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>StatusCode</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>Body</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Usage in your application:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;log&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;yourapp/internal/email&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>emailService</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nf>NewSendGridService</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SENDGRID_API_KEY&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;noreply@yourdomain.com&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;Your App Name&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Send welcome email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>emailService</span><span class=p>.</span><span class=nf>SendWelcomeEmail</span><span class=p>(</span><span class=s>&#34;user@example.com&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;John Doe&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Welcome email sent!&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Send password reset</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>err</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>emailService</span><span class=p>.</span><span class=nf>SendPasswordReset</span><span class=p>(</span><span class=s>&#34;user@example.com&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;reset-token-123&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Password reset email sent!&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 id=sendgrid-with-templates>SendGrid with Templates</h3><p>SendGrid has a powerful template system. Create templates in the SendGrid dashboard, then reference them in code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/sendgrid/sendgrid-go&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/sendgrid/sendgrid-go/helpers/mail&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>SendGridService</span><span class=p>)</span><span class=w> </span><span class=nf>SendTemplatedEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=p>,</span><span class=w> </span><span class=nx>templateID</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>data</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>interface</span><span class=p>{})</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>from</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewEmail</span><span class=p>(</span><span class=nx>s</span><span class=p>.</span><span class=nx>fromName</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>to</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewEmail</span><span class=p>(</span><span class=nx>toName</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewV3Mail</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>SetFrom</span><span class=p>(</span><span class=nx>from</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>SetTemplateID</span><span class=p>(</span><span class=nx>templateID</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>personalization</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewPersonalization</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>personalization</span><span class=p>.</span><span class=nf>AddTos</span><span class=p>(</span><span class=nx>to</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Add dynamic template data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>key</span><span class=p>,</span><span class=w> </span><span class=nx>value</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>data</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>personalization</span><span class=p>.</span><span class=nf>SetDynamicTemplateData</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span><span class=w> </span><span class=nx>value</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>AddPersonalizations</span><span class=p>(</span><span class=nx>personalization</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>client</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>sendgrid</span><span class=p>.</span><span class=nf>NewSendClient</span><span class=p>(</span><span class=nx>s</span><span class=p>.</span><span class=nx>apiKey</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>response</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>client</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;sendgrid error: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>StatusCode</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>400</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;sendgrid returned status %d: %s&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>StatusCode</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>Body</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Usage:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// Send using template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nx>templateData</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>interface</span><span class=p>{}{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;user_name&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;John Doe&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;order_id&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;12345&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;total_amount&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;$99.99&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>emailService</span><span class=p>.</span><span class=nf>SendTemplatedEmail</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;user@example.com&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;John Doe&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;d-template-id-here&#34;</span><span class=p>,</span><span class=w> </span><span class=c1>// Get from SendGrid dashboard</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>templateData</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><p>Templates separate email design from code. Marketers can update emails without developer involvement.</p><h3 id=sendgrid-with-attachments>SendGrid with Attachments</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;encoding/base64&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/sendgrid/sendgrid-go&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/sendgrid/sendgrid-go/helpers/mail&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>SendGridService</span><span class=p>)</span><span class=w> </span><span class=nf>SendEmailWithAttachment</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=p>,</span><span class=w> </span><span class=nx>filePath</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>from</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewEmail</span><span class=p>(</span><span class=nx>s</span><span class=p>.</span><span class=nx>fromName</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>to</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewEmail</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewSingleEmail</span><span class=p>(</span><span class=nx>from</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>to</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Read file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fileData</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>ReadFile</span><span class=p>(</span><span class=nx>filePath</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;failed to read file: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Encode to base64</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>encoded</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>base64</span><span class=p>.</span><span class=nx>StdEncoding</span><span class=p>.</span><span class=nf>EncodeToString</span><span class=p>(</span><span class=nx>fileData</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Create attachment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>attachment</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mail</span><span class=p>.</span><span class=nf>NewAttachment</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>attachment</span><span class=p>.</span><span class=nf>SetContent</span><span class=p>(</span><span class=nx>encoded</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>attachment</span><span class=p>.</span><span class=nf>SetType</span><span class=p>(</span><span class=s>&#34;application/pdf&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>attachment</span><span class=p>.</span><span class=nf>SetFilename</span><span class=p>(</span><span class=s>&#34;invoice.pdf&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>attachment</span><span class=p>.</span><span class=nf>SetDisposition</span><span class=p>(</span><span class=s>&#34;attachment&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>AddAttachment</span><span class=p>(</span><span class=nx>attachment</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>client</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>sendgrid</span><span class=p>.</span><span class=nf>NewSendClient</span><span class=p>(</span><span class=nx>s</span><span class=p>.</span><span class=nx>apiKey</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>response</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>client</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;sendgrid error: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>StatusCode</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>400</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;sendgrid returned status %d&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>StatusCode</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>SendGrid handles attachments well, but watch file sizes. Keep attachments under 10MB for best deliverability.</p><h2 id=sending-emails-with-mailgun>Sending Emails with Mailgun</h2><p>Mailgun is another excellent email service. It&rsquo;s particularly strong for high-volume sending and has powerful routing features.</p><h3 id=setting-up-mailgun>Setting Up Mailgun</h3><ol><li>Sign up at <a href=https://mailgun.com target=_blank rel="nofollow noopener noreferrer">mailgun.com</a></li><li>Add and verify your domain</li><li>Get your API key from Settings</li><li>Install the Go SDK:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go get github.com/mailgun/mailgun-go/v4
</span></span></code></pre></div><h3 id=basic-mailgun-email>Basic Mailgun Email</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;context&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;log&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;time&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/mailgun/mailgun-go/v4&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>mg</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mailgun</span><span class=p>.</span><span class=nf>NewMailgun</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;MAILGUN_DOMAIN&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;MAILGUN_API_KEY&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>sender</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;noreply@yourdomain.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>subject</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;Welcome to Our Service&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>body</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;Thank you for signing up!&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>recipient</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;user@example.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mg</span><span class=p>.</span><span class=nf>NewMessage</span><span class=p>(</span><span class=nx>sender</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=p>,</span><span class=w> </span><span class=nx>recipient</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>cancel</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nf>WithTimeout</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=o>*</span><span class=mi>10</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>defer</span><span class=w> </span><span class=nf>cancel</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>resp</span><span class=p>,</span><span class=w> </span><span class=nx>id</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mg</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;ID: %s Resp: %s\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>id</span><span class=p>,</span><span class=w> </span><span class=nx>resp</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Mailgun returns a message ID you can use for tracking.</p><h3 id=mailgun-email-service-package>Mailgun Email Service Package</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// internal/email/mailgun.go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>package</span><span class=w> </span><span class=nx>email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;context&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;time&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/mailgun/mailgun-go/v4&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>MailgunService</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>mg</span><span class=w>       </span><span class=o>*</span><span class=nx>mailgun</span><span class=p>.</span><span class=nx>MailgunImpl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>domain</span><span class=w>   </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fromEmail</span><span class=w> </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fromName</span><span class=w>  </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>NewMailgunService</span><span class=p>(</span><span class=nx>domain</span><span class=p>,</span><span class=w> </span><span class=nx>apiKey</span><span class=p>,</span><span class=w> </span><span class=nx>fromEmail</span><span class=p>,</span><span class=w> </span><span class=nx>fromName</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>MailgunService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>mg</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>mailgun</span><span class=p>.</span><span class=nf>NewMailgun</span><span class=p>(</span><span class=nx>domain</span><span class=p>,</span><span class=w> </span><span class=nx>apiKey</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>MailgunService</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>mg</span><span class=p>:</span><span class=w>        </span><span class=nx>mg</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>domain</span><span class=p>:</span><span class=w>    </span><span class=nx>domain</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fromEmail</span><span class=p>:</span><span class=w> </span><span class=nx>fromEmail</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>fromName</span><span class=p>:</span><span class=w>  </span><span class=nx>fromName</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>MailgunService</span><span class=p>)</span><span class=w> </span><span class=nf>SendWelcomeEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>sender</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%s &lt;%s&gt;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromName</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>subject</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;Welcome to Our Platform&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>text</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;Hi %s,\n\nWelcome to our platform!\n\nBest regards,\nThe Team&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>html</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    &lt;html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;body&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;h1&gt;Welcome, %s!&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;Thank you for joining our platform.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;a href=&#34;https://yourapp.com/get-started&#34;&gt;Get Started&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    `</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>mg</span><span class=p>.</span><span class=nf>NewMessage</span><span class=p>(</span><span class=nx>sender</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>text</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>SetHtml</span><span class=p>(</span><span class=nx>html</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>cancel</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nf>WithTimeout</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=o>*</span><span class=mi>10</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>defer</span><span class=w> </span><span class=nf>cancel</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>mg</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;mailgun error: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>MailgunService</span><span class=p>)</span><span class=w> </span><span class=nf>SendPasswordReset</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>resetToken</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>sender</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%s &lt;%s&gt;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromName</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>subject</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&#34;Password Reset Request&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>resetURL</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;https://yourapp.com/reset-password?token=%s&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>resetToken</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>text</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;Click this link to reset your password: %s&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>resetURL</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>html</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    &lt;html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;body&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;h2&gt;Password Reset Request&lt;/h2&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;Click the link below to reset your password:&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;a href=&#34;%s&#34;&gt;Reset Password&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>        &lt;p&gt;This link expires in 1 hour.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=s>    &lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=s>    `</span><span class=p>,</span><span class=w> </span><span class=nx>resetURL</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>mg</span><span class=p>.</span><span class=nf>NewMessage</span><span class=p>(</span><span class=nx>sender</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>text</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>SetHtml</span><span class=p>(</span><span class=nx>html</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>cancel</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nf>WithTimeout</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=o>*</span><span class=mi>10</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>defer</span><span class=w> </span><span class=nf>cancel</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>mg</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;mailgun error: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 id=mailgun-with-tags-and-tracking>Mailgun with Tags and Tracking</h3><p>Mailgun lets you tag emails for analytics and add custom variables:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>MailgunService</span><span class=p>)</span><span class=w> </span><span class=nf>SendEmailWithTracking</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>tags</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>sender</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%s &lt;%s&gt;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromName</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>mg</span><span class=p>.</span><span class=nf>NewMessage</span><span class=p>(</span><span class=nx>sender</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Add tags for tracking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>tag</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>tags</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>message</span><span class=p>.</span><span class=nf>AddTag</span><span class=p>(</span><span class=nx>tag</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Add custom variables</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>AddVariable</span><span class=p>(</span><span class=s>&#34;campaign_id&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;summer-2025&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>AddVariable</span><span class=p>(</span><span class=s>&#34;user_type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;premium&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Enable click and open tracking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>SetTracking</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>SetTrackingClicks</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>SetTrackingOpens</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>cancel</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nf>WithTimeout</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=o>*</span><span class=mi>10</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>defer</span><span class=w> </span><span class=nf>cancel</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>mg</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>err</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Tags help organize emails in Mailgun analytics. Custom variables let you store metadata with each email.</p><h3 id=mailgun-scheduled-sending>Mailgun Scheduled Sending</h3><p>Schedule emails for future delivery:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>MailgunService</span><span class=p>)</span><span class=w> </span><span class=nf>SendScheduledEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>deliveryTime</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>sender</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%s &lt;%s&gt;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromName</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>fromEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>mg</span><span class=p>.</span><span class=nf>NewMessage</span><span class=p>(</span><span class=nx>sender</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>message</span><span class=p>.</span><span class=nf>SetDeliveryTime</span><span class=p>(</span><span class=nx>deliveryTime</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>cancel</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nf>WithTimeout</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=o>*</span><span class=mi>10</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>defer</span><span class=w> </span><span class=nf>cancel</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>id</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>mg</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>message</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;mailgun error: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Scheduled email ID: %s\n&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Usage:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// Send email in 24 hours</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nx>deliveryTime</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>Add</span><span class=p>(</span><span class=mi>24</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Hour</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nx>emailService</span><span class=p>.</span><span class=nf>SendScheduledEmail</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;user@example.com&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;Don&#39;t forget!&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;Your trial ends tomorrow.&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>deliveryTime</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><p>Mailgun queues the email and sends it at the specified time.</p><h2 id=email-templates-in-go>Email Templates in Go</h2><p>Hardcoding HTML in strings is messy. Use Go&rsquo;s <code>html/template</code> package for maintainable email templates.</p><h3 id=creating-email-templates>Creating Email Templates</h3><p>Create <code>templates/welcome.html</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>body</span> <span class=p>{</span> <span class=k>font-family</span><span class=p>:</span> <span class=n>Arial</span><span class=p>,</span> <span class=kc>sans-serif</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>container</span> <span class=p>{</span> <span class=k>max-width</span><span class=p>:</span> <span class=mi>600</span><span class=kt>px</span><span class=p>;</span> <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span> <span class=kc>auto</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>header</span> <span class=p>{</span> <span class=k>background-color</span><span class=p>:</span> <span class=mh>#4CAF50</span><span class=p>;</span> <span class=k>color</span><span class=p>:</span> <span class=kc>white</span><span class=p>;</span> <span class=k>padding</span><span class=p>:</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>content</span> <span class=p>{</span> <span class=k>padding</span><span class=p>:</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>button</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>background-color</span><span class=p>:</span> <span class=mh>#4CAF50</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>color</span><span class=p>:</span> <span class=kc>white</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>10</span><span class=kt>px</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>text-decoration</span><span class=p>:</span> <span class=kc>none</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>display</span><span class=p>:</span> <span class=kc>inline-block</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;header&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>Welcome, {{.Name}}!<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;content&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Thank you for signing up for {{.AppName}}.<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Your account is ready to use.<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{.GetStartedURL}}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;button&#34;</span><span class=p>&gt;</span>Get Started<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Best regards,<span class=p>&lt;</span><span class=nt>br</span><span class=p>&gt;</span>The {{.AppName}} Team<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Template service:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// internal/email/templates.go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>package</span><span class=w> </span><span class=nx>email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;bytes&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;html/template&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;path/filepath&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>EmailTemplate</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>templatesDir</span><span class=w> </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>NewEmailTemplate</span><span class=p>(</span><span class=nx>templatesDir</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>EmailTemplate</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>EmailTemplate</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>templatesDir</span><span class=p>:</span><span class=w> </span><span class=nx>templatesDir</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>et</span><span class=w> </span><span class=o>*</span><span class=nx>EmailTemplate</span><span class=p>)</span><span class=w> </span><span class=nf>Render</span><span class=p>(</span><span class=nx>templateName</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>data</span><span class=w> </span><span class=kd>interface</span><span class=p>{})</span><span class=w> </span><span class=p>(</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>templatePath</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=nx>et</span><span class=p>.</span><span class=nx>templatesDir</span><span class=p>,</span><span class=w> </span><span class=nx>templateName</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>tmpl</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>template</span><span class=p>.</span><span class=nf>ParseFiles</span><span class=p>(</span><span class=nx>templatePath</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;failed to parse template: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>buf</span><span class=w> </span><span class=nx>bytes</span><span class=p>.</span><span class=nx>Buffer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>tmpl</span><span class=p>.</span><span class=nf>Execute</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>buf</span><span class=p>,</span><span class=w> </span><span class=nx>data</span><span class=p>);</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;failed to execute template: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>buf</span><span class=p>.</span><span class=nf>String</span><span class=p>(),</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Usage:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;log&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;yourapp/internal/email&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>templateService</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nf>NewEmailTemplate</span><span class=p>(</span><span class=s>&#34;./templates&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>data</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>interface</span><span class=p>{}{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;Name&#34;</span><span class=p>:</span><span class=w>          </span><span class=s>&#34;John Doe&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;AppName&#34;</span><span class=p>:</span><span class=w>       </span><span class=s>&#34;YourApp&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;GetStartedURL&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;https://yourapp.com/dashboard&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>html</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>templateService</span><span class=p>.</span><span class=nf>Render</span><span class=p>(</span><span class=s>&#34;welcome.html&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>data</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>html</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Now send this HTML via SendGrid or Mailgun</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Templates make emails easier to maintain. Designers can edit HTML without touching Go code.</p><h3 id=template-with-partials>Template with Partials</h3><p>For shared components like headers and footers:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- templates/partials/header.html --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;header&#34;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;background-color: #4CAF50; color: white; padding: 20px;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>{{.AppName}}<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- templates/partials/footer.html --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;footer&#34;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;padding: 20px; text-align: center; color: #666;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=ni>&amp;copy;</span> 2025 {{.AppName}}. All rights reserved.<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{.UnsubscribeURL}}&#34;</span><span class=p>&gt;</span>Unsubscribe<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- templates/newsletter.html --&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {{template &#34;header&#34; .}}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;content&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>{{.Subject}}<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>{{.Message}}<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    {{template &#34;footer&#34; .}}
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Parse multiple templates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>et</span><span class=w> </span><span class=o>*</span><span class=nx>EmailTemplate</span><span class=p>)</span><span class=w> </span><span class=nf>RenderWithPartials</span><span class=p>(</span><span class=nx>templateName</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>data</span><span class=w> </span><span class=kd>interface</span><span class=p>{})</span><span class=w> </span><span class=p>(</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>templatePath</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=nx>et</span><span class=p>.</span><span class=nx>templatesDir</span><span class=p>,</span><span class=w> </span><span class=nx>templateName</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>headerPath</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=nx>et</span><span class=p>.</span><span class=nx>templatesDir</span><span class=p>,</span><span class=w> </span><span class=s>&#34;partials&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;header.html&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>footerPath</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=nx>et</span><span class=p>.</span><span class=nx>templatesDir</span><span class=p>,</span><span class=w> </span><span class=s>&#34;partials&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;footer.html&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>tmpl</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>template</span><span class=p>.</span><span class=nf>ParseFiles</span><span class=p>(</span><span class=nx>templatePath</span><span class=p>,</span><span class=w> </span><span class=nx>headerPath</span><span class=p>,</span><span class=w> </span><span class=nx>footerPath</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>buf</span><span class=w> </span><span class=nx>bytes</span><span class=p>.</span><span class=nx>Buffer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>tmpl</span><span class=p>.</span><span class=nf>Execute</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>buf</span><span class=p>,</span><span class=w> </span><span class=nx>data</span><span class=p>);</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>buf</span><span class=p>.</span><span class=nf>String</span><span class=p>(),</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Partials let you reuse email components across multiple templates.</p><h2 id=error-handling-and-retries>Error Handling and Retries</h2><p>Email sending can fail. Networks timeout, APIs have outages, rate limits trigger. Production apps need robust error handling.</p><h3 id=retry-logic>Retry Logic</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;time&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>RetryConfig</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>MaxAttempts</span><span class=w> </span><span class=kt>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>InitialDelay</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>MaxDelay</span><span class=w>     </span><span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Multiplier</span><span class=w>   </span><span class=kt>float64</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>DefaultRetryConfig</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=nx>RetryConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>RetryConfig</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>MaxAttempts</span><span class=p>:</span><span class=w>  </span><span class=mi>3</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>InitialDelay</span><span class=p>:</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>MaxDelay</span><span class=p>:</span><span class=w>     </span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>30</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Multiplier</span><span class=p>:</span><span class=w>   </span><span class=mf>2.0</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>SendGridService</span><span class=p>)</span><span class=w> </span><span class=nf>SendWithRetry</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>config</span><span class=w> </span><span class=o>*</span><span class=nx>RetryConfig</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>lastErr</span><span class=w> </span><span class=kt>error</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>delay</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>InitialDelay</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>attempt</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=nx>attempt</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>MaxAttempts</span><span class=p>;</span><span class=w> </span><span class=nx>attempt</span><span class=o>++</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nf>sendEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>lastErr</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>err</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>attempt</span><span class=w> </span><span class=p>&lt;</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>MaxAttempts</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=nx>delay</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// Exponential backoff</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>delay</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nf>Duration</span><span class=p>(</span><span class=nb>float64</span><span class=p>(</span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>Multiplier</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=nx>delay</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>MaxDelay</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nx>delay</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>MaxDelay</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;failed after %d attempts: %w&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>MaxAttempts</span><span class=p>,</span><span class=w> </span><span class=nx>lastErr</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>SendGridService</span><span class=p>)</span><span class=w> </span><span class=nf>sendEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>subject</span><span class=p>,</span><span class=w> </span><span class=nx>body</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Your SendGrid send logic here</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>This implements exponential backoff. First retry waits 1 second, second waits 2 seconds, third waits 4 seconds.</p><h3 id=circuit-breaker-pattern>Circuit Breaker Pattern</h3><p>Prevent cascading failures when email service is down:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;sync&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;time&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>CircuitBreaker</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>maxFailures</span><span class=w> </span><span class=kt>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>timeout</span><span class=w>     </span><span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>failures</span><span class=w>    </span><span class=kt>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>lastFailure</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>state</span><span class=w>       </span><span class=kt>string</span><span class=w> </span><span class=c1>// &#34;closed&#34;, &#34;open&#34;, &#34;half-open&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>mu</span><span class=w>          </span><span class=nx>sync</span><span class=p>.</span><span class=nx>Mutex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>NewCircuitBreaker</span><span class=p>(</span><span class=nx>maxFailures</span><span class=w> </span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=nx>timeout</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>CircuitBreaker</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>CircuitBreaker</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>maxFailures</span><span class=p>:</span><span class=w> </span><span class=nx>maxFailures</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>timeout</span><span class=p>:</span><span class=w>     </span><span class=nx>timeout</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>state</span><span class=p>:</span><span class=w>       </span><span class=s>&#34;closed&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>cb</span><span class=w> </span><span class=o>*</span><span class=nx>CircuitBreaker</span><span class=p>)</span><span class=w> </span><span class=nf>Call</span><span class=p>(</span><span class=nx>fn</span><span class=w> </span><span class=kd>func</span><span class=p>()</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>cb</span><span class=p>.</span><span class=nx>mu</span><span class=p>.</span><span class=nf>Lock</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>cb</span><span class=p>.</span><span class=nx>state</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&#34;open&#34;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nf>Since</span><span class=p>(</span><span class=nx>cb</span><span class=p>.</span><span class=nx>lastFailure</span><span class=p>)</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=nx>cb</span><span class=p>.</span><span class=nx>timeout</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>cb</span><span class=p>.</span><span class=nx>state</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#34;half-open&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>cb</span><span class=p>.</span><span class=nx>failures</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>cb</span><span class=p>.</span><span class=nx>mu</span><span class=p>.</span><span class=nf>Unlock</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;circuit breaker is open&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>cb</span><span class=p>.</span><span class=nx>mu</span><span class=p>.</span><span class=nf>Unlock</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nf>fn</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>cb</span><span class=p>.</span><span class=nx>mu</span><span class=p>.</span><span class=nf>Lock</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>defer</span><span class=w> </span><span class=nx>cb</span><span class=p>.</span><span class=nx>mu</span><span class=p>.</span><span class=nf>Unlock</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>cb</span><span class=p>.</span><span class=nx>failures</span><span class=o>++</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>cb</span><span class=p>.</span><span class=nx>lastFailure</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>cb</span><span class=p>.</span><span class=nx>failures</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=nx>cb</span><span class=p>.</span><span class=nx>maxFailures</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>cb</span><span class=p>.</span><span class=nx>state</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#34;open&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>err</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>cb</span><span class=p>.</span><span class=nx>state</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&#34;half-open&#34;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>cb</span><span class=p>.</span><span class=nx>state</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#34;closed&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>cb</span><span class=p>.</span><span class=nx>failures</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Usage:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>breaker</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nf>NewCircuitBreaker</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Minute</span><span class=o>*</span><span class=mi>5</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>breaker</span><span class=p>.</span><span class=nf>Call</span><span class=p>(</span><span class=kd>func</span><span class=p>()</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>emailService</span><span class=p>.</span><span class=nf>SendWelcomeEmail</span><span class=p>(</span><span class=s>&#34;user@example.com&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;John&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Email failed:&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>After 5 failures, circuit opens for 5 minutes. This prevents hammering a failed service.</p><h2 id=email-queue-with-background-jobs>Email Queue with Background Jobs</h2><p>Don&rsquo;t send emails in HTTP handlers. Use background jobs for better performance and reliability.</p><p>Integration with Asynq (from previous article):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// internal/tasks/email.go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>package</span><span class=w> </span><span class=nx>tasks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;context&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;encoding/json&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;github.com/hibiken/asynq&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;yourapp/internal/email&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>const</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>TypeEmailWelcome</span><span class=w>       </span><span class=p>=</span><span class=w> </span><span class=s>&#34;email:welcome&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>TypeEmailPasswordReset</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#34;email:password_reset&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>EmailWelcomePayload</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Email</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=s>`json:&#34;email&#34;`</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Name</span><span class=w>  </span><span class=kt>string</span><span class=w> </span><span class=s>`json:&#34;name&#34;`</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>NewEmailWelcomeTask</span><span class=p>(</span><span class=nx>email</span><span class=p>,</span><span class=w> </span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>asynq</span><span class=p>.</span><span class=nx>Task</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>payload</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>json</span><span class=p>.</span><span class=nf>Marshal</span><span class=p>(</span><span class=nx>EmailWelcomePayload</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Email</span><span class=p>:</span><span class=w> </span><span class=nx>email</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Name</span><span class=p>:</span><span class=w>  </span><span class=nx>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>asynq</span><span class=p>.</span><span class=nf>NewTask</span><span class=p>(</span><span class=nx>TypeEmailWelcome</span><span class=p>,</span><span class=w> </span><span class=nx>payload</span><span class=p>),</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>HandleEmailWelcomeTask</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>t</span><span class=w> </span><span class=o>*</span><span class=nx>asynq</span><span class=p>.</span><span class=nx>Task</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>p</span><span class=w> </span><span class=nx>EmailWelcomePayload</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>json</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>(</span><span class=nx>t</span><span class=p>.</span><span class=nf>Payload</span><span class=p>(),</span><span class=w> </span><span class=o>&amp;</span><span class=nx>p</span><span class=p>);</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>err</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>emailService</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nf>NewSendGridService</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SENDGRID_API_KEY&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;noreply@yourdomain.com&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;Your App&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>emailService</span><span class=p>.</span><span class=nf>SendWelcomeEmail</span><span class=p>(</span><span class=nx>p</span><span class=p>.</span><span class=nx>Email</span><span class=p>,</span><span class=w> </span><span class=nx>p</span><span class=p>.</span><span class=nx>Name</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>In your HTTP handler:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span><span class=w> </span><span class=nf>signupHandler</span><span class=p>(</span><span class=nx>w</span><span class=w> </span><span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span><span class=w> </span><span class=nx>r</span><span class=w> </span><span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>email</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>r</span><span class=p>.</span><span class=nf>FormValue</span><span class=p>(</span><span class=s>&#34;email&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>name</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>r</span><span class=p>.</span><span class=nf>FormValue</span><span class=p>(</span><span class=s>&#34;name&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Create user in database</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>user</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nf>createUser</span><span class=p>(</span><span class=nx>email</span><span class=p>,</span><span class=w> </span><span class=nx>name</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Queue welcome email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>task</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>tasks</span><span class=p>.</span><span class=nf>NewEmailWelcomeTask</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>Email</span><span class=p>,</span><span class=w> </span><span class=nx>user</span><span class=p>.</span><span class=nx>Name</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>queueClient</span><span class=p>.</span><span class=nf>Enqueue</span><span class=p>(</span><span class=nx>task</span><span class=p>,</span><span class=w> </span><span class=nx>asynq</span><span class=p>.</span><span class=nf>Queue</span><span class=p>(</span><span class=s>&#34;emails&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Return immediately</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>w</span><span class=p>.</span><span class=nf>WriteHeader</span><span class=p>(</span><span class=nx>http</span><span class=p>.</span><span class=nx>StatusCreated</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>json</span><span class=p>.</span><span class=nf>NewEncoder</span><span class=p>(</span><span class=nx>w</span><span class=p>).</span><span class=nf>Encode</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;message&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;Account created! Check your email.&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>User gets instant response. Email sends in background. If email fails, Asynq retries automatically.</p><p>For more on background jobs, see our guide on <a href=/2025/10/how-to-implement-background-jobs-in-go-with-asynq-and-redis.html>implementing background jobs with Asynq
</a>.</p><h2 id=avoiding-spam-filters>Avoiding Spam Filters</h2><p>Even with email services, emails can land in spam. Here&rsquo;s how to avoid it.</p><h3 id=domain-authentication>Domain Authentication</h3><p>Set up SPF, DKIM, and DMARC records:</p><p><strong>SPF Record</strong> (DNS TXT):</p><pre tabindex=0><code>v=spf1 include:sendgrid.net ~all
</code></pre><p><strong>DKIM</strong> - SendGrid/Mailgun provide keys to add to DNS.</p><p><strong>DMARC Record</strong>:</p><pre tabindex=0><code>v=DMARC1; p=quarantine; rua=mailto:dmarc@yourdomain.com
</code></pre><p>These prove your emails come from authorized servers.</p><h3 id=email-content-best-practices>Email Content Best Practices</h3><p>Spam filters analyze content. Follow these rules:</p><p><strong>Subject lines:</strong></p><ul><li>Avoid ALL CAPS</li><li>Don&rsquo;t use excessive punctuation (!!!)</li><li>Skip spam words: &ldquo;FREE&rdquo;, &ldquo;WINNER&rdquo;, &ldquo;CLICK HERE&rdquo;</li><li>Keep under 50 characters</li></ul><p><strong>Body content:</strong></p><ul><li>Include unsubscribe link</li><li>Use real sender name and address</li><li>Balance text and images</li><li>Avoid URL shorteners</li><li>Include physical address (legal requirement)</li></ul><p><strong>HTML:</strong></p><ul><li>Keep HTML simple</li><li>Avoid JavaScript</li><li>Use inline CSS</li><li>Test in multiple clients</li><li>Include plain text version</li></ul><h3 id=sender-reputation>Sender Reputation</h3><p>ISPs track your sending patterns:</p><p><strong>Warm up new domains</strong> - Start with low volumes (100/day), gradually increase over weeks.</p><p><strong>Monitor bounce rates</strong> - Keep under 2%. Remove invalid addresses quickly.</p><p><strong>Watch spam complaints</strong> - Under 0.1% is good. Over 0.5% is bad.</p><p><strong>Consistent sending</strong> - Don&rsquo;t go from 0 to 10,000 emails overnight.</p><p><strong>Engagement matters</strong> - High open rates improve reputation. Low engagement hurts it.</p><h2 id=comparison-smtp-vs-sendgrid-vs-mailgun>Comparison: SMTP vs SendGrid vs Mailgun</h2><p>Here&rsquo;s how the three approaches compare:</p><table><thead><tr><th>Feature</th><th>Raw SMTP</th><th>SendGrid</th><th>Mailgun</th></tr></thead><tbody><tr><td><strong>Setup Complexity</strong></td><td>High</td><td>Low</td><td>Low</td></tr><tr><td><strong>Deliverability</strong></td><td>Poor (self-managed)</td><td>Excellent</td><td>Excellent</td></tr><tr><td><strong>Cost</strong></td><td>Free (own server)</td><td>Free tier: 100/day</td><td>Free trial: 5k/month</td></tr><tr><td><strong>Pricing (1M emails)</strong></td><td>Infrastructure costs</td><td>$14.95/month</td><td>$35/month</td></tr><tr><td><strong>Analytics</strong></td><td>None</td><td>Detailed</td><td>Detailed</td></tr><tr><td><strong>Templates</strong></td><td>Manual</td><td>Built-in</td><td>API-based</td></tr><tr><td><strong>Bounce Handling</strong></td><td>Manual</td><td>Automatic</td><td>Automatic</td></tr><tr><td><strong>API Quality</strong></td><td>SMTP only</td><td>Excellent REST API</td><td>Excellent REST API</td></tr><tr><td><strong>Webhooks</strong></td><td>No</td><td>Yes</td><td>Yes</td></tr><tr><td><strong>Learning Curve</strong></td><td>Low</td><td>Low</td><td>Medium</td></tr><tr><td><strong>Best For</strong></td><td>Testing</td><td>Getting started fast</td><td>High volume</td></tr></tbody></table><p><strong>When to use each:</strong></p><p><strong>SMTP</strong> - Local development and testing only. Use Mailtrap.io or Gmail for dev environments.</p><p><strong>SendGrid</strong> - Best for:</p><ul><li>Small to medium volume</li><li>Quick setup needed</li><li>Want simple pricing</li><li>Need excellent documentation</li></ul><p><strong>Mailgun</strong> - Best for:</p><ul><li>High volume sending</li><li>Need advanced routing</li><li>Want better pricing at scale</li><li>Prefer more control</li></ul><p>For most Go applications, start with SendGrid. Switch to Mailgun when you exceed SendGrid&rsquo;s pricing sweet spot.</p><h2 id=production-best-practices>Production Best Practices</h2><h3 id=environment-configuration>Environment Configuration</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// internal/config/email.go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>package</span><span class=w> </span><span class=nx>config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;os&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>EmailConfig</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Provider</span><span class=w>    </span><span class=kt>string</span><span class=w> </span><span class=c1>// &#34;sendgrid&#34; or &#34;mailgun&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>APIKey</span><span class=w>      </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Domain</span><span class=w>      </span><span class=kt>string</span><span class=w> </span><span class=c1>// For Mailgun</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>FromEmail</span><span class=w>   </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>FromName</span><span class=w>    </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>ReplyTo</span><span class=w>     </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>LoadEmailConfig</span><span class=p>()</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>EmailConfig</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>provider</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;EMAIL_PROVIDER&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>provider</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;EMAIL_PROVIDER not set&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>config</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=o>&amp;</span><span class=nx>EmailConfig</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Provider</span><span class=p>:</span><span class=w>  </span><span class=nx>provider</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>FromEmail</span><span class=p>:</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;EMAIL_FROM&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>FromName</span><span class=p>:</span><span class=w>  </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;EMAIL_FROM_NAME&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>ReplyTo</span><span class=p>:</span><span class=w>   </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;EMAIL_REPLY_TO&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>switch</span><span class=w> </span><span class=nx>provider</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>case</span><span class=w> </span><span class=s>&#34;sendgrid&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>config</span><span class=p>.</span><span class=nx>APIKey</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;SENDGRID_API_KEY&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>APIKey</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;SENDGRID_API_KEY not set&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>case</span><span class=w> </span><span class=s>&#34;mailgun&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>config</span><span class=p>.</span><span class=nx>APIKey</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;MAILGUN_API_KEY&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>config</span><span class=p>.</span><span class=nx>Domain</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;MAILGUN_DOMAIN&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>APIKey</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>Domain</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;MAILGUN_API_KEY or MAILGUN_DOMAIN not set&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unknown email provider: %s&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>provider</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>config</span><span class=p>,</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Environment variables (<code>.env</code>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>EMAIL_PROVIDER</span><span class=o>=</span>sendgrid
</span></span><span class=line><span class=cl><span class=nv>SENDGRID_API_KEY</span><span class=o>=</span>your-api-key
</span></span><span class=line><span class=cl><span class=nv>EMAIL_FROM</span><span class=o>=</span>noreply@yourdomain.com
</span></span><span class=line><span class=cl><span class=nv>EMAIL_FROM_NAME</span><span class=o>=</span>Your App Name
</span></span><span class=line><span class=cl><span class=nv>EMAIL_REPLY_TO</span><span class=o>=</span>support@yourdomain.com
</span></span></code></pre></div><h3 id=email-interface-for-flexibility>Email Interface for Flexibility</h3><p>Abstract email sending behind an interface:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// internal/email/interface.go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>package</span><span class=w> </span><span class=nx>email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>EmailSender</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nf>SendWelcomeEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nf>SendPasswordReset</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>resetToken</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nf>SendVerificationEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>verificationToken</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>NewEmailSender</span><span class=p>(</span><span class=nx>provider</span><span class=p>,</span><span class=w> </span><span class=nx>apiKey</span><span class=p>,</span><span class=w> </span><span class=nx>domain</span><span class=p>,</span><span class=w> </span><span class=nx>fromEmail</span><span class=p>,</span><span class=w> </span><span class=nx>fromName</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>EmailSender</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>switch</span><span class=w> </span><span class=nx>provider</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>case</span><span class=w> </span><span class=s>&#34;sendgrid&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nf>NewSendGridService</span><span class=p>(</span><span class=nx>apiKey</span><span class=p>,</span><span class=w> </span><span class=nx>fromEmail</span><span class=p>,</span><span class=w> </span><span class=nx>fromName</span><span class=p>),</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>case</span><span class=w> </span><span class=s>&#34;mailgun&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nf>NewMailgunService</span><span class=p>(</span><span class=nx>domain</span><span class=p>,</span><span class=w> </span><span class=nx>apiKey</span><span class=p>,</span><span class=w> </span><span class=nx>fromEmail</span><span class=p>,</span><span class=w> </span><span class=nx>fromName</span><span class=p>),</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unknown provider: %s&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>provider</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Your application code depends on the interface, not specific implementations. Switching providers is configuration change, not code change.</p><h3 id=logging-and-monitoring>Logging and Monitoring</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nx>email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;fmt&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;log&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;time&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>LoggingEmailService</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>underlying</span><span class=w> </span><span class=nx>EmailSender</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>NewLoggingEmailService</span><span class=p>(</span><span class=nx>underlying</span><span class=w> </span><span class=nx>EmailSender</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>LoggingEmailService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>LoggingEmailService</span><span class=p>{</span><span class=nx>underlying</span><span class=p>:</span><span class=w> </span><span class=nx>underlying</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>l</span><span class=w> </span><span class=o>*</span><span class=nx>LoggingEmailService</span><span class=p>)</span><span class=w> </span><span class=nf>SendWelcomeEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>start</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>log</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Sending welcome email to %s (%s)&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>l</span><span class=p>.</span><span class=nx>underlying</span><span class=p>.</span><span class=nf>SendWelcomeEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>duration</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nf>Since</span><span class=p>(</span><span class=nx>start</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>log</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Failed to send welcome email to %s: %v (took %v)&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>,</span><span class=w> </span><span class=nx>duration</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>err</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>log</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Successfully sent welcome email to %s (took %v)&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>duration</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Wrap your email service with logging. Track successes, failures, and latency.</p><p>For production monitoring, integrate with your observability stack. Send metrics to Prometheus:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=s>&#34;github.com/prometheus/client_golang/prometheus&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>var</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>emailsSent</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>prometheus</span><span class=p>.</span><span class=nf>NewCounterVec</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>CounterOpts</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>Name</span><span class=p>:</span><span class=w> </span><span class=s>&#34;emails_sent_total&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>Help</span><span class=p>:</span><span class=w> </span><span class=s>&#34;Total number of emails sent&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;status&#34;</span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>emailDuration</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>prometheus</span><span class=p>.</span><span class=nf>NewHistogramVec</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>HistogramOpts</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>Name</span><span class=p>:</span><span class=w> </span><span class=s>&#34;email_send_duration_seconds&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>Help</span><span class=p>:</span><span class=w> </span><span class=s>&#34;Email sending duration&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;type&#34;</span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h3 id=testing-email-code>Testing Email Code</h3><p>Don&rsquo;t send real emails in tests. Use mock services:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// internal/email/mock.go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>package</span><span class=w> </span><span class=nx>email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>MockEmailService</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>SentEmails</span><span class=w> </span><span class=p>[]</span><span class=nx>SentEmail</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>type</span><span class=w> </span><span class=nx>SentEmail</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>To</span><span class=w>      </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Subject</span><span class=w> </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Body</span><span class=w>    </span><span class=kt>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=nf>NewMockEmailService</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=nx>MockEmailService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>MockEmailService</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>SentEmails</span><span class=p>:</span><span class=w> </span><span class=nb>make</span><span class=p>([]</span><span class=nx>SentEmail</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>m</span><span class=w> </span><span class=o>*</span><span class=nx>MockEmailService</span><span class=p>)</span><span class=w> </span><span class=nf>SendWelcomeEmail</span><span class=p>(</span><span class=nx>toEmail</span><span class=p>,</span><span class=w> </span><span class=nx>toName</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>m</span><span class=p>.</span><span class=nx>SentEmails</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>m</span><span class=p>.</span><span class=nx>SentEmails</span><span class=p>,</span><span class=w> </span><span class=nx>SentEmail</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>To</span><span class=p>:</span><span class=w>      </span><span class=nx>toEmail</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Subject</span><span class=p>:</span><span class=w> </span><span class=s>&#34;Welcome&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Body</span><span class=p>:</span><span class=w>    </span><span class=s>&#34;Welcome email body&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>In tests:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span><span class=w> </span><span class=nf>TestSignupHandler</span><span class=p>(</span><span class=nx>t</span><span class=w> </span><span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>T</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>mockEmail</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>email</span><span class=p>.</span><span class=nf>NewMockEmailService</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Your handler uses mockEmail</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>handler</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nf>NewSignupHandler</span><span class=p>(</span><span class=nx>mockEmail</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Make request</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>handler</span><span class=p>.</span><span class=nf>HandleSignup</span><span class=p>(</span><span class=nx>email</span><span class=p>,</span><span class=w> </span><span class=nx>name</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Verify email was sent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>mockEmail</span><span class=p>.</span><span class=nx>SentEmails</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>t</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Expected 1 email, got %d&#34;</span><span class=p>,</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>mockEmail</span><span class=p>.</span><span class=nx>SentEmails</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>mockEmail</span><span class=p>.</span><span class=nx>SentEmails</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>To</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s>&#34;user@example.com&#34;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>t</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Wrong recipient&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>For integration testing, use Mailtrap.io or MailHog - they&rsquo;re SMTP servers that catch emails instead of delivering them.</p><h2 id=troubleshooting-common-issues>Troubleshooting Common Issues</h2><p><strong>Emails not arriving:</strong></p><ul><li>Check spam folder first</li><li>Verify API key is correct</li><li>Check sender email is verified</li><li>Look for errors in logs</li><li>Verify email address is valid</li></ul><p><strong>High bounce rate:</strong></p><ul><li>Validate emails before sending</li><li>Remove invalid addresses</li><li>Check for typos in email addresses</li><li>Verify domain hasn&rsquo;t blocked you</li></ul><p><strong>Marked as spam:</strong></p><ul><li>Set up SPF/DKIM/DMARC</li><li>Avoid spam trigger words</li><li>Include unsubscribe link</li><li>Send from consistent address</li><li>Warm up sending domain</li></ul><p><strong>API rate limits:</strong></p><ul><li>Implement exponential backoff</li><li>Spread sends over time</li><li>Use background jobs</li><li>Upgrade to higher tier</li></ul><p><strong>Images not displaying:</strong></p><ul><li>Use absolute URLs</li><li>Host images on CDN</li><li>Test in multiple email clients</li><li>Consider embedding images</li></ul><h2 id=wrapping-up>Wrapping Up</h2><p>Email sending in Go is straightforward once you understand the options. SMTP works for testing but production needs email services like SendGrid or Mailgun.</p><p>SendGrid is easier to start with - great free tier, simple API, excellent docs. Mailgun offers better pricing at scale and more advanced features. Both handle deliverability, bounces, and analytics so you don&rsquo;t have to.</p><p>The key patterns: use background jobs to avoid blocking requests, implement retry logic for reliability, abstract behind interfaces for flexibility, monitor failures and delivery rates, and test with mocks to avoid sending real emails.</p><p>Start simple with SendGrid&rsquo;s free tier. As your volume grows, evaluate if Mailgun&rsquo;s pricing works better. Both are production-ready and trusted by thousands of applications.</p><p>For building complete Go applications, check out our guides on <a href=/2025/09/building-rest-api-gin-framework-golang-production-ready.html>REST API development with Gin
</a>, <a href=/2025/10/how-to-perform-database-migrations-in-go-using-golang-migrate.html>database migrations
</a>, and <a href=/2025/10/how-to-implement-background-jobs-in-go-with-asynq-and-redis.html>background job processing
</a>.</p><p>Email is essential infrastructure. Get it right from the start and your users will actually receive the messages you send them.</p></p><div class="bg-gray-100 dark:bg-gray-800 p-4 my-8 rounded"><h2 class="text-lg font-semibold mb-2">ðŸ“Œ Read Also</h2><ul class="list-disc list-outside ml-5"><li><a href=/2025/11/how-to-implement-passkey-authentication-go-webauthn.html class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">How to Implement Passkey Authentication with Go - WebAuthn Tutorial</a></li><li><a href=/2025/10/how-to-implement-message-queuing-with-rabbitmq-in-go.html class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">How to Implement Message Queuing with RabbitMQ in Go</a></li><li><a href=/2025/10/how-to-build-ai-llm-applications-in-go-openai-and-ollama-integration.html class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">How to Build AI/LLM Applications in Go - OpenAI and Ollama Integration</a></li></ul></div><div class="hidden lg:block"><div class="my-8 py-6 border-t border-b border-gray-200 dark:border-gray-700"><div class="max-w-4xl mx-auto"><div class="text-center mb-3"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block;min-height:90px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></div><div class="block lg:hidden my-8 px-2 mb-10"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block;min-height:50px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><div class="lg:hidden mt-8 pt-8 border-t border-gray-200 dark:border-gray-700"><h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Popular Posts</h3><div class="grid gap-3"><a href=/2025/11/how-to-implement-passkey-authentication-go-webauthn.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Implement Passkey Authentication with Go - WebAuthn Tutorial</h4><p class="text-xs text-gray-500 dark:text-gray-400">09 Nov 2025</p></a><a href=/2025/10/how-to-build-rest-api-django-rest-framework-production-ready.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Build a REST API with Django REST Framework (Production Ready)</h4><p class="text-xs text-gray-500 dark:text-gray-400">29 Oct 2025</p></a><a href=/2025/10/python-automation-scripts-every-developer-should-know.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">Python Automation Scripts Every Developer Should Know (Save Hours Weekly)</h4><p class="text-xs text-gray-500 dark:text-gray-400">28 Oct 2025</p></a><a href=/2025/10/how-to-analyze-data-python-pandas-from-zero-to-insights.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Analyze Data with Python Pandas: From Zero to Data Insights</h4><p class="text-xs text-gray-500 dark:text-gray-400">28 Oct 2025</p></a><a href=/2025/10/how-to-build-web-scraper-python-beautifulsoup-requests.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Build a Web Scraper in Python with BeautifulSoup and Requests</h4><p class="text-xs text-gray-500 dark:text-gray-400">27 Oct 2025</p></a></div></div><div class="my-8 py-6"><div class="max-w-4xl mx-auto"><div class="text-center mb-3"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block data-ad-format=autorelaxed data-ad-client=ca-pub-3149036684216973 data-ad-slot=7106179106></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><div class="not-prose my-12 -mx-4 sm:-mx-6 lg:mx-0"><div class=max-w-full><div class=mb-8><h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-2">Frequently Asked Questions</h2><p class="text-gray-600 dark:text-gray-400">Find quick answers to common questions</p></div><ul class="faq-list space-y-0 list-none p-0 m-0"><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">What is the best way to send emails in Go?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>The best way to send emails in Go depends on your needs. For simple applications, use Go&rsquo;s built-in net/smtp package with your SMTP server. For production applications with high deliverability requirements, use email service APIs like SendGrid or Mailgun. They handle deliverability, bounce management, and analytics better than raw SMTP. SendGrid is easier to start with, while Mailgun offers better pricing for high volumes.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">Can you send emails using Gmail SMTP in Go?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Yes, you can send emails using Gmail SMTP in Go, but it&rsquo;s not recommended for production. Gmail has strict rate limits (500 emails per day), requires app-specific passwords, and may block your account for suspicious activity. Use Gmail SMTP only for development and testing. For production, use dedicated email service providers like SendGrid, Mailgun, or AWS SES that are designed for transactional emails.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">How do you send HTML emails with attachments in Go?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>To send HTML emails with attachments in Go, create a multipart MIME message. Set the Content-Type to multipart/mixed for the outer message, then add a multipart/alternative section containing plain text and HTML versions. For attachments, encode files in base64 and add them as additional MIME parts with appropriate Content-Type and Content-Disposition headers. Libraries like gomail make this easier by handling MIME encoding automatically.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">What's the difference between SendGrid and Mailgun for Go applications?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>SendGrid and Mailgun are both excellent for Go applications but have different strengths. SendGrid offers simpler pricing, better documentation, and easier setup - good for getting started quickly. Mailgun provides better deliverability features, powerful routing rules, and more cost-effective pricing at higher volumes. SendGrid has a more generous free tier (100 emails/day), while Mailgun offers 5,000 free emails for three months.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">How do you handle email sending errors in production?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Handle email errors in production by implementing retry logic with exponential backoff, using background job queues to avoid blocking HTTP requests, logging all failures with context for debugging, monitoring delivery rates and bounce metrics, and implementing fallback mechanisms to alternative providers if the primary service fails. Never expose API keys in error messages and always validate email addresses before attempting to send.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">Do you need to verify email addresses before sending in Go?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Yes, you should verify email addresses before sending. Use regex validation for basic format checking, DNS MX record lookup to verify the domain accepts emails, and consider using email verification services for critical flows. However, the only way to truly verify an email works is to send a confirmation email. Implement double opt-in for newsletter subscriptions and verify email ownership for critical operations like password resets.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">How do you send bulk emails without getting marked as spam?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>To avoid spam filters when sending bulk emails, authenticate your domain with SPF, DKIM, and DMARC records. Use a reputable email service provider like SendGrid or Mailgun. Include unsubscribe links in every email. Avoid spam trigger words in subject lines. Send emails from a consistent sender address. Warm up new sending domains gradually. Monitor bounce rates and remove invalid addresses. Never buy email lists - only send to users who opted in.</div></div></details></li></ul></div></div><script type=application/ld+json>
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    
    
    {
      "@type": "Question",
      "name": "\"What is the best way to send emails in Go?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"The best way to send emails in Go depends on your needs. For simple applications, use Go's built-in net/smtp package with your SMTP server. For production applications with high deliverability requirements, use email service APIs like SendGrid or Mailgun. They handle deliverability, bounce management, and analytics better than raw SMTP. SendGrid is easier to start with, while Mailgun offers better pricing for high volumes.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"Can you send emails using Gmail SMTP in Go?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Yes, you can send emails using Gmail SMTP in Go, but it's not recommended for production. Gmail has strict rate limits (500 emails per day), requires app-specific passwords, and may block your account for suspicious activity. Use Gmail SMTP only for development and testing. For production, use dedicated email service providers like SendGrid, Mailgun, or AWS SES that are designed for transactional emails.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"How do you send HTML emails with attachments in Go?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"To send HTML emails with attachments in Go, create a multipart MIME message. Set the Content-Type to multipart/mixed for the outer message, then add a multipart/alternative section containing plain text and HTML versions. For attachments, encode files in base64 and add them as additional MIME parts with appropriate Content-Type and Content-Disposition headers. Libraries like gomail make this easier by handling MIME encoding automatically.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"What's the difference between SendGrid and Mailgun for Go applications?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"SendGrid and Mailgun are both excellent for Go applications but have different strengths. SendGrid offers simpler pricing, better documentation, and easier setup - good for getting started quickly. Mailgun provides better deliverability features, powerful routing rules, and more cost-effective pricing at higher volumes. SendGrid has a more generous free tier (100 emails/day), while Mailgun offers 5,000 free emails for three months.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"How do you handle email sending errors in production?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Handle email errors in production by implementing retry logic with exponential backoff, using background job queues to avoid blocking HTTP requests, logging all failures with context for debugging, monitoring delivery rates and bounce metrics, and implementing fallback mechanisms to alternative providers if the primary service fails. Never expose API keys in error messages and always validate email addresses before attempting to send.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"Do you need to verify email addresses before sending in Go?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Yes, you should verify email addresses before sending. Use regex validation for basic format checking, DNS MX record lookup to verify the domain accepts emails, and consider using email verification services for critical flows. However, the only way to truly verify an email works is to send a confirmation email. Implement double opt-in for newsletter subscriptions and verify email ownership for critical operations like password resets.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"How do you send bulk emails without getting marked as spam?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"To avoid spam filters when sending bulk emails, authenticate your domain with SPF, DKIM, and DMARC records. Use a reputable email service provider like SendGrid or Mailgun. Include unsubscribe links in every email. Avoid spam trigger words in subject lines. Send emails from a consistent sender address. Warm up new sending domains gradually. Monitor bounce rates and remove invalid addresses. Never buy email lists - only send to users who opted in.\""
      }
    }
    
  ]
}
</script><style>details.faq-details[open] .faq-arrow svg{transform:rotate(180deg)}</style><script>document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".faq-item");e.forEach(function(t){t.addEventListener("toggle",function(){this.open&&e.forEach(function(e){e!==t&&e.open&&(e.open=!1)})})})})</script></article><aside class="space-y-10 hidden lg:block"><div><h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Popular Posts</h3><ul class="space-y-3 list-disc list-outside pl-5 text-sm text-gray-800 dark:text-gray-200"><li><a href=/2025/11/how-to-implement-passkey-authentication-go-webauthn.html class="hover:text-[#0f7ea9] transition">How to Implement Passkey Authentication with Go - WebAuthn Tutorial</a></li><li><a href=/2025/10/how-to-build-rest-api-django-rest-framework-production-ready.html class="hover:text-[#0f7ea9] transition">How to Build a REST API with Django REST Framework (Production Ready)</a></li><li><a href=/2025/10/python-automation-scripts-every-developer-should-know.html class="hover:text-[#0f7ea9] transition">Python Automation Scripts Every Developer Should Know (Save Hours Weekly)</a></li><li><a href=/2025/10/how-to-analyze-data-python-pandas-from-zero-to-insights.html class="hover:text-[#0f7ea9] transition">How to Analyze Data with Python Pandas: From Zero to Data Insights</a></li><li><a href=/2025/10/how-to-build-web-scraper-python-beautifulsoup-requests.html class="hover:text-[#0f7ea9] transition">How to Build a Web Scraper in Python with BeautifulSoup and Requests</a></li></ul></div></aside></div><section id=comments class=mt-12><script src=https://giscus.app/client.js data-repo=wikukarno/buanacoding data-repo-id=R_kgD0Oj4jAw data-category=General data-category-id=DIC_kwD0Oj4jA84Cr_fx data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></section></div></main><div class=py-6><div class="max-w-7xl mx-auto px-4"><div class="text-center mb-3"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block;min-height:90px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><div class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-white py-4 transition-colors duration-300"><div class="text-center space-x-4 text-sm font-medium"><a href=/about class="hover:text-cyan-500 dark:hover:text-cyan-400">About</a>
<span>-</span>
<a href=/contact class="hover:text-cyan-500 dark:hover:text-cyan-400">Contact</a>
<span>-</span>
<a href=/privacy-policy class="hover:text-cyan-500 dark:hover:text-cyan-400">Privacy Policy</a>
<span>-</span>
<a href=/disclaimer class="hover:text-cyan-500 dark:hover:text-cyan-400">Disclaimer</a></div></div><footer class="text-center text-sm text-gray-500 dark:text-gray-400 py-4 border-t border-gray-200 dark:border-gray-700">&copy; 2025 buanacoding.com</footer><button id=scrollToTop class="fixed bottom-6 right-6 lg:bottom-6 lg:right-6 bg-[#0f7ea9] hover:bg-cyan-600 text-white p-3 rounded-full shadow transition duration-300 z-50" aria-label="Scroll to top">
<svg fill="none" class="w-4 h-4" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/></svg></button><style>body.floating-ad-active #scrollToTop{bottom:100px!important}@media(min-width:1024px){body.floating-ad-active #scrollToTop{bottom:1.5rem!important}}</style><div id=google_translate_element style=display:none></div><script src=https://unpkg.com/feather-icons></script><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.4.6></script><script>feather.replace();const btn=document.getElementById("scrollToTop"),html=document.documentElement,toggleBtn=document.getElementById("theme-toggle"),toggleBtnMobile=document.getElementById("theme-toggle-mobile"),iconSun=document.getElementById("icon-sun"),iconMoon=document.getElementById("icon-moon"),iconSunMobile=document.getElementById("icon-sun-mobile"),iconMoonMobile=document.getElementById("icon-moon-mobile");document.getElementById("menu-toggle")?.addEventListener("click",()=>{document.getElementById("mobile-menu")?.classList.toggle("hidden")}),btn.style.display="none",window.addEventListener("scroll",()=>{window.scrollY>300?btn.style.display="flex":btn.style.display="none"}),btn.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});function updateIcons(e){iconSun.classList.toggle("hidden",!e),iconMoon.classList.toggle("hidden",e),iconSunMobile.classList.toggle("hidden",!e),iconMoonMobile.classList.toggle("hidden",e)}function setDarkMode(e){html.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light"),updateIcons(e)}const userPref=localStorage.getItem("theme"),systemPref=window.matchMedia("(prefers-color-scheme: dark)").matches,isDark=userPref==="dark"||!userPref&&systemPref;setDarkMode(isDark),toggleBtn?.addEventListener("click",()=>{const e=html.getAttribute("data-theme")==="dark";setDarkMode(!e)}),toggleBtnMobile?.addEventListener("click",()=>{const e=html.getAttribute("data-theme")==="dark";setDarkMode(!e)}),document.querySelectorAll("pre").forEach(e=>{const t=document.createElement("button");t.innerHTML=`
      <span>Copy</span>
    `,t.className=`
    copy-btn absolute top-2 right-2
    text-xs px-2 py-1 rounded flex items-center gap-1
    transition-colors duration-200
    bg-gray-200 text-gray-800 hover:bg-gray-300
    dark:bg-white/10 dark:text-white dark:hover:bg-white/20
  `.trim();const n=document.createElement("div");n.className="relative",e.parentNode.insertBefore(n,e),n.appendChild(e),n.appendChild(t),t.addEventListener("click",()=>{const n=e.innerText;navigator.clipboard.writeText(n).then(()=>{t.querySelector("span").innerText="Copied!",setTimeout(()=>{t.querySelector("span").innerText="Copy"},2e3)})})});const openBtn=document.getElementById("openSearchModal"),closeBtn=document.getElementById("closeSearchModal"),modal=document.getElementById("searchModal");openBtn.addEventListener("click",()=>{console.log("Search modal opened"),modal.classList.remove("hidden"),document.getElementById("searchBox").focus()}),closeBtn.addEventListener("click",()=>{modal.classList.add("hidden")}),document.addEventListener("keydown",e=>{e.key==="Escape"&&modal.classList.add("hidden")}),fetch("/index.json").then(e=>e.json()).then(e=>{const n=new Fuse(e,{keys:["title","content"],threshold:.3}),s=document.getElementById("searchBox"),t=document.getElementById("results");s.addEventListener("input",function(e){const o=e.target.value.trim(),s=document.getElementById("searchAdBanner");if(o.length<2){t.innerHTML="",s&&(s.classList.remove("show"),s.classList.add("hide"),setTimeout(()=>s.style.display="none",300));return}s&&(s.style.display="block",s.classList.remove("hide"),s.classList.add("show"));const i=n.search(o);if(i.length===0)t.innerHTML=`
            <li class='px-4 py-3 text-center text-gray-500 dark:text-gray-400'>
              <div class="mb-2">ðŸ“„ No results found for "${o}"</div>
              <div class="text-xs">Try different keywords or browse categories below</div>
            </li>
          `;else{let e="";i.forEach((t,n)=>{e+=`
              <li class="px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition">
                <a href="${t.item.href}" class="block font-semibold text-gray-900 dark:text-white no-underline">${t.item.title}</a>
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${t.item.content.substring(0,100)}...</p>
              </li>
            `,(n+1)%3===0&&n<i.length-1&&(e+=`
                <li class="px-4 py-2 bg-blue-50 dark:bg-gray-800 border-l-4 border-blue-400">
                  <div class="text-xs text-blue-600 dark:text-blue-400 font-medium">ðŸ“š More related articles</div>
                </li>
              `)}),t.innerHTML=e}})});const openBtnMobile=document.getElementById("openSearchModalMobile"),closeBtnMobile=document.getElementById("closeSearchModal"),modalMobile=document.getElementById("searchModal");openBtnMobile.addEventListener("click",()=>{console.log("Search modal opened (mobile)"),modalMobile.classList.remove("hidden"),document.getElementById("searchBox").focus()}),closeBtnMobile.addEventListener("click",()=>{modalMobile.classList.add("hidden")}),document.addEventListener("keydown",e=>{e.key==="Escape"&&modalMobile.classList.add("hidden")}),function(){function t(e,t){if(window.google&&window.google.translate&&window.google.translate.TranslateElement){e&&e();return}if(window.__gtReadyCallbacks=window.__gtReadyCallbacks||[],e&&window.__gtReadyCallbacks.push(e),window.__gtLoading)return;window.__gtLoading=!0,window.initGoogleTranslate=function(){try{new window.google.translate.TranslateElement({pageLanguage:"en",includedLanguages:"id",autoDisplay:!1},"google_translate_element")}catch{}(window.__gtReadyCallbacks||[]).forEach(function(e){try{e()}catch{}}),window.__gtReadyCallbacks=[]};var s,n=document.createElement("script");n.src="https://translate.google.com/translate_a/element.js?cb=initGoogleTranslate",n.defer=!0,s=!1,n.onerror=function(){s=!0,t&&t()},setTimeout(function(){(!window.google||!window.google.translate)&&(s=!0,t&&t())},4e3),document.head.appendChild(n)}function n(e,t){document.cookie=e+"="+t+"; path=/; expires="+new Date(Date.now()+365*24*3600*1e3).toUTCString()}function e(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"}function s(){if(document.getElementById("translate-fallback"))return;var e=document.createElement("div");e.id="translate-fallback",e.style.cssText="position:fixed;bottom:12px;left:50%;transform:translateX(-50%);z-index:9999;background:#111827;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 4px 16px rgba(0,0,0,0.25);display:flex;gap:10px;align-items:center;",e.innerHTML='<span style="font-size:13px">Auto-translate tidak tersedia di perangkat ini.</span><button id="btnTryId" style="background:#0ea5e9;color:#fff;border:none;padding:6px 10px;border-radius:8px;font-size:12px">Coba versi Indonesia</button><button id="btnCloseTf" style="background:transparent;color:#fff;border:1px solid #fff3;padding:6px 10px;border-radius:8px;font-size:12px">Tutup</button>',document.body.appendChild(e),document.getElementById("btnCloseTf").onclick=function(){e.remove()},document.getElementById("btnTryId").onclick=function(){var t=new URL(location.href),e=location.pathname;e.startsWith("/id/")||(t.pathname="/id"+(e.startsWith("/")?e:"/"+e)),fetch(t,{method:"HEAD"}).then(function(e){e.ok?location.href=t:location.href="/id/"}).catch(function(){location.href="/id/"})}}function o(e){t(function(){var t=document.querySelector(".goog-te-combo");t?(t.value=e,t.dispatchEvent(new Event("change"))):(n("googtrans","/en/"+e),location.reload())},s)}function i(){e("googtrans"),e("GOOGTRANS")}document.querySelectorAll(".js-lang-link").forEach(function(e){e.addEventListener("click",function(t){var n=e.getAttribute("data-lang"),s=e.getAttribute("data-has-trans")==="true";if(n==="en"){i();return}s||(t.preventDefault(),o(n))})})}()</script></body></html>