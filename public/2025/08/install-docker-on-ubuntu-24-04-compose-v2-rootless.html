<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=63300&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  
  
  
  

  
  <title>Install Docker on Ubuntu 24.04: Post-Install, Rootless, and Compose v2 | Buana Coding</title>

  
  <meta name="description" content="Step-by-step guide to install Docker Engine on Ubuntu 24.04 (Noble), set up post-install permissions, enable rootless mode, and use Docker Compose v2. Includes testing, troubleshooting, and uninstall instructions." />

  
  
    <meta name="keywords" content="ubuntu 24.04, install docker, docker compose v2, rootless docker, docker ubuntu, docker installation, noble" />
  

  
  <link rel="canonical" href="http://localhost:63300/2025/08/install-docker-on-ubuntu-24-04-compose-v2-rootless.html" />

  
  
  
  
  
    <link rel="alternate" hreflang="en" href="http://localhost:63300/2025/08/install-docker-on-ubuntu-24-04-compose-v2-rootless.html" />
  
  

  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:title" content="Install Docker on Ubuntu 24.04: Post-Install, Rootless, and Compose v2 | Buana Coding" />
  <meta property="og:description" content="Step-by-step guide to install Docker Engine on Ubuntu 24.04 (Noble), set up post-install permissions, enable rootless mode, and use Docker Compose v2. Includes testing, troubleshooting, and uninstall instructions." />
  <meta property="og:url" content="http://localhost:63300/2025/08/install-docker-on-ubuntu-24-04-compose-v2-rootless.html" />
  <meta property="og:image" content="https://www.buanacoding.com/images/og-image.jpg" />

  
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Install Docker on Ubuntu 24.04: Post-Install, Rootless, and Compose v2 | Buana Coding" />
  <meta name="twitter:description" content="Step-by-step guide to install Docker Engine on Ubuntu 24.04 (Noble), set up post-install permissions, enable rootless mode, and use Docker Compose v2. Includes testing, troubleshooting, and uninstall instructions." />
  <meta name="twitter:image" content="https://www.buanacoding.com/images/og-image.jpg" />

  
  
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Install Docker on Ubuntu 24.04: Post-Install, Rootless, and Compose v2 | Buana Coding",
    "description": "Step-by-step guide to install Docker Engine on Ubuntu 24.04 (Noble), set up post-install permissions, enable rootless mode, and use Docker Compose v2. Includes testing, troubleshooting, and uninstall instructions.",
    "inLanguage": "en",
    "datePublished": "2025-08-14T10:00:00\u002b07:00",
    "dateModified": "2025-08-14T10:00:00\u002b07:00",
    "author": {
      "@type": "Person",
      "name": "Wiku Karno"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:63300\/2025\/08\/install-docker-on-ubuntu-24-04-compose-v2-rootless.html"
    },
    "image": "https:\/\/www.buanacoding.com\/images\/og-image.jpg",
    "publisher": {
      "@type": "Organization",
      "name": "Buana Coding"
    }
  }
  </script>
  

  
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />

  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/style.css?v=1757114085" />
  <link rel="stylesheet" href="/css/overrides.css?v=1757114085" />
  <link rel="stylesheet" href="/css/syntax.css?v=1757114085" />

  
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('consent', 'default', {
      'ad_storage': 'granted',
      'ad_user_data': 'granted',
      'ad_personalization': 'granted',
      'analytics_storage': 'granted'
    });
  </script>

  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0EN9J73FXF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0EN9J73FXF');
</script>




</head>

  <body
    class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen flex flex-col"
  >
    
    <header class="bg-[#0f7ea9] dark:bg-[#094d66] text-white shadow">
  <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
    <h1 class="text-2xl font-extrabold tracking-wide">
      <a href="/" class="hover:opacity-90">BUANACODING</a>
    </h1>

    
    <nav
      class="hidden md:flex items-center space-x-6 font-semibold uppercase tracking-wide"
    >
      
      
      
        
          
          <a
            href="/tags/general"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            General
          </a>
        
          
          <a
            href="/tags/go"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            Go
          </a>
        
          
          <a
            href="/tags/laravel"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            Laravel
          </a>
        
          
          <a
            href="/tags/linux"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            Linux
          </a>
        
          
          <a
            href="/tags/python"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            Python
          </a>
        
          
          <a
            href="/tags/security"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            Security
          </a>
        
      

      
      <div class="hidden md:flex items-center">
        
        
        <div class="flex border border-white/30 rounded overflow-hidden text-xs font-medium">
          
            
            
            
            
              
              
            
            
            <a href="/2025/08/install-docker-on-ubuntu-24-04-compose-v2-rootless.html"
               data-lang="en" data-has-trans="true"
               class="js-lang-link px-2 py-1 bg-white/20 text-white">
              EN
            </a>
          
            
            
            
            
            
              
              
                
              
            
            <a href="/id/"
               data-lang="id" data-has-trans="false"
               class="js-lang-link px-2 py-1 bg-transparent hover:bg-white/10 text-white/80">
              ID
            </a>
          
        </div>
      </div>

      
      <button
        id="openSearchModal"
        class="text-white transition duration-300 cursor-pointer focus:outline-none dark:hover:text-[#0f7ea9] hover:text-cyan-300"
        aria-label="Search"
      >
        <i data-feather="search" class="w-5 h-5"></i>
      </button>

      
      <button
        id="theme-toggle"
        class="ml-2 text-white hover:text-yellow-300 transition duration-300 focus:outline-none cursor-pointer"
        aria-label="Toggle Dark Mode"
      >
        
        <i id="icon-sun" data-feather="sun" class="w-5 h-5 hidden"></i>
        <i id="icon-moon" data-feather="moon" class="w-5 h-5"></i>
      </button>
    </nav>

    
    <button id="menu-toggle" class="md:hidden text-2xl focus:outline-none">
      ☰
    </button>
  </div>

  
  <div id="mobile-menu" class="hidden md:hidden px-4 pb-4 space-y-2">
    
    
      
        
        <a
          href="/tags/general"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          General
        </a>
      
        
        <a
          href="/tags/go"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          Go
        </a>
      
        
        <a
          href="/tags/laravel"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          Laravel
        </a>
      
        
        <a
          href="/tags/linux"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          Linux
        </a>
      
        
        <a
          href="/tags/python"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          Python
        </a>
      
        
        <a
          href="/tags/security"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          Security
        </a>
      
    

    
    <div class="mt-8 space-y-6">
      
      
      <button
        id="openSearchModalMobile"
        class="w-full text-left text-white hover:text-cyan-300 transition duration-300 flex items-center gap-4 py-2"
        aria-label="Search"
      >
        <i data-feather="search" class="w-5 h-5"></i>
        <span class="text-sm font-medium">Search</span>
      </button>

      
      <div class="flex items-center justify-between py-2">
        <div class="flex items-center gap-4">
          <i data-feather="globe" class="w-5 h-5 text-white/80"></i>
          <span class="text-sm font-medium text-white">Language</span>
        </div>
        <div class="flex text-xs">
          
          
          
            
            
            
            
              
              
            
            
            <a href="/2025/08/install-docker-on-ubuntu-24-04-compose-v2-rootless.html"
               data-lang="en" data-has-trans="true"
               class="js-lang-link px-3 py-1.5 text-white font-medium">
              EN
            </a>
          
            
            
            
            
            
              
              
                
              
            
            <a href="/id/"
               data-lang="id" data-has-trans="false"
               class="js-lang-link px-3 py-1.5 text-white/60 hover:text-white">
              ID
            </a>
          
        </div>
      </div>

      
      <button
        id="theme-toggle-mobile"
        class="w-full text-left text-white hover:text-cyan-300 transition duration-300 flex items-center gap-4 py-2"
        aria-label="Toggle Dark Mode"
      >
        <i id="icon-sun-mobile" data-feather="sun" class="w-5 h-5 hidden"></i>
        <i id="icon-moon-mobile" data-feather="moon" class="w-5 h-5"></i>
        <span class="text-sm font-medium">Theme</span>
      </button>
      
    </div>
  </div>
</header>



<div class="bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 py-2">
  <div class="max-w-7xl mx-auto px-4">
    
    
    <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-6 px-4 rounded text-gray-500 dark:text-gray-400">
      📢 Ad placeholder: Header Leaderboard (728×90 desktop, 320×50 mobile)
    </div>
    
  </div>
</div>


<div
  id="searchModal"
  class="fixed inset-0 z-50 hidden flex justify-center items-center bg-black/30 dark:bg-black/60 backdrop-blur-md p-4"
>
  <div
    class="bg-white dark:bg-[#1f2937] rounded-xl shadow-2xl w-full max-w-xl p-6 relative"
  >
    
    <button
      id="closeSearchModal"
      class="absolute -top-4 -right-4 bg-white dark:bg-[#374151] rounded-full p-1 shadow hover:bg-gray-100 dark:hover:bg-gray-600 transition duration-200 ease-in-out transform hover:scale-110"
    >
      <i
        data-feather="x"
        class="w-5 h-5 text-gray-600 dark:text-white hover:text-red-500"
      ></i>
    </button>

    
    <input
      type="text"
      id="searchBox"
      placeholder="Search articles..."
      class="w-full px-4 py-3 mb-4 border border-cyan-400 text-gray-800 dark:text-white dark:bg-[#374151] placeholder-gray-400 dark:placeholder-gray-400 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500"
    />

    
    
<div id="searchAdBanner" class="mt-4 mb-8 hidden">
  
  
  <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-4 px-4 rounded text-gray-500 dark:text-gray-400">
    🔍 Ad placeholder: Search Results Banner (320×100)
  </div>
  
</div>

<style>
#searchAdBanner {
   
  transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
}

#searchAdBanner.show {
  display: block !important;
  opacity: 1;
  transform: translateY(0);
}

#searchAdBanner.hide {
  opacity: 0;
  transform: translateY(-10px);
}

.search-results-ad {
  max-height: 100px;
  overflow: hidden;
}
</style>

    
    <ul
      id="results"
      class="bg-white dark:bg-[#1f2937] rounded-lg shadow max-h-60 overflow-y-auto divide-y divide-gray-200 dark:divide-gray-600"
    ></ul>
  </div>
</div>


    
    <main class="flex-1 w-full">
      <div class="max-w-7xl mx-auto py-8 px-4">
        
<div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-8 py-8">
  
  <article class="prose prose-blue dark:prose-invert lg:col-span-2">
    <nav class="text-sm text-gray-600 dark:text-gray-300 mb-4">
      <a href="/" class="text-gray-600 dark:text-gray-300 hover:text-[#0f7ea9] no-underline">Home</a>
      <span class="mx-2 text-gray-400 dark:text-gray-500">/</span>
      
        
        
          <a href="/tags/linux" class="text-gray-600 dark:text-gray-300 hover:text-[#0f7ea9] no-underline">#Linux</a>
        
      
    </nav>


    <h1>Install Docker on Ubuntu 24.04: Post-Install, Rootless, and Compose v2</h1>

    
    

    
    



<div class="flex items-center gap-4 my-4 py-3 border-b border-gray-200 dark:border-gray-700">
  <span class="text-sm text-gray-500 dark:text-gray-400 font-medium mr-2">Share:</span>
  
  
  <a href="https://twitter.com/intent/tweet?text=Install&#43;Docker&#43;on&#43;Ubuntu&#43;24.04%3A&#43;Post-Install%2C&#43;Rootless%2C&#43;and&#43;Compose&#43;v2&url=http%3A%2F%2Flocalhost%3A63300%2F2025%2F08%2Finstall-docker-on-ubuntu-24-04-compose-v2-rootless.html&via=buanacoding" 
     target="_blank" rel="noopener"
     class="p-2 text-gray-500 dark:text-gray-400 hover:text-black hover:bg-gray-100 dark:hover:text-white dark:hover:bg-gray-700 rounded-full transition-all duration-200"
     title="Share on Twitter">
    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
      <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
    </svg>
  </a>

  
  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A63300%2F2025%2F08%2Finstall-docker-on-ubuntu-24-04-compose-v2-rootless.html" 
     target="_blank" rel="noopener"
     class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all duration-200"
     title="Share on Facebook">
    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
      <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
    </svg>
  </a>

  
  <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Flocalhost%3A63300%2F2025%2F08%2Finstall-docker-on-ubuntu-24-04-compose-v2-rootless.html" 
     target="_blank" rel="noopener"
     class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-700 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all duration-200"
     title="Share on LinkedIn">
    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
      <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
    </svg>
  </a>

  
  <a href="https://wa.me/?text=Install&#43;Docker&#43;on&#43;Ubuntu&#43;24.04%3A&#43;Post-Install%2C&#43;Rootless%2C&#43;and&#43;Compose&#43;v2%20http%3A%2F%2Flocalhost%3A63300%2F2025%2F08%2Finstall-docker-on-ubuntu-24-04-compose-v2-rootless.html" 
     target="_blank" rel="noopener"
     class="p-2 text-gray-500 dark:text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:text-green-400 dark:hover:bg-green-900/20 rounded-full transition-all duration-200"
     title="Share on WhatsApp">
    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
      <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.484 3.488"/>
    </svg>
  </a>

  
  <button onclick="copyLinkHeader('http:\/\/localhost:63300\/2025\/08\/install-docker-on-ubuntu-24-04-compose-v2-rootless.html')" 
          class="p-2 text-gray-500 dark:text-gray-400 hover:text-gray-800 hover:bg-gray-100 dark:hover:text-gray-200 dark:hover:bg-gray-700 rounded-full transition-all duration-200"
          title="Copy Link">
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
    </svg>
  </button>

  
  <span id="copy-header-success" class="hidden text-xs text-green-600 dark:text-green-400 font-medium">
    Copied!
  </span>
</div>

<script>
function copyLinkHeader(url) {
  navigator.clipboard.writeText(url).then(function() {
    showHeaderSuccess();
  }).catch(function(err) {
    
    const textArea = document.createElement('textarea');
    textArea.value = url;
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
    showHeaderSuccess();
  });
}

function showHeaderSuccess() {
  const successMsg = document.getElementById('copy-header-success');
  successMsg.classList.remove('hidden');
  
  
  setTimeout(function() {
    successMsg.classList.add('hidden');
  }, 2000);
}
</script>

    
    
    
    
    
    
    

    
    
      <p>This guide shows how to install Docker Engine on Ubuntu 24.04 LTS (Noble Numbat), configure it for non-root use, enable optional rootless mode, and use Docker Compose v2. It also includes test commands, common troubleshooting tips, and how to uninstall cleanly. For securing your site with HTTPS, see: <a href="/2025/08/nginx-certbot-ubuntu-24-04-free-https.html">
  Nginx + Certbot on Ubuntu 24.04
</a>
</p>
    
      
<p>What you’ll do</p>
    
      
<ul>
<li>Add the official Docker repository for Ubuntu 24.04 (Noble)</li>
<li>Install Docker Engine, Buildx, and Compose v2 plugins</li>
<li>Run Docker as your regular user (without sudo)</li>
<li>Optionally enable rootless Docker</li>
<li>Verify with test containers and fix common errors</li>
</ul>
<p>Prerequisites</p>
    
    
    
    
      
<div class="my-8 flex justify-center">
  <div class="w-full max-w-2xl">
    
    
    <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-4 px-6 rounded-lg text-gray-500 dark:text-gray-400">
      📢 Ad placeholder: In‑Article (native style)
    </div>
    
  </div>
</div>

    
    
    
    
      
        
<ul>
<li>Fresh or updated Ubuntu 24.04 LTS (Noble)</li>
<li>A user with sudo privileges</li>
</ul>
<ol>
<li>Remove old Docker packages (if any)</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt remove -y docker docker-engine docker.io containerd runc <span class="o">||</span> <span class="nb">true</span>
</span></span></code></pre></div><ol start="2">
<li>Set up the Docker repository</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt update
</span></span><span class="line"><span class="cl">sudo apt install -y ca-certificates curl gnupg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo install -m <span class="m">0755</span> -d /etc/apt/keyrings
</span></span><span class="line"><span class="cl">curl -fsSL https://download.docker.com/linux/ubuntu/gpg <span class="p">|</span> sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
</span></span><span class="line"><span class="cl">sudo chmod a+r /etc/apt/keyrings/docker.gpg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;deb [arch=</span><span class="k">$(</span>dpkg --print-architecture<span class="k">)</span><span class="s2"> signed-by=/etc/apt/keyrings/docker.gpg] \
</span></span></span><span class="line"><span class="cl"><span class="s2">https://download.docker.com/linux/ubuntu </span><span class="k">$(</span>. /etc/os-release<span class="p">;</span> <span class="nb">echo</span> <span class="nv">$VERSION_CODENAME</span><span class="k">)</span><span class="s2"> stable&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo apt update
</span></span></code></pre></div><ol start="3">
<li>Install Docker Engine, Buildx, and Compose v2</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
</span></span><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> --now docker
</span></span></code></pre></div><ol start="4">
<li>Test Docker (root)</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo docker run --rm hello-world
</span></span></code></pre></div><p>You should see a confirmation message.</p>
      
        
<ol start="5">
<li>Post-install: run Docker without sudo</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo usermod -aG docker <span class="nv">$USER</span>
</span></span><span class="line"><span class="cl">newgrp docker  <span class="c1"># reload group membership for current shell</span>
</span></span><span class="line"><span class="cl">docker run --rm hello-world
</span></span></code></pre></div><p>If the second command works without sudo, your user is set up correctly.</p>
      
        
<ol start="6">
<li>Docker Compose v2
<code>docker compose</code> is included as a plugin. Check the version:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker compose version
</span></span></code></pre></div><p>Example usage:</p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt; compose.yaml <span class="s">&lt;&lt;&#39;YAML&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">services:
</span></span></span><span class="line"><span class="cl"><span class="s">  web:
</span></span></span><span class="line"><span class="cl"><span class="s">    image: nginx:alpine
</span></span></span><span class="line"><span class="cl"><span class="s">    ports:
</span></span></span><span class="line"><span class="cl"><span class="s">      - &#34;8080:80&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">YAML</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker compose up -d
</span></span><span class="line"><span class="cl">docker compose ps
</span></span><span class="line"><span class="cl">docker compose down
</span></span></code></pre></div><p>6a) Verify Buildx
<code>docker buildx</code> is the modern builder with multi-platform support and advanced caching.</p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker buildx version
</span></span></code></pre></div><p>You should see a version string. Optionally, try a quick build to confirm the builder is healthy:</p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker buildx bake --print 2&gt;/dev/null <span class="o">||</span> <span class="nb">echo</span> <span class="s2">&#34;Buildx is installed and ready.&#34;</span>
</span></span></code></pre></div><ol start="7">
<li>Optional: Rootless Docker
Rootless mode runs the Docker daemon and containers without root privileges. Good for tighter isolation (with some feature limitations).</li>
</ol>
<p>Install requirements and set up:</p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install -y uidmap dbus-user-session
</span></span><span class="line"><span class="cl">dockerd-rootless-setuptool.sh install
</span></span></code></pre></div><p>Start and enable the user service:</p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl --user start docker
</span></span><span class="line"><span class="cl">systemctl --user <span class="nb">enable</span> docker
</span></span><span class="line"><span class="cl"><span class="c1"># Keep user services running after logout</span>
</span></span><span class="line"><span class="cl">sudo loginctl enable-linger <span class="nv">$USER</span>
</span></span></code></pre></div><p>Use the rootless daemon by pointing the client to your user socket (usually done automatically by the setup tool):</p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">DOCKER_HOST</span><span class="o">=</span>unix:///run/user/<span class="k">$(</span>id -u<span class="k">)</span>/docker.sock
</span></span><span class="line"><span class="cl">docker info <span class="p">|</span> grep -i rootless
</span></span></code></pre></div><p>Notes on rootless mode</p>
      
        
<ul>
<li>Some features (e.g., privileged containers, low ports &lt;1024) are restricted.</li>
<li>For Kubernetes-in-Docker or system-wide networking, classic (rootful) Docker is recommended.</li>
</ul>
<ol start="8">
<li>Troubleshooting</li>
</ol>
<ul>
<li>Permission denied on /var/run/docker.sock
<ul>
<li>Run: <code>groups</code> and ensure <code>docker</code> is listed. If not, run <code>sudo usermod -aG docker $USER</code> then re-login or <code>newgrp docker</code>.</li>
</ul>
</li>
<li>Network issues pulling images
<ul>
<li>Check DNS and proxy settings. Try <code>docker pull alpine</code> and <code>ping registry-1.docker.io</code> (may be blocked by firewall).</li>
</ul>
</li>
<li>Cannot connect to the Docker daemon
<ul>
<li>Check service: <code>systemctl status docker</code> (rootful) or <code>systemctl --user status docker</code> (rootless).</li>
</ul>
</li>
<li>Compose command not found
<ul>
<li>Ensure you installed <code>docker-compose-plugin</code> and run <code>docker compose</code> (space), not <code>docker-compose</code>.</li>
</ul>
</li>
<li>Apt update/upgrade errors during install
<ul>
<li>Lihat: How to fix broken update error in Linux (Terminal) → /2023/11/how-to-fix-broken-update-error-in-linux.html</li>
</ul>
</li>
</ul>
<p>8a) Maintenance &amp; Cleanup (disk usage)
Over time, images/layers can consume disk space. Inspect usage and prune carefully:</p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker system df
</span></span><span class="line"><span class="cl">docker image prune -f                <span class="c1"># remove unused images (dangling)</span>
</span></span><span class="line"><span class="cl">docker container prune -f            <span class="c1"># remove stopped containers</span>
</span></span><span class="line"><span class="cl">docker volume prune -f               <span class="c1"># remove unused volumes</span>
</span></span><span class="line"><span class="cl">docker builder prune -f              <span class="c1"># remove unused build cache</span>
</span></span></code></pre></div><p>Tip: omit <code>-f</code> to get a prompt before deleting. Review before pruning on production hosts.</p>
      
        
<ol start="9">
<li>Uninstall Docker completely</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt purge -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin docker-ce-rootless-extras
</span></span><span class="line"><span class="cl">sudo rm -rf /var/lib/docker /var/lib/containerd
</span></span><span class="line"><span class="cl">sudo rm -f /etc/apt/sources.list.d/docker.list /etc/apt/keyrings/docker.gpg
</span></span><span class="line"><span class="cl">sudo apt autoremove -y
</span></span></code></pre></div><p>Security note</p>
      
        
<ul>
<li>Members of the <code>docker</code> group can effectively escalate privileges on the host (they can start containers with access to the filesystem). Only add trusted users to the <code>docker</code> group.</li>
</ul>
<p>That’s it! You now have Docker Engine, Compose v2, and (optionally) rootless mode on Ubuntu 24.04.</p>
      
        
</p>
      
    

    
    <div class="bg-gray-100 dark:bg-gray-800 p-4 my-8 rounded">
      <h2 class="text-lg font-semibold mb-2">📌 Read Also</h2>
      
      
      
      
        
      
      
      <ul class="list-disc list-outside ml-5">
        
        <li>
          <a href="/2025/08/essential-linux-commands-every-developer-must-know-2025.html" class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">Essential Linux Commands Every Developer Must Know in 2025</a>
        </li>
        
        <li>
          <a href="/2025/08/uninstall-docker-ubuntu-24-04-clean-removal.html" class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">Uninstall Docker on Ubuntu 24.04: Complete Clean Removal</a>
        </li>
        
        <li>
          <a href="/2025/08/install-ollama-openwebui-ubuntu-24-04.html" class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">Install Ollama and Open WebUI on Ubuntu 24.04: Local AI (CPU/GPU)</a>
        </li>
        
      </ul>
    </div>

    
    <div class="hidden lg:block">
      
<div class="my-8 py-6 border-t border-b border-gray-200 dark:border-gray-700">
  <div class="max-w-4xl mx-auto">
    
    
    <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-8 px-6 rounded-lg text-gray-500 dark:text-gray-400">
      📱 Ad placeholder: Responsive Banner (adapts to screen size)
    </div>
    
  </div>
</div>

    </div>

    
    
<div class="block lg:hidden my-8 px-2 mb-10">
  
  
  <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-4 px-6 rounded-lg text-gray-500 dark:text-gray-400">
    📱 Ad placeholder: Mobile Banner (320×100)
  </div>
  
</div>

    
    
    <div class="lg:hidden mt-8 pt-8 border-t border-gray-200 dark:border-gray-700">
      <h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Popular Posts</h3>
      <div class="grid gap-3">
        
        <a href="/2025/09/advanced-go-modules-private-repos-semantic-import-v2-go-work.html" class="block py-2 hover:text-[#0f7ea9] transition no-underline">
          <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">Advanced Go Modules: Private Repos, Semantic Import v2&#43;, and go.work</h4>
          <p class="text-xs text-gray-500 dark:text-gray-400">02 Sep 2025</p>
        </a>
        
        <a href="/2025/09/computer-vision-opencv-object-detection-face-recognition-tutorial.html" class="block py-2 hover:text-[#0f7ea9] transition no-underline">
          <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">Computer Vision with OpenCV: Complete Guide to Object Detection and Face Recognition in Python</h4>
          <p class="text-xs text-gray-500 dark:text-gray-400">02 Sep 2025</p>
        </a>
        
        <a href="/2025/09/complete-guide-slog-go-structured-logging-2025.html" class="block py-2 hover:text-[#0f7ea9] transition no-underline">
          <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">The Complete Guide to slog (Go 1.21&#43;): Modern Structured Logging in Go (2025)</h4>
          <p class="text-xs text-gray-500 dark:text-gray-400">01 Sep 2025</p>
        </a>
        
        <a href="/2025/08/10-best-ai-coding-assistants-every-developer-should-try-2025.html" class="block py-2 hover:text-[#0f7ea9] transition no-underline">
          <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">10 Best AI Coding Assistants Every Developer Should Try in 2025</h4>
          <p class="text-xs text-gray-500 dark:text-gray-400">31 Aug 2025</p>
        </a>
        
        <a href="/2025/08/essential-linux-commands-every-developer-must-know-2025.html" class="block py-2 hover:text-[#0f7ea9] transition no-underline">
          <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">Essential Linux Commands Every Developer Must Know in 2025</h4>
          <p class="text-xs text-gray-500 dark:text-gray-400">31 Aug 2025</p>
        </a>
        
      </div>
    </div>
  </article>

  
  <aside class="space-y-10 hidden lg:block">
    
    <div>
      <h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Popular Posts</h3>
      <ul
        class="space-y-3 list-disc list-outside pl-5 text-sm text-gray-800 dark:text-gray-200"
      >
        
        <li>
          <a href="/2025/09/advanced-go-modules-private-repos-semantic-import-v2-go-work.html" class="hover:text-[#0f7ea9] transition">Advanced Go Modules: Private Repos, Semantic Import v2&#43;, and go.work</a>
        </li>
        
        <li>
          <a href="/2025/09/computer-vision-opencv-object-detection-face-recognition-tutorial.html" class="hover:text-[#0f7ea9] transition">Computer Vision with OpenCV: Complete Guide to Object Detection and Face Recognition in Python</a>
        </li>
        
        <li>
          <a href="/2025/09/complete-guide-slog-go-structured-logging-2025.html" class="hover:text-[#0f7ea9] transition">The Complete Guide to slog (Go 1.21&#43;): Modern Structured Logging in Go (2025)</a>
        </li>
        
        <li>
          <a href="/2025/08/10-best-ai-coding-assistants-every-developer-should-try-2025.html" class="hover:text-[#0f7ea9] transition">10 Best AI Coding Assistants Every Developer Should Try in 2025</a>
        </li>
        
        <li>
          <a href="/2025/08/essential-linux-commands-every-developer-must-know-2025.html" class="hover:text-[#0f7ea9] transition">Essential Linux Commands Every Developer Must Know in 2025</a>
        </li>
        
      </ul>
    </div>

    
    <div class="mt-8">
      
<div class="hidden lg:block">
  <div id="stickySidebarAd" class="sticky top-8 transition-all duration-300">
    
    
    <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs w-[300px] h-[250px] flex flex-col items-center justify-center rounded-lg mx-auto text-gray-500 dark:text-gray-400">
      <div class="text-lg mb-2">📌</div>
      <div>Sticky Sidebar Ad</div>
      <div class="text-xs opacity-70">300×250 (always visible)</div>
    </div>
    
  </div>
</div>

<style>
.sticky-ad-container {
  position: relative;
}

.sticky-ad-container:hover #closeStickyAd {
  display: block;
}

 
#stickySidebarAd {
  will-change: transform;
}

 
@media (min-width: 1024px) {
  #stickySidebarAd {
    max-height: calc(100vh - 120px);
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const stickyAd = document.getElementById('stickySidebarAd');
  const closeButton = document.getElementById('closeStickyAd');
  
  if (closeButton) {
    closeButton.addEventListener('click', function() {
      if (stickyAd) {
        stickyAd.style.display = 'none';
        
        localStorage.setItem('stickySidebarHidden', 'true');
      }
    });
  }
  
  
  if (localStorage.getItem('stickySidebarHidden') === 'true') {
    if (stickyAd) stickyAd.style.display = 'none';
  }
  
  
  if (stickyAd && window.IntersectionObserver) {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, {
      threshold: 0.1
    });
    
    observer.observe(stickyAd);
  }
});
</script>
    </div>
  </aside>
</div>


<section id="comments" class="mt-12">
  <script
    src="https://giscus.app/client.js"
    data-repo="wikukarno/buanacoding"
    data-repo-id="R_kgD0Oj4jAw"
    data-category="General"
    data-category-id="DIC_kwD0Oj4jA84Cr_fx"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async
  ></script>
</section>





      </div>
    </main>

    

<div class="py-6">
  <div class="max-w-7xl mx-auto px-4">
    
    
    <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-8 px-4 rounded text-gray-500 dark:text-gray-400">
      <div class="text-lg mb-2">📱</div>
      <div>Ad placeholder: Footer Banner</div>
      <div class="text-xs opacity-70 mt-1">Responsive (300×250 desktop, 320×50 mobile)</div>
    </div>
    
  </div>
</div>


<div class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-white py-4 transition-colors duration-300">
  <div class="text-center space-x-4 text-sm font-medium">
    <a href="/about" class="hover:text-cyan-500 dark:hover:text-cyan-400">About</a>
    <span>-</span>
    <a href="/contact" class="hover:text-cyan-500 dark:hover:text-cyan-400">Contact</a>
    <span>-</span>
    <a href="/privacy-policy" class="hover:text-cyan-500 dark:hover:text-cyan-400">Privacy Policy</a>
    <span>-</span>
    <a href="/disclaimer" class="hover:text-cyan-500 dark:hover:text-cyan-400">Disclaimer</a>
  </div>
</div>


<footer class="text-center text-sm text-gray-500 dark:text-gray-400 py-4 border-t border-gray-200 dark:border-gray-700">
  &copy; 2025 buanacoding.com
</footer>



    
<button
  id="scrollToTop"
  class="fixed bottom-6 right-6 lg:bottom-6 lg:right-6 bg-[#0f7ea9] hover:bg-cyan-600 text-white p-3 rounded-full shadow transition duration-300 z-50"
  aria-label="Scroll to top"
>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    fill="none"
    class="w-4 h-4"
    viewBox="0 0 24 24"
    stroke="currentColor"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M5 15l7-7 7 7"
    />
  </svg>
</button>

<style>
 
body.floating-ad-active #scrollToTop {
  bottom: 100px !important;  
}

@media (min-width: 1024px) {
  body.floating-ad-active #scrollToTop {
    bottom: 1.5rem !important;  
  }
}
</style>


    
    
<div id="floatingMobileAd" class="lg:hidden fixed bottom-0 left-0 right-0 z-40 transform transition-transform duration-300 translate-y-0">
  
  
  <div class="bg-gray-50 dark:bg-gray-800 border-t border-gray-300 dark:border-gray-600 p-2">
    <div class="flex items-center justify-between max-w-sm mx-auto">
      <div class="text-center flex-1">
        <div class="text-xs text-gray-500 dark:text-gray-400">📱 Floating Mobile Ad (320×50)</div>
      </div>
      <button id="closeFloatingMobile" class="ml-2 p-1 text-gray-400 hover:text-gray-600">×</button>
    </div>
  </div>
  
</div>

<style>
#floatingMobileAd {
   
  z-index: 40;
   
  transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
}

#floatingMobileAd.hidden-mobile-ad {
  transform: translateY(100%);
  opacity: 0;
}

 
body.floating-ad-active {
  padding-bottom: 70px;
}

 
.floating-mobile-ad {
  pointer-events: auto;
}

@media (min-width: 1024px) {
  #floatingMobileAd {
    display: none !important;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const floatingAd = document.getElementById('floatingMobileAd');
  const closeButton = document.getElementById('closeFloatingMobile');
  const body = document.body;
  
  
  if (floatingAd && window.innerWidth < 1024) {
    body.classList.add('floating-ad-active');
  }
  
  
  if (closeButton) {
    closeButton.addEventListener('click', function() {
      if (floatingAd) {
        floatingAd.classList.add('hidden-mobile-ad');
        body.classList.remove('floating-ad-active');
        
        localStorage.setItem('floatingMobileHidden', 'true');
        
        
        setTimeout(() => {
          floatingAd.style.display = 'none';
        }, 300);
      }
    });
  }
  
  
  if (localStorage.getItem('floatingMobileHidden') === 'true') {
    if (floatingAd) {
      floatingAd.style.display = 'none';
      body.classList.remove('floating-ad-active');
    }
  }
  
  
  let lastScrollTop = 0;
  let scrollTimeout;
  
  if (floatingAd && localStorage.getItem('floatingMobileHidden') !== 'true') {
    window.addEventListener('scroll', function() {
      clearTimeout(scrollTimeout);
      
      scrollTimeout = setTimeout(() => {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        
        if (scrollTop > lastScrollTop && scrollTop > 100) {
          
          floatingAd.style.transform = 'translateY(100%)';
        } else if (scrollTop < lastScrollTop) {
          
          floatingAd.style.transform = 'translateY(0)';
        }
        
        lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
      }, 50);
    });
  }
  
  
  window.addEventListener('resize', function() {
    if (window.innerWidth >= 1024) {
      body.classList.remove('floating-ad-active');
    } else if (floatingAd && localStorage.getItem('floatingMobileHidden') !== 'true') {
      body.classList.add('floating-ad-active');
    }
  });
});
</script>

    <div id="google_translate_element" style="display:none"></div>
<script src="https://unpkg.com/feather-icons"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6"></script>

<script>
  feather.replace();
  const btn = document.getElementById("scrollToTop");
  const html = document.documentElement;
  const toggleBtn = document.getElementById("theme-toggle");
  const toggleBtnMobile = document.getElementById("theme-toggle-mobile");
  const iconSun = document.getElementById("icon-sun");
  const iconMoon = document.getElementById("icon-moon");
  const iconSunMobile = document.getElementById("icon-sun-mobile");
  const iconMoonMobile = document.getElementById("icon-moon-mobile");

  document.getElementById("menu-toggle")?.addEventListener("click", () => {
    document.getElementById("mobile-menu")?.classList.toggle("hidden");
  });

  btn.style.display = "none";

  window.addEventListener("scroll", () => {
    if (window.scrollY > 300) {
      btn.style.display = "flex";
    } else {
      btn.style.display = "none";
    }
  });

  btn.addEventListener("click", () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  function updateIcons(isDark) {
    iconSun.classList.toggle("hidden", !isDark);
    iconMoon.classList.toggle("hidden", isDark);
    iconSunMobile.classList.toggle("hidden", !isDark);
    iconMoonMobile.classList.toggle("hidden", isDark);
  }

  function setDarkMode(isDark) {
    html.setAttribute("data-theme", isDark ? "dark" : "light");
    localStorage.setItem("theme", isDark ? "dark" : "light");
    updateIcons(isDark);
  }

  const userPref = localStorage.getItem("theme");
  const systemPref = window.matchMedia("(prefers-color-scheme: dark)").matches;
  const isDark = userPref === "dark" || (!userPref && systemPref);
  setDarkMode(isDark);

  toggleBtn?.addEventListener("click", () => {
    const currentlyDark = html.getAttribute("data-theme") === "dark";
    setDarkMode(!currentlyDark);
  });
  toggleBtnMobile?.addEventListener("click", () => {
    const currentlyDark = html.getAttribute("data-theme") === "dark";
    setDarkMode(!currentlyDark);
  });

  document.querySelectorAll("pre").forEach((pre) => {
    const button = document.createElement("button");
    button.innerHTML = `
      <span>Copy</span>
    `;
    button.className = `
    copy-btn absolute top-2 right-2
    text-xs px-2 py-1 rounded flex items-center gap-1
    transition-colors duration-200
    bg-gray-200 text-gray-800 hover:bg-gray-300
    dark:bg-white/10 dark:text-white dark:hover:bg-white/20
  `.trim();

    const wrapper = document.createElement("div");
    wrapper.className = "relative";
    pre.parentNode.insertBefore(wrapper, pre);
    wrapper.appendChild(pre);
    wrapper.appendChild(button);

    button.addEventListener("click", () => {
      const code = pre.innerText;
      navigator.clipboard.writeText(code).then(() => {
        button.querySelector("span").innerText = "Copied!";
        setTimeout(() => {
          button.querySelector("span").innerText = "Copy";
        }, 2000);
      });
    });
  });

  const openBtn = document.getElementById("openSearchModal");
  const closeBtn = document.getElementById("closeSearchModal");
  const modal = document.getElementById("searchModal");

  openBtn.addEventListener("click", () => {
    console.log("Search modal opened");
    modal.classList.remove("hidden");
    document.getElementById("searchBox").focus();
  });

  closeBtn.addEventListener("click", () => {
    modal.classList.add("hidden");
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") modal.classList.add("hidden");
  });

  fetch("/index.json")
    .then((res) => res.json())
    .then((data) => {
      const fuse = new Fuse(data, {
        keys: ["title", "content"],
        threshold: 0.3,
      });

      const searchBox = document.getElementById("searchBox");
      const resultBox = document.getElementById("results");

      searchBox.addEventListener("input", function (e) {
        const query = e.target.value.trim();
        const searchAdBanner = document.getElementById("searchAdBanner");
        
        if (query.length < 2) {
          resultBox.innerHTML = "";
          
          if (searchAdBanner) {
            searchAdBanner.classList.remove("show");
            searchAdBanner.classList.add("hide");
            setTimeout(() => searchAdBanner.style.display = "none", 300);
          }
          return;
        }

        
        if (searchAdBanner) {
          searchAdBanner.style.display = "block";
          searchAdBanner.classList.remove("hide");
          searchAdBanner.classList.add("show");
        }

        const results = fuse.search(query);
        if (results.length === 0) {
          resultBox.innerHTML = `
            <li class='px-4 py-3 text-center text-gray-500 dark:text-gray-400'>
              <div class="mb-2">📄 No results found for "${query}"</div>
              <div class="text-xs">Try different keywords or browse categories below</div>
            </li>
          `;
        } else {
          
          let resultHTML = "";
          results.forEach((r, index) => {
            resultHTML += `
              <li class="px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition">
                <a href="${r.item.href}" class="block font-semibold text-gray-900 dark:text-white no-underline">${r.item.title}</a>
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${r.item.content.substring(0, 100)}...</p>
              </li>
            `;
            
            
            if ((index + 1) % 3 === 0 && index < results.length - 1) {
              resultHTML += `
                <li class="px-4 py-2 bg-blue-50 dark:bg-gray-800 border-l-4 border-blue-400">
                  <div class="text-xs text-blue-600 dark:text-blue-400 font-medium">📚 More related articles</div>
                </li>
              `;
            }
          });
          
          resultBox.innerHTML = resultHTML;
        }
      });
    });

    const openBtnMobile = document.getElementById("openSearchModalMobile");
    const closeBtnMobile = document.getElementById("closeSearchModal");
    const modalMobile = document.getElementById("searchModal");

    openBtnMobile.addEventListener("click", () => {
      console.log("Search modal opened (mobile)");
      modalMobile.classList.remove("hidden");
      document.getElementById("searchBox").focus();
    });
    closeBtnMobile.addEventListener("click", () => {
      modalMobile.classList.add("hidden");
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") modalMobile.classList.add("hidden");
    });

  
  (function () {
    function loadGoogleTranslate(cb, onfail) {
      if (window.google && window.google.translate && window.google.translate.TranslateElement) {
        cb && cb();
        return;
      }
      window.__gtReadyCallbacks = window.__gtReadyCallbacks || [];
      if (cb) window.__gtReadyCallbacks.push(cb);
      if (window.__gtLoading) return;
      window.__gtLoading = true;
      window.initGoogleTranslate = function () {
        try {
          new window.google.translate.TranslateElement({
            pageLanguage: 'en',
            includedLanguages: 'id',
            autoDisplay: false,
          }, 'google_translate_element');
        } catch (e) {}
        (window.__gtReadyCallbacks || []).forEach(function (fn) { try { fn(); } catch (e) {} });
        window.__gtReadyCallbacks = [];
      };
      var s = document.createElement('script');
      s.src = 'https://translate.google.com/translate_a/element.js?cb=initGoogleTranslate';
      s.defer = true;
      var failed = false;
      s.onerror = function(){ failed = true; onfail && onfail(); };
      setTimeout(function(){ if(!window.google || !window.google.translate){ failed = true; onfail && onfail(); } }, 4000);
      document.head.appendChild(s);
    }

    function setCookie(name, value) {
      document.cookie = name + '=' + value + '; path=/; expires=' + new Date(Date.now() + 365*24*3600*1000).toUTCString();
    }
    function deleteCookie(name) {
      document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/';
    }

    function showTranslateFallback() {
      if (document.getElementById('translate-fallback')) return;
      var bar = document.createElement('div');
      bar.id = 'translate-fallback';
      bar.style.cssText = 'position:fixed;bottom:12px;left:50%;transform:translateX(-50%);z-index:9999;background:#111827;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 4px 16px rgba(0,0,0,0.25);display:flex;gap:10px;align-items:center;';
      bar.innerHTML = '<span style="font-size:13px">Auto-translate tidak tersedia di perangkat ini.</span>' +
        '<button id="btnTryId" style="background:#0ea5e9;color:#fff;border:none;padding:6px 10px;border-radius:8px;font-size:12px">Coba versi Indonesia</button>' +
        '<button id="btnCloseTf" style="background:transparent;color:#fff;border:1px solid #fff3;padding:6px 10px;border-radius:8px;font-size:12px">Tutup</button>';
      document.body.appendChild(bar);
      document.getElementById('btnCloseTf').onclick = function(){ bar.remove(); };
      document.getElementById('btnTryId').onclick = function(){
        var idUrl = new URL(location.href);
        var p = location.pathname;
        if (!p.startsWith('/id/')) {
          idUrl.pathname = '/id' + (p.startsWith('/') ? p : '/' + p);
        }
        fetch(idUrl, { method: 'HEAD' }).then(function(r){
          if (r.ok) location.href = idUrl; else location.href = '/id/';
        }).catch(function(){ location.href = '/id/'; });
      };
    }

    function translateTo(lang) {
      loadGoogleTranslate(function () {
        var combo = document.querySelector('.goog-te-combo');
        if (combo) {
          combo.value = lang;
          combo.dispatchEvent(new Event('change'));
        } else {
          
          setCookie('googtrans', '/en/' + lang);
          location.reload();
        }
      }, showTranslateFallback);
    }

    function resetTranslate() {
      deleteCookie('googtrans');
      deleteCookie('GOOGTRANS');
    }

    document.querySelectorAll('.js-lang-link').forEach(function (a) {
      a.addEventListener('click', function (e) {
        var lang = a.getAttribute('data-lang');
        var has = a.getAttribute('data-has-trans') === 'true';
        if (lang === 'en') {
          resetTranslate();
          return; 
        }
        if (!has) {
          e.preventDefault();
          translateTo(lang);
        }
      });
    });
  })();
</script>


    
  </body>
</html>
