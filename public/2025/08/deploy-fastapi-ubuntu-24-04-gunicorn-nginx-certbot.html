<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  
  
  
  

  
  <title>Deploy FastAPI on Ubuntu 24.04 Gunicorn &#43; Nginx &#43; Certbot (HTTPS) | Buana Coding</title>

  
  <meta name="description" content="A complete guide to deploying FastAPI on Ubuntu 24.04 using Gunicorn as the ASGI server and Nginx as a reverse proxy, plus free HTTPS via Certbot/Let’s Encrypt. Includes a systemd service, UFW firewall, and troubleshooting." />

  
  
    <meta name="keywords" content="fastapi, deploy fastapi, ubuntu 24.04, gunicorn, uvicorn, nginx, certbot, let&#39;s encrypt, systemd, ufw" />
  

  
  <link rel="canonical" href="http://localhost:1313/2025/08/deploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html" />

  
  
  
  
  
    <link rel="alternate" hreflang="en" href="http://localhost:1313/2025/08/deploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html" />
  
  

  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:title" content="Deploy FastAPI on Ubuntu 24.04 Gunicorn &#43; Nginx &#43; Certbot (HTTPS) | Buana Coding" />
  <meta property="og:description" content="A complete guide to deploying FastAPI on Ubuntu 24.04 using Gunicorn as the ASGI server and Nginx as a reverse proxy, plus free HTTPS via Certbot/Let’s Encrypt. Includes a systemd service, UFW firewall, and troubleshooting." />
  <meta property="og:url" content="http://localhost:1313/2025/08/deploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html" />
  <meta property="og:image" content="https://www.buanacoding.com/images/og-image.jpg" />

  
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Deploy FastAPI on Ubuntu 24.04 Gunicorn &#43; Nginx &#43; Certbot (HTTPS) | Buana Coding" />
  <meta name="twitter:description" content="A complete guide to deploying FastAPI on Ubuntu 24.04 using Gunicorn as the ASGI server and Nginx as a reverse proxy, plus free HTTPS via Certbot/Let’s Encrypt. Includes a systemd service, UFW firewall, and troubleshooting." />
  <meta name="twitter:image" content="https://www.buanacoding.com/images/og-image.jpg" />

  
  
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Deploy FastAPI on Ubuntu 24.04 Gunicorn \u002b Nginx \u002b Certbot (HTTPS) | Buana Coding",
    "description": "A complete guide to deploying FastAPI on Ubuntu 24.04 using Gunicorn as the ASGI server and Nginx as a reverse proxy, plus free HTTPS via Certbot\/Let’s Encrypt. Includes a systemd service, UFW firewall, and troubleshooting.",
    "inLanguage": "en",
    "datePublished": "2025-08-15T18:00:00\u002b07:00",
    "dateModified": "2025-08-15T18:00:00\u002b07:00",
    "author": {
      "@type": "Person",
      "name": "Wiku Karno"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/2025\/08\/deploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html"
    },
    "image": "https:\/\/www.buanacoding.com\/images\/og-image.jpg",
    "publisher": {
      "@type": "Organization",
      "name": "Buana Coding"
    }
  }
  </script>
  

  
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />

  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/style.css?v=1760795398" />
  <link rel="stylesheet" href="/css/overrides.css?v=1760795398" />
  <link rel="stylesheet" href="/css/syntax.css?v=1760795398" />

  
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('consent', 'default', {
      'ad_storage': 'granted',
      'ad_user_data': 'granted',
      'ad_personalization': 'granted',
      'analytics_storage': 'granted'
    });
  </script>

  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0EN9J73FXF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0EN9J73FXF');
</script>

<script async src="https://fundingchoicesmessages.google.com/i/pub-3149036684216973?ers=1"></script><script>(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();</script>

<script>(function(){'use strict';function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var ba=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this);function l(a,b){if(b)a:{var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&b!=null&&ba(c,a,{configurable:!0,writable:!0,value:b})}}
function ea(a){return a.raw=a}function n(a){var b=typeof Symbol!="undefined"&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if(typeof a.length=="number")return{next:aa(a)};throw Error(String(a)+" is not an iterable or ArrayLike");}function fa(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}var ha=typeof Object.create=="function"?Object.create:function(a){function b(){}b.prototype=a;return new b},p;
if(typeof Object.setPrototypeOf=="function")p=Object.setPrototypeOf;else{var q;a:{var ja={a:!0},ka={};try{ka.__proto__=ja;q=ka.a;break a}catch(a){}q=!1}p=q?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var la=p;
function t(a,b){a.prototype=ha(b.prototype);a.prototype.constructor=a;if(la)la(a,b);else for(var c in b)if(c!="prototype")if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.A=b.prototype}function ma(){for(var a=Number(this),b=[],c=a;c<arguments.length;c++)b[c-a]=arguments[c];return b}l("Object.is",function(a){return a?a:function(b,c){return b===c?b!==0||1/b===1/c:b!==b&&c!==c}});
l("Array.prototype.includes",function(a){return a?a:function(b,c){var d=this;d instanceof String&&(d=String(d));var e=d.length;c=c||0;for(c<0&&(c=Math.max(c+e,0));c<e;c++){var f=d[c];if(f===b||Object.is(f,b))return!0}return!1}});
l("String.prototype.includes",function(a){return a?a:function(b,c){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(b,c||0)!==-1}});l("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991});
l("Number.isFinite",function(a){return a?a:function(b){return typeof b!=="number"?!1:!isNaN(b)&&b!==Infinity&&b!==-Infinity}});l("Number.isInteger",function(a){return a?a:function(b){return Number.isFinite(b)?b===Math.floor(b):!1}});l("Number.isSafeInteger",function(a){return a?a:function(b){return Number.isInteger(b)&&Math.abs(b)<=Number.MAX_SAFE_INTEGER}});
l("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0)return b;var c=Math.floor(Math.abs(b));return b<0?-c:c}});

var u=this||self;function v(a,b){a:{var c=["CLOSURE_FLAGS"];for(var d=u,e=0;e<c.length;e++)if(d=d[c[e]],d==null){c=null;break a}c=d}a=c&&c[a];return a!=null?a:b}function w(a){return a};function na(a){u.setTimeout(function(){throw a;},0)};var oa=v(610401301,!1),pa=v(188588736,!0),qa=v(645172343,v(1,!0));var x,ra=u.navigator;x=ra?ra.userAgentData||null:null;function z(a){return oa?x?x.brands.some(function(b){return(b=b.brand)&&b.indexOf(a)!=-1}):!1:!1}function A(a){var b;a:{if(b=u.navigator)if(b=b.userAgent)break a;b=""}return b.indexOf(a)!=-1};function B(){return oa?!!x&&x.brands.length>0:!1}function C(){return B()?z("Chromium"):(A("Chrome")||A("CriOS"))&&!(B()?0:A("Edge"))||A("Silk")};var sa=B()?!1:A("Trident")||A("MSIE");!A("Android")||C();C();A("Safari")&&(C()||(B()?0:A("Coast"))||(B()?0:A("Opera"))||(B()?0:A("Edge"))||(B()?z("Microsoft Edge"):A("Edg/"))||B()&&z("Opera"));var ta={},D=null;var ua=typeof Uint8Array!=="undefined",va=!sa&&typeof btoa==="function";var wa;function E(){return typeof BigInt==="function"};var F=typeof Symbol==="function"&&typeof Symbol()==="symbol";function xa(a){return typeof Symbol==="function"&&typeof Symbol()==="symbol"?Symbol():a}var G=xa(),ya=xa("2ex");var za=F?function(a,b){a[G]|=b}:function(a,b){a.g!==void 0?a.g|=b:Object.defineProperties(a,{g:{value:b,configurable:!0,writable:!0,enumerable:!1}})},H=F?function(a){return a[G]|0}:function(a){return a.g|0},I=F?function(a){return a[G]}:function(a){return a.g},J=F?function(a,b){a[G]=b}:function(a,b){a.g!==void 0?a.g=b:Object.defineProperties(a,{g:{value:b,configurable:!0,writable:!0,enumerable:!1}})};function Aa(a,b){J(b,(a|0)&-14591)}function Ba(a,b){J(b,(a|34)&-14557)};var K={},Ca={};function Da(a){return!(!a||typeof a!=="object"||a.g!==Ca)}function Ea(a){return a!==null&&typeof a==="object"&&!Array.isArray(a)&&a.constructor===Object}function L(a,b,c){if(!Array.isArray(a)||a.length)return!1;var d=H(a);if(d&1)return!0;if(!(b&&(Array.isArray(b)?b.includes(c):b.has(c))))return!1;J(a,d|1);return!0};var M=0,N=0;function Fa(a){var b=a>>>0;M=b;N=(a-b)/4294967296>>>0}function Ga(a){if(a<0){Fa(-a);var b=n(Ha(M,N));a=b.next().value;b=b.next().value;M=a>>>0;N=b>>>0}else Fa(a)}function Ia(a,b){b>>>=0;a>>>=0;if(b<=2097151)var c=""+(4294967296*b+a);else E()?c=""+(BigInt(b)<<BigInt(32)|BigInt(a)):(c=(a>>>24|b<<8)&16777215,b=b>>16&65535,a=(a&16777215)+c*6777216+b*6710656,c+=b*8147497,b*=2,a>=1E7&&(c+=a/1E7>>>0,a%=1E7),c>=1E7&&(b+=c/1E7>>>0,c%=1E7),c=b+Ja(c)+Ja(a));return c}
function Ja(a){a=String(a);return"0000000".slice(a.length)+a}function Ha(a,b){b=~b;a?a=~a+1:b+=1;return[a,b]};var Ka=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;var O;function La(a,b){O=b;a=new a(b);O=void 0;return a}
function P(a,b,c){a==null&&(a=O);O=void 0;if(a==null){var d=96;c?(a=[c],d|=512):a=[];b&&(d=d&-16760833|(b&1023)<<14)}else{if(!Array.isArray(a))throw Error("narr");d=H(a);if(d&2048)throw Error("farr");if(d&64)return a;d|=64;if(c&&(d|=512,c!==a[0]))throw Error("mid");a:{c=a;var e=c.length;if(e){var f=e-1;if(Ea(c[f])){d|=256;b=f-(+!!(d&512)-1);if(b>=1024)throw Error("pvtlmt");d=d&-16760833|(b&1023)<<14;break a}}if(b){b=Math.max(b,e-(+!!(d&512)-1));if(b>1024)throw Error("spvt");d=d&-16760833|(b&1023)<<
14}}}J(a,d);return a};function Ma(a){switch(typeof a){case "number":return isFinite(a)?a:String(a);case "boolean":return a?1:0;case "object":if(a)if(Array.isArray(a)){if(L(a,void 0,0))return}else if(ua&&a!=null&&a instanceof Uint8Array){if(va){for(var b="",c=0,d=a.length-10240;c<d;)b+=String.fromCharCode.apply(null,a.subarray(c,c+=10240));b+=String.fromCharCode.apply(null,c?a.subarray(c):a);a=btoa(b)}else{b===void 0&&(b=0);if(!D){D={};c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split("");d=["+/=",
"+/","-_=","-_.","-_"];for(var e=0;e<5;e++){var f=c.concat(d[e].split(""));ta[e]=f;for(var g=0;g<f.length;g++){var h=f[g];D[h]===void 0&&(D[h]=g)}}}b=ta[b];c=Array(Math.floor(a.length/3));d=b[64]||"";for(e=f=0;f<a.length-2;f+=3){var k=a[f],m=a[f+1];h=a[f+2];g=b[k>>2];k=b[(k&3)<<4|m>>4];m=b[(m&15)<<2|h>>6];h=b[h&63];c[e++]=g+k+m+h}g=0;h=d;switch(a.length-f){case 2:g=a[f+1],h=b[(g&15)<<2]||d;case 1:a=a[f],c[e]=b[a>>2]+b[(a&3)<<4|g>>4]+h+d}a=c.join("")}return a}}return a};function Na(a,b,c){a=Array.prototype.slice.call(a);var d=a.length,e=b&256?a[d-1]:void 0;d+=e?-1:0;for(b=b&512?1:0;b<d;b++)a[b]=c(a[b]);if(e){b=a[b]={};for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(b[f]=c(e[f]))}return a}function Oa(a,b,c,d,e){if(a!=null){if(Array.isArray(a))a=L(a,void 0,0)?void 0:e&&H(a)&2?a:Pa(a,b,c,d!==void 0,e);else if(Ea(a)){var f={},g;for(g in a)Object.prototype.hasOwnProperty.call(a,g)&&(f[g]=Oa(a[g],b,c,d,e));a=f}else a=b(a,d);return a}}
function Pa(a,b,c,d,e){var f=d||c?H(a):0;d=d?!!(f&32):void 0;a=Array.prototype.slice.call(a);for(var g=0;g<a.length;g++)a[g]=Oa(a[g],b,c,d,e);c&&c(f,a);return a}function Qa(a){return a.s===K?a.toJSON():Ma(a)};function Ra(a,b,c){c=c===void 0?Ba:c;if(a!=null){if(ua&&a instanceof Uint8Array)return b?a:new Uint8Array(a);if(Array.isArray(a)){var d=H(a);if(d&2)return a;b&&(b=d===0||!!(d&32)&&!(d&64||!(d&16)));return b?(J(a,(d|34)&-12293),a):Pa(a,Ra,d&4?Ba:c,!0,!0)}a.s===K&&(c=a.h,d=I(c),a=d&2?a:La(a.constructor,Sa(c,d,!0)));return a}}function Sa(a,b,c){var d=c||b&2?Ba:Aa,e=!!(b&32);a=Na(a,b,function(f){return Ra(f,e,d)});za(a,32|(c?2:0));return a};function Ta(a,b){a=a.h;return Ua(a,I(a),b)}function Va(a,b,c,d){b=d+(+!!(b&512)-1);if(!(b<0||b>=a.length||b>=c))return a[b]}
function Ua(a,b,c,d){if(c===-1)return null;var e=b>>14&1023||536870912;if(c>=e){if(b&256)return a[a.length-1][c]}else{var f=a.length;if(d&&b&256&&(d=a[f-1][c],d!=null)){if(Va(a,b,e,c)&&ya!=null){var g;a=(g=wa)!=null?g:wa={};g=a[ya]||0;g>=4||(a[ya]=g+1,g=Error(),g.__closure__error__context__984382||(g.__closure__error__context__984382={}),g.__closure__error__context__984382.severity="incident",na(g))}return d}return Va(a,b,e,c)}}
function Wa(a,b,c,d,e){var f=b>>14&1023||536870912;if(c>=f||e&&!qa){var g=b;if(b&256)e=a[a.length-1];else{if(d==null)return;e=a[f+(+!!(b&512)-1)]={};g|=256}e[c]=d;c<f&&(a[c+(+!!(b&512)-1)]=void 0);g!==b&&J(a,g)}else a[c+(+!!(b&512)-1)]=d,b&256&&(a=a[a.length-1],c in a&&delete a[c])}
function Xa(a,b){var c=Ya;var d=d===void 0?!1:d;var e=a.h;var f=I(e),g=Ua(e,f,b,d);if(g!=null&&typeof g==="object"&&g.s===K)c=g;else if(Array.isArray(g)){var h=H(g),k=h;k===0&&(k|=f&32);k|=f&2;k!==h&&J(g,k);c=new c(g)}else c=void 0;c!==g&&c!=null&&Wa(e,f,b,c,d);e=c;if(e==null)return e;a=a.h;f=I(a);f&2||(g=e,c=g.h,h=I(c),g=h&2?La(g.constructor,Sa(c,h,!1)):g,g!==e&&(e=g,Wa(a,f,b,e,d)));return e}function Za(a,b){a=Ta(a,b);return a==null||typeof a==="string"?a:void 0}
function $a(a,b){var c=c===void 0?0:c;a=Ta(a,b);if(a!=null)if(b=typeof a,b==="number"?Number.isFinite(a):b!=="string"?0:Ka.test(a))if(typeof a==="number"){if(a=Math.trunc(a),!Number.isSafeInteger(a)){Ga(a);b=M;var d=N;if(a=d&2147483648)b=~b+1>>>0,d=~d>>>0,b==0&&(d=d+1>>>0);b=d*4294967296+(b>>>0);a=a?-b:b}}else if(b=Math.trunc(Number(a)),Number.isSafeInteger(b))a=String(b);else{if(b=a.indexOf("."),b!==-1&&(a=a.substring(0,b)),!(a[0]==="-"?a.length<20||a.length===20&&Number(a.substring(0,7))>-922337:
a.length<19||a.length===19&&Number(a.substring(0,6))<922337)){if(a.length<16)Ga(Number(a));else if(E())a=BigInt(a),M=Number(a&BigInt(4294967295))>>>0,N=Number(a>>BigInt(32)&BigInt(4294967295));else{b=+(a[0]==="-");N=M=0;d=a.length;for(var e=b,f=(d-b)%6+b;f<=d;e=f,f+=6)e=Number(a.slice(e,f)),N*=1E6,M=M*1E6+e,M>=4294967296&&(N+=Math.trunc(M/4294967296),N>>>=0,M>>>=0);b&&(b=n(Ha(M,N)),a=b.next().value,b=b.next().value,M=a,N=b)}a=M;b=N;b&2147483648?E()?a=""+(BigInt(b|0)<<BigInt(32)|BigInt(a>>>0)):(b=
n(Ha(a,b)),a=b.next().value,b=b.next().value,a="-"+Ia(a,b)):a=Ia(a,b)}}else a=void 0;return a!=null?a:c}function R(a,b){var c=c===void 0?"":c;a=Za(a,b);return a!=null?a:c};var S;function T(a,b,c){this.h=P(a,b,c)}T.prototype.toJSON=function(){return ab(this)};T.prototype.s=K;T.prototype.toString=function(){try{return S=!0,ab(this).toString()}finally{S=!1}};
function ab(a){var b=S?a.h:Pa(a.h,Qa,void 0,void 0,!1);var c=!S;var d=pa?void 0:a.constructor.v;var e=I(c?a.h:b);if(a=b.length){var f=b[a-1],g=Ea(f);g?a--:f=void 0;e=+!!(e&512)-1;var h=b;if(g){b:{var k=f;var m={};g=!1;if(k)for(var r in k)if(Object.prototype.hasOwnProperty.call(k,r))if(isNaN(+r))m[r]=k[r];else{var y=k[r];Array.isArray(y)&&(L(y,d,+r)||Da(y)&&y.size===0)&&(y=null);y==null&&(g=!0);y!=null&&(m[r]=y)}if(g){for(var Q in m)break b;m=null}else m=k}k=m==null?f!=null:m!==f}for(var ia;a>0;a--){Q=
a-1;r=h[Q];Q-=e;if(!(r==null||L(r,d,Q)||Da(r)&&r.size===0))break;ia=!0}if(h!==b||k||ia){if(!c)h=Array.prototype.slice.call(h,0,a);else if(ia||k||m)h.length=a;m&&h.push(m)}b=h}return b};function bb(a){return function(b){if(b==null||b=="")b=new a;else{b=JSON.parse(b);if(!Array.isArray(b))throw Error("dnarr");za(b,32);b=La(a,b)}return b}};function cb(a){this.h=P(a)}t(cb,T);var db=bb(cb);var U;function V(a){this.g=a}V.prototype.toString=function(){return this.g+""};var eb={};function fb(a){if(U===void 0){var b=null;var c=u.trustedTypes;if(c&&c.createPolicy){try{b=c.createPolicy("goog#html",{createHTML:w,createScript:w,createScriptURL:w})}catch(d){u.console&&u.console.error(d.message)}U=b}else U=b}a=(b=U)?b.createScriptURL(a):a;return new V(a,eb)};

function gb(a){var b=ma.apply(1,arguments);if(b.length===0)return fb(a[0]);for(var c=a[0],d=0;d<b.length;d++)c+=encodeURIComponent(b[d])+a[d+1];return fb(c)};function hb(a,b){a.src=b instanceof V&&b.constructor===V?b.g:"type_error:TrustedResourceUrl";var c,d;(c=(b=(d=(c=(a.ownerDocument&&a.ownerDocument.defaultView||window).document).querySelector)==null?void 0:d.call(c,"script[nonce]"))?b.nonce||b.getAttribute("nonce")||"":"")&&a.setAttribute("nonce",c)};function ib(){return Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)};function jb(a,b){b=String(b);a.contentType==="application/xhtml+xml"&&(b=b.toLowerCase());return a.createElement(b)}function kb(a){this.g=a||u.document||document};function lb(a){a=a===void 0?document:a;return a.createElement("script")};function mb(a,b,c,d,e,f){try{var g=a.g,h=lb(g);h.async=!0;hb(h,b);g.head.appendChild(h);h.addEventListener("load",function(){e();d&&g.head.removeChild(h)});h.addEventListener("error",function(){c>0?mb(a,b,c-1,d,e,f):(d&&g.head.removeChild(h),f())})}catch(k){f()}};var nb=u.atob("aHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vaW1hZ2VzL2ljb25zL21hdGVyaWFsL3N5c3RlbS8xeC93YXJuaW5nX2FtYmVyXzI0ZHAucG5n"),ob=u.atob("WW91IGFyZSBzZWVpbmcgdGhpcyBtZXNzYWdlIGJlY2F1c2UgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlIGlzIGludGVyZmVyaW5nIHdpdGggdGhpcyBwYWdlLg=="),pb=u.atob("RGlzYWJsZSBhbnkgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlLCB0aGVuIHJlbG9hZCB0aGlzIHBhZ2Uu");function qb(a,b,c){this.i=a;this.u=b;this.o=c;this.g=null;this.j=[];this.m=!1;this.l=new kb(this.i)}
function rb(a){if(a.i.body&&!a.m){var b=function(){sb(a);u.setTimeout(function(){tb(a,3)},50)};mb(a.l,a.u,2,!0,function(){u[a.o]||b()},b);a.m=!0}}
function sb(a){for(var b=W(1,5),c=0;c<b;c++){var d=X(a);a.i.body.appendChild(d);a.j.push(d)}b=X(a);b.style.bottom="0";b.style.left="0";b.style.position="fixed";b.style.width=W(100,110).toString()+"%";b.style.zIndex=W(2147483544,2147483644).toString();b.style.backgroundColor=ub(249,259,242,252,219,229);b.style.boxShadow="0 0 12px #888";b.style.color=ub(0,10,0,10,0,10);b.style.display="flex";b.style.justifyContent="center";b.style.fontFamily="Roboto, Arial";c=X(a);c.style.width=W(80,85).toString()+
"%";c.style.maxWidth=W(750,775).toString()+"px";c.style.margin="24px";c.style.display="flex";c.style.alignItems="flex-start";c.style.justifyContent="center";d=jb(a.l.g,"IMG");d.className=ib();d.src=nb;d.alt="Warning icon";d.style.height="24px";d.style.width="24px";d.style.paddingRight="16px";var e=X(a),f=X(a);f.style.fontWeight="bold";f.textContent=ob;var g=X(a);g.textContent=pb;Y(a,e,f);Y(a,e,g);Y(a,c,d);Y(a,c,e);Y(a,b,c);a.g=b;a.i.body.appendChild(a.g);b=W(1,5);for(c=0;c<b;c++)d=X(a),a.i.body.appendChild(d),
a.j.push(d)}function Y(a,b,c){for(var d=W(1,5),e=0;e<d;e++){var f=X(a);b.appendChild(f)}b.appendChild(c);c=W(1,5);for(d=0;d<c;d++)e=X(a),b.appendChild(e)}function W(a,b){return Math.floor(a+Math.random()*(b-a))}function ub(a,b,c,d,e,f){return"rgb("+W(Math.max(a,0),Math.min(b,255)).toString()+","+W(Math.max(c,0),Math.min(d,255)).toString()+","+W(Math.max(e,0),Math.min(f,255)).toString()+")"}function X(a){a=jb(a.l.g,"DIV");a.className=ib();return a}
function tb(a,b){b<=0||a.g!=null&&a.g.offsetHeight!==0&&a.g.offsetWidth!==0||(vb(a),sb(a),u.setTimeout(function(){tb(a,b-1)},50))}function vb(a){for(var b=n(a.j),c=b.next();!c.done;c=b.next())(c=c.value)&&c.parentNode&&c.parentNode.removeChild(c);a.j=[];(b=a.g)&&b.parentNode&&b.parentNode.removeChild(b);a.g=null};function wb(a,b,c,d,e){function f(k){document.body?g(document.body):k>0?u.setTimeout(function(){f(k-1)},e):b()}function g(k){k.appendChild(h);u.setTimeout(function(){h?(h.offsetHeight!==0&&h.offsetWidth!==0?b():a(),h.parentNode&&h.parentNode.removeChild(h)):a()},d)}var h=xb(c);f(3)}function xb(a){var b=document.createElement("div");b.className=a;b.style.width="1px";b.style.height="1px";b.style.position="absolute";b.style.left="-10000px";b.style.top="-10000px";b.style.zIndex="-10000";return b};function Ya(a){this.h=P(a)}t(Ya,T);function yb(a){this.h=P(a)}t(yb,T);var zb=bb(yb);function Ab(a){if(!a)return null;a=Za(a,4);var b;a===null||a===void 0?b=null:b=fb(a);return b};var Bb=ea([""]),Cb=ea([""]);function Db(a,b){this.m=a;this.o=new kb(a.document);this.g=b;this.j=R(this.g,1);this.u=Ab(Xa(this.g,2))||gb(Bb);this.i=!1;b=Ab(Xa(this.g,13))||gb(Cb);this.l=new qb(a.document,b,R(this.g,12))}Db.prototype.start=function(){Eb(this)};
function Eb(a){Fb(a);mb(a.o,a.u,3,!1,function(){a:{var b=a.j;var c=u.btoa(b);if(c=u[c]){try{var d=db(u.atob(c))}catch(e){b=!1;break a}b=b===Za(d,1)}else b=!1}b?Z(a,R(a.g,14)):(Z(a,R(a.g,8)),rb(a.l))},function(){wb(function(){Z(a,R(a.g,7));rb(a.l)},function(){return Z(a,R(a.g,6))},R(a.g,9),$a(a.g,10),$a(a.g,11))})}function Z(a,b){a.i||(a.i=!0,a=new a.m.XMLHttpRequest,a.open("GET",b,!0),a.send())}function Fb(a){var b=u.btoa(a.j);a.m[b]&&Z(a,R(a.g,5))};(function(a,b){u[a]=function(){var c=ma.apply(0,arguments);u[a]=function(){};b.call.apply(b,[null].concat(c instanceof Array?c:fa(n(c))))}})("__h82AlnkH6D91__",function(a){typeof window.atob==="function"&&(new Db(window,zb(window.atob(a)))).start()});}).call(this);

window.__h82AlnkH6D91__("WyJwdWItMzE0OTAzNjY4NDIxNjk3MyIsW251bGwsbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9iL3B1Yi0zMTQ5MDM2Njg0MjE2OTczIl0sbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9lbC9BR1NLV3hXRW1tb2ZrZGEwZHlSNkcxMkdNSnNEZDF5UFF4a3FSYS11R2NVem9LZHh6NGFxNndzZm5DN3VPekxfWmljWUZvSW5iYnNKRGtFUUU1a1RUNFFGb25MMF9nXHUwMDNkXHUwMDNkP3RlXHUwMDNkVE9LRU5fRVhQT1NFRCIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFZVeXNCQ3NSc2llS3ExOENZVDNibVVqbFREbTVKM01FR1BSdUVoRjFsV3c3UjVNdGRwWnhNM2hJQm1tMnZhbjNmVWxZcVNLSnoycE5xMWNSTUJZYUxfLXdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QxXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFVvQ2JlQlRkS2gzZmU0NnB1VERhek9PdHN0b0p3NjhKUU5SOGQ1OFgwWm9QRlV0LUZPUm1HU1ZJajM2WXQwQjU3c0t1bUFmcjFNWU5JV3U3U3JXNi1EQkFcdTAwM2RcdTAwM2Q/YWJcdTAwM2QyXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFdORXhuRXA0STJueGlBNXdiejVRMDZzT0Njek53bFltRXo4cWhOY0sxZzd2N1UwR2ZVZ0hJOFlPeWk1Qms2NGljWTNzU3BMRE9IZ3pSNTg0VlA5ak5sZmdcdTAwM2RcdTAwM2Q/c2JmXHUwMDNkMiIsImRpdi1ncHQtYWQiLDIwLDEwMCwiY0hWaUxUTXhORGt3TXpZMk9EUXlNVFk1TnpNXHUwMDNkIixbbnVsbCxudWxsLG51bGwsImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tLzBlbW4vZi9wL3B1Yi0zMTQ5MDM2Njg0MjE2OTczLmpzP3VzcXBcdTAwM2RDQWMiXSwiaHR0cHM6Ly9mdW5kaW5nY2hvaWNlc21lc3NhZ2VzLmdvb2dsZS5jb20vZWwvQUdTS1d4VmpzRmdxZHhwME1yZFNEMjF6Q2l2TkR3cjZvM0FfNEQyYVlaRUJJZXZNSmN1eUVvNmRmX29XMUNiZFVRdVR1WW52cGZUdWhteS1NTXZfcGlqVlB0NUQxZ1x1MDAzZFx1MDAzZCJd");</script>





</head>

  <body
    class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen flex flex-col"
  >
    
    <header class="bg-[#0f7ea9] dark:bg-[#094d66] text-white shadow">
  <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
    <h1 class="text-2xl font-extrabold tracking-wide">
      <a href="/" class="hover:opacity-90">BUANACODING</a>
    </h1>

    
    <nav
      class="hidden md:flex items-center space-x-6 font-semibold uppercase tracking-wide"
    >
      
      
      
        
          
          <a
            href="/tags/general"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            General
          </a>
        
          
          <a
            href="/tags/go"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            Go
          </a>
        
          
          <a
            href="/tags/laravel"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            Laravel
          </a>
        
          
          <a
            href="/tags/linux"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            Linux
          </a>
        
          
          <a
            href="/tags/python"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            Python
          </a>
        
          
          <a
            href="/tags/security"
            class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
          >
            Security
          </a>
        
      

      
      <div class="hidden md:flex items-center">
        
        
        <div class="flex border border-white/30 rounded overflow-hidden text-xs font-medium">
          
            
            
            
            
              
              
            
            
            <a href="/2025/08/deploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html"
               data-lang="en" data-has-trans="true"
               class="js-lang-link px-2 py-1 bg-white/20 text-white">
              EN
            </a>
          
            
            
            
            
            
              
              
                
              
            
            <a href="/id/"
               data-lang="id" data-has-trans="false"
               class="js-lang-link px-2 py-1 bg-transparent hover:bg-white/10 text-white/80">
              ID
            </a>
          
        </div>
      </div>

      
      <button
        id="openSearchModal"
        class="text-white transition duration-300 cursor-pointer focus:outline-none dark:hover:text-[#0f7ea9] hover:text-cyan-300"
        aria-label="Search"
      >
        <i data-feather="search" class="w-5 h-5"></i>
      </button>

      
      <button
        id="theme-toggle"
        class="ml-2 text-white hover:text-yellow-300 transition duration-300 focus:outline-none cursor-pointer"
        aria-label="Toggle Dark Mode"
      >
        
        <i id="icon-sun" data-feather="sun" class="w-5 h-5 hidden"></i>
        <i id="icon-moon" data-feather="moon" class="w-5 h-5"></i>
      </button>
    </nav>

    
    <button id="menu-toggle" class="md:hidden text-2xl focus:outline-none">
      ☰
    </button>
  </div>

  
  <div id="mobile-menu" class="hidden md:hidden px-4 pb-4 space-y-2">
    
    
      
        
        <a
          href="/tags/general"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          General
        </a>
      
        
        <a
          href="/tags/go"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          Go
        </a>
      
        
        <a
          href="/tags/laravel"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          Laravel
        </a>
      
        
        <a
          href="/tags/linux"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          Linux
        </a>
      
        
        <a
          href="/tags/python"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          Python
        </a>
      
        
        <a
          href="/tags/security"
          class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize"
        >
          Security
        </a>
      
    

    
    <div class="mt-8 space-y-6">
      
      
      <button
        id="openSearchModalMobile"
        class="w-full text-left text-white hover:text-cyan-300 transition duration-300 flex items-center gap-4 py-2"
        aria-label="Search"
      >
        <i data-feather="search" class="w-5 h-5"></i>
        <span class="text-sm font-medium">Search</span>
      </button>

      
      <div class="flex items-center justify-between py-2">
        <div class="flex items-center gap-4">
          <i data-feather="globe" class="w-5 h-5 text-white/80"></i>
          <span class="text-sm font-medium text-white">Language</span>
        </div>
        <div class="flex text-xs">
          
          
          
            
            
            
            
              
              
            
            
            <a href="/2025/08/deploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html"
               data-lang="en" data-has-trans="true"
               class="js-lang-link px-3 py-1.5 text-white font-medium">
              EN
            </a>
          
            
            
            
            
            
              
              
                
              
            
            <a href="/id/"
               data-lang="id" data-has-trans="false"
               class="js-lang-link px-3 py-1.5 text-white/60 hover:text-white">
              ID
            </a>
          
        </div>
      </div>

      
      <button
        id="theme-toggle-mobile"
        class="w-full text-left text-white hover:text-cyan-300 transition duration-300 flex items-center gap-4 py-2"
        aria-label="Toggle Dark Mode"
      >
        <i id="icon-sun-mobile" data-feather="sun" class="w-5 h-5 hidden"></i>
        <i id="icon-moon-mobile" data-feather="moon" class="w-5 h-5"></i>
        <span class="text-sm font-medium">Theme</span>
      </button>
      
    </div>
  </div>
</header>



<div class="bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 py-2">
  <div class="max-w-7xl mx-auto px-4">
    
    
    <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-6 px-4 rounded text-gray-500 dark:text-gray-400">
      📢 Ad placeholder: Header Leaderboard (728×90 desktop, 320×50 mobile)
    </div>
    
  </div>
</div>


<div
  id="searchModal"
  class="fixed inset-0 z-50 hidden flex justify-center items-center bg-black/30 dark:bg-black/60 backdrop-blur-md p-4"
>
  <div
    class="bg-white dark:bg-[#1f2937] rounded-xl shadow-2xl w-full max-w-xl p-6 relative"
  >
    
    <button
      id="closeSearchModal"
      class="absolute -top-4 -right-4 bg-white dark:bg-[#374151] rounded-full p-1 shadow hover:bg-gray-100 dark:hover:bg-gray-600 transition duration-200 ease-in-out transform hover:scale-110"
    >
      <i
        data-feather="x"
        class="w-5 h-5 text-gray-600 dark:text-white hover:text-red-500"
      ></i>
    </button>

    
    <input
      type="text"
      id="searchBox"
      placeholder="Search articles..."
      class="w-full px-4 py-3 mb-4 border border-cyan-400 text-gray-800 dark:text-white dark:bg-[#374151] placeholder-gray-400 dark:placeholder-gray-400 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500"
    />

    
    
<div id="searchAdBanner" class="mt-4 mb-8 hidden">
  
  
  <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-4 px-4 rounded text-gray-500 dark:text-gray-400">
    🔍 Ad placeholder: Search Results Banner (320×100)
  </div>
  
</div>

<style>
#searchAdBanner {
   
  transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
}

#searchAdBanner.show {
  display: block !important;
  opacity: 1;
  transform: translateY(0);
}

#searchAdBanner.hide {
  opacity: 0;
  transform: translateY(-10px);
}

.search-results-ad {
  max-height: 100px;
  overflow: hidden;
}
</style>

    
    <ul
      id="results"
      class="bg-white dark:bg-[#1f2937] rounded-lg shadow max-h-60 overflow-y-auto divide-y divide-gray-200 dark:divide-gray-600"
    ></ul>
  </div>
</div>


    
    <main class="flex-1 w-full">
      <div class="max-w-7xl mx-auto py-8 px-4">
        
<div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-8 py-8">
  
  <article class="prose prose-blue dark:prose-invert lg:col-span-2">
    <nav class="text-sm text-gray-600 dark:text-gray-300 mb-4">
      <a href="/" class="text-gray-600 dark:text-gray-300 hover:text-[#0f7ea9] no-underline">Home</a>
      <span class="mx-2 text-gray-400 dark:text-gray-500">/</span>
      
        
        
          <a href="/tags/python" class="text-gray-600 dark:text-gray-300 hover:text-[#0f7ea9] no-underline">#Python</a>
        
      
    </nav>


    <h1>Deploy FastAPI on Ubuntu 24.04 Gunicorn &#43; Nginx &#43; Certbot (HTTPS)</h1>

    
    

    
    



<div class="flex items-center gap-4 my-4 py-3 border-b border-gray-200 dark:border-gray-700">
  <span class="text-sm text-gray-500 dark:text-gray-400 font-medium mr-2">Share:</span>
  
  
  <a href="https://twitter.com/intent/tweet?text=Deploy&#43;FastAPI&#43;on&#43;Ubuntu&#43;24.04&#43;Gunicorn&#43;%2B&#43;Nginx&#43;%2B&#43;Certbot&#43;%28HTTPS%29&url=http%3A%2F%2Flocalhost%3A1313%2F2025%2F08%2Fdeploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html&via=buanacoding" 
     target="_blank" rel="noopener"
     class="p-2 text-gray-500 dark:text-gray-400 hover:text-black hover:bg-gray-100 dark:hover:text-white dark:hover:bg-gray-700 rounded-full transition-all duration-200"
     title="Share on Twitter">
    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
      <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
    </svg>
  </a>

  
  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A1313%2F2025%2F08%2Fdeploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html" 
     target="_blank" rel="noopener"
     class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all duration-200"
     title="Share on Facebook">
    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
      <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
    </svg>
  </a>

  
  <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Flocalhost%3A1313%2F2025%2F08%2Fdeploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html" 
     target="_blank" rel="noopener"
     class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-700 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all duration-200"
     title="Share on LinkedIn">
    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
      <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
    </svg>
  </a>

  
  <a href="https://wa.me/?text=Deploy&#43;FastAPI&#43;on&#43;Ubuntu&#43;24.04&#43;Gunicorn&#43;%2B&#43;Nginx&#43;%2B&#43;Certbot&#43;%28HTTPS%29%20http%3A%2F%2Flocalhost%3A1313%2F2025%2F08%2Fdeploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html" 
     target="_blank" rel="noopener"
     class="p-2 text-gray-500 dark:text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:text-green-400 dark:hover:bg-green-900/20 rounded-full transition-all duration-200"
     title="Share on WhatsApp">
    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
      <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.484 3.488"/>
    </svg>
  </a>

  
  <button onclick="copyLinkHeader('http:\/\/localhost:1313\/2025\/08\/deploy-fastapi-ubuntu-24-04-gunicorn-nginx-certbot.html')" 
          class="p-2 text-gray-500 dark:text-gray-400 hover:text-gray-800 hover:bg-gray-100 dark:hover:text-gray-200 dark:hover:bg-gray-700 rounded-full transition-all duration-200"
          title="Copy Link">
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
    </svg>
  </button>

  
  <span id="copy-header-success" class="hidden text-xs text-green-600 dark:text-green-400 font-medium">
    Copied!
  </span>
</div>

<script>
function copyLinkHeader(url) {
  navigator.clipboard.writeText(url).then(function() {
    showHeaderSuccess();
  }).catch(function(err) {
    
    const textArea = document.createElement('textarea');
    textArea.value = url;
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
    showHeaderSuccess();
  });
}

function showHeaderSuccess() {
  const successMsg = document.getElementById('copy-header-success');
  successMsg.classList.remove('hidden');
  
  
  setTimeout(function() {
    successMsg.classList.add('hidden');
  }, 2000);
}
</script>

    
    
    
    
    
    
    

    
    
      <p>Want to deploy FastAPI on Ubuntu 24.04 with a clean, secure, and maintainable setup? This guide walks you through running Gunicorn (ASGI server), Nginx (reverse proxy), and free HTTPS from Let’s Encrypt using Certbot. We’ll also use systemd so your service starts on boot and is easy to restart after updates.</p>
    
      
<p>What you’ll build:</p>
    
      
<ul>
<li>A minimal FastAPI project structure</li>
<li>Running the app with Gunicorn (Uvicorn worker)</li>
<li>A systemd service for start/stop/restart</li>
<li>Nginx reverse proxy to Gunicorn</li>
<li>HTTPS (Certbot) with auto‑renewal</li>
<li>UFW firewall (open 80/443), logs, and troubleshooting tips</li>
</ul>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>Ubuntu 24.04 server (sudo access)</li>
<li>A domain pointing to the server (A/AAAA records)</li>
<li>Python 3.10+ (Ubuntu 24.04 default is fine)</li>
</ul>
<ol>
<li>Prepare the project structure on the server</li>
</ol>
<hr>
<p>A tidy layout makes automation easier.</p>
    
    
    
    
      
<div class="my-8 flex justify-center">
  <div class="w-full max-w-2xl">
    
    
    <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-4 px-6 rounded-lg text-gray-500 dark:text-gray-400">
      📢 Ad placeholder: In‑Article (native style)
    </div>
    
  </div>
</div>

    
    
    
    
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo mkdir -p /opt/fastapi/app
</span></span><span class="line"><span class="cl">sudo adduser --system --group --home /opt/fastapi fastapi
</span></span><span class="line"><span class="cl">sudo chown -R fastapi:fastapi /opt/fastapi
</span></span></code></pre></div><ol start="2">
<li>Create a virtualenv and install dependencies</li>
</ol>
<hr>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt update
</span></span><span class="line"><span class="cl">sudo apt install -y python3-venv
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo -u fastapi python3 -m venv /opt/fastapi/venv
</span></span><span class="line"><span class="cl">sudo -u fastapi /opt/fastapi/venv/bin/pip install --upgrade pip
</span></span><span class="line"><span class="cl">sudo -u fastapi /opt/fastapi/venv/bin/pip install fastapi uvicorn gunicorn
</span></span></code></pre></div><p>Create a requirements.txt for easier dependency management:</p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u fastapi tee /opt/fastapi/requirements.txt &gt;/dev/null <span class="s">&lt;&lt;&#39;REQS&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">fastapi==0.104.1
</span></span></span><span class="line"><span class="cl"><span class="s">uvicorn[standard]==0.24.0
</span></span></span><span class="line"><span class="cl"><span class="s">gunicorn==21.2.0
</span></span></span><span class="line"><span class="cl"><span class="s">pydantic==2.5.0
</span></span></span><span class="line"><span class="cl"><span class="s">REQS</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo -u fastapi /opt/fastapi/venv/bin/pip install -r /opt/fastapi/requirements.txt
</span></span></code></pre></div><ol start="3">
<li>Create a minimal FastAPI app</li>
</ol>
<hr>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u fastapi tee /opt/fastapi/app/main.py &gt;/dev/null <span class="s">&lt;&lt;&#39;PY&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">from fastapi import FastAPI
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">app = FastAPI()
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">@app.get(&#34;/healthz&#34;)
</span></span></span><span class="line"><span class="cl"><span class="s">def healthz():
</span></span></span><span class="line"><span class="cl"><span class="s">    return {&#34;status&#34;: &#34;ok&#34;}
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">@app.get(&#34;/&#34;)
</span></span></span><span class="line"><span class="cl"><span class="s">def root():
</span></span></span><span class="line"><span class="cl"><span class="s">    return {&#34;message&#34;: &#34;Hello from FastAPI on Ubuntu 24.04!&#34;}
</span></span></span><span class="line"><span class="cl"><span class="s">PY</span>
</span></span></code></pre></div><p>Optional: quick local test</p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># IMPORTANT: Change to app directory first to avoid permission errors</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /opt/fastapi
</span></span><span class="line"><span class="cl">sudo -u fastapi /opt/fastapi/venv/bin/uvicorn app.main:app --reload --host 0.0.0.0 --port <span class="m">8000</span>
</span></span></code></pre></div><p>Visit <code>http://SERVER_IP:8000</code> to verify it works.</p>
      
        
<p><strong>Common Error Fix:</strong>
If you get <code>PermissionError: Permission denied (os error 13) about [&quot;/root&quot;]</code>, it means uvicorn is trying to watch the wrong directory. Always <code>cd /opt/fastapi</code> first before running the command.</p>
      
        
<ol start="4">
<li>Run with Gunicorn (ASGI) manually for testing</li>
</ol>
<hr>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u fastapi /opt/fastapi/venv/bin/gunicorn <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -k uvicorn.workers.UvicornWorker <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -w <span class="m">2</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -b 0.0.0.0:8000 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  app.main:app
</span></span></code></pre></div><p>If logs look healthy and port 8000 serves requests (try <code>curl http://SERVER_IP:8000/healthz</code> or <code>curl 127.0.0.1:8000/healthz</code>), proceed to the service setup.</p>
      
        
<ol start="5">
<li>Choose your process manager (pick one)</li>
</ol>
<p>You need to choose how to run your FastAPI app as a service. Pick <strong>either</strong> Option A (systemd) <strong>or</strong> Option B (PM2):</p>
      
        
<h2 id="option-a-create-a-systemd-service-for-gunicorn-recommended">Option A: Create a systemd service for Gunicorn (Recommended)</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo tee /etc/systemd/system/fastapi.service &gt;/dev/null <span class="s">&lt;&lt;&#39;SERVICE&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">[Unit]
</span></span></span><span class="line"><span class="cl"><span class="s">Description=FastAPI app with Gunicorn
</span></span></span><span class="line"><span class="cl"><span class="s">After=network.target
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">[Service]
</span></span></span><span class="line"><span class="cl"><span class="s">User=fastapi
</span></span></span><span class="line"><span class="cl"><span class="s">Group=fastapi
</span></span></span><span class="line"><span class="cl"><span class="s">WorkingDirectory=/opt/fastapi
</span></span></span><span class="line"><span class="cl"><span class="s">Environment=&#34;PATH=/opt/fastapi/venv/bin&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">ExecStart=/opt/fastapi/venv/bin/gunicorn -k uvicorn.workers.UvicornWorker -w 2 -b 0.0.0.0:8000 app.main:app
</span></span></span><span class="line"><span class="cl"><span class="s">Restart=always
</span></span></span><span class="line"><span class="cl"><span class="s">RestartSec=5
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">[Install]
</span></span></span><span class="line"><span class="cl"><span class="s">WantedBy=multi-user.target
</span></span></span><span class="line"><span class="cl"><span class="s">SERVICE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo systemctl daemon-reload
</span></span><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> --now fastapi
</span></span><span class="line"><span class="cl">sudo systemctl status fastapi --no-pager
</span></span></code></pre></div><h2 id="option-b-using-pm2-alternative-process-manager">Option B: Using PM2 (Alternative Process Manager)</h2>
<p>PM2 is great for Node.js but also works excellently with Python apps. It provides easy clustering, monitoring, and log management.</p>
      
        
<p><strong>Install PM2:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Install Node.js and PM2</span>
</span></span><span class="line"><span class="cl">curl -fsSL https://deb.nodesource.com/setup_20.x <span class="p">|</span> sudo -E bash -
</span></span><span class="line"><span class="cl">sudo apt-get install -y nodejs
</span></span><span class="line"><span class="cl">sudo npm install -g pm2
</span></span></code></pre></div><p><strong>Create PM2 ecosystem config:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u fastapi tee /opt/fastapi/ecosystem.config.js &gt;/dev/null <span class="s">&lt;&lt;&#39;JS&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">module.exports = {
</span></span></span><span class="line"><span class="cl"><span class="s">  apps: [{
</span></span></span><span class="line"><span class="cl"><span class="s">    name: &#39;fastapi-app&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    script: &#39;/opt/fastapi/venv/bin/gunicorn&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    args: &#39;-k uvicorn.workers.UvicornWorker -w 2 -b 127.0.0.1:8000 app.main:app&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    cwd: &#39;/opt/fastapi&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    instances: 1,
</span></span></span><span class="line"><span class="cl"><span class="s">    autorestart: true,
</span></span></span><span class="line"><span class="cl"><span class="s">    watch: false,
</span></span></span><span class="line"><span class="cl"><span class="s">    max_memory_restart: &#39;1G&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    env: {
</span></span></span><span class="line"><span class="cl"><span class="s">      NODE_ENV: &#39;production&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">    },
</span></span></span><span class="line"><span class="cl"><span class="s">    error_file: &#39;/opt/fastapi/logs/err.log&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    out_file: &#39;/opt/fastapi/logs/out.log&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    log_file: &#39;/opt/fastapi/logs/combined.log&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    time: true
</span></span></span><span class="line"><span class="cl"><span class="s">  }]
</span></span></span><span class="line"><span class="cl"><span class="s">}
</span></span></span><span class="line"><span class="cl"><span class="s">JS</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create logs directory</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi mkdir -p /opt/fastapi/logs
</span></span></code></pre></div><p><strong>Start with PM2:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Start the application</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 start /opt/fastapi/ecosystem.config.js
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Save PM2 process list</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 save
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Setup PM2 to start on boot</span>
</span></span><span class="line"><span class="cl">sudo env <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/usr/bin /usr/lib/node_modules/pm2/bin/pm2 startup systemd -u fastapi --hp /opt/fastapi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check status</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 status
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 logs fastapi-app
</span></span></code></pre></div><p><strong>PM2 Management Commands:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Restart app</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 restart fastapi-app
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Stop app</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 stop fastapi-app
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Monitor in real-time</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 monit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># View logs</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 logs fastapi-app --lines <span class="m">50</span>
</span></span></code></pre></div><p><strong>Systemd vs PM2 Comparison:</strong></p>
      
        
<table>
  <thead>
      <tr>
          <th>Feature</th>
          <th>Systemd</th>
          <th>PM2</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Built-in Ubuntu</td>
          <td>Yes</td>
          <td>Requires Node.js</td>
      </tr>
      <tr>
          <td>Memory usage</td>
          <td>Lower</td>
          <td>Higher (Node.js overhead)</td>
      </tr>
      <tr>
          <td>Monitoring UI</td>
          <td>Command line only</td>
          <td>pm2 monit dashboard</td>
      </tr>
      <tr>
          <td>Log management</td>
          <td>journalctl</td>
          <td>Built-in log rotation</td>
      </tr>
      <tr>
          <td>Clustering</td>
          <td>Manual setup</td>
          <td>Easy clustering</td>
      </tr>
      <tr>
          <td>Learning curve</td>
          <td>Moderate</td>
          <td>Easier</td>
      </tr>
      <tr>
          <td>Production ready</td>
          <td>Enterprise grade</td>
          <td>Battle tested</td>
      </tr>
  </tbody>
</table>
<p><strong>Choose systemd if:</strong> You want minimal overhead and native Ubuntu integration.
<strong>Choose PM2 if:</strong> You want easier monitoring, log management, and plan to scale horizontally.</p>
      
        
<p><strong>IMPORTANT:</strong> You must complete either Option A or Option B above before proceeding to Nginx setup!</p>
      
        
<ol start="6">
<li>Install and configure Nginx (reverse proxy)</li>
</ol>
<hr>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install -y nginx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo tee /etc/nginx/sites-available/example.com &gt;/dev/null <span class="s">&lt;&lt;&#39;NGINX&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">server {
</span></span></span><span class="line"><span class="cl"><span class="s">    listen 80;
</span></span></span><span class="line"><span class="cl"><span class="s">    listen [::]:80;
</span></span></span><span class="line"><span class="cl"><span class="s">    server_name example.com www.example.com;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    location / {
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_pass http://127.0.0.1:8000;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_set_header Host $host;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_set_header X-Real-IP $remote_addr;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_set_header X-Forwarded-Proto $scheme;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_read_timeout 60s;
</span></span></span><span class="line"><span class="cl"><span class="s">    }
</span></span></span><span class="line"><span class="cl"><span class="s">}
</span></span></span><span class="line"><span class="cl"><span class="s">NGINX</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo ln -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/
</span></span><span class="line"><span class="cl">sudo nginx -t <span class="o">&amp;&amp;</span> sudo systemctl reload nginx
</span></span></code></pre></div><ol start="7">
<li>Open the firewall (UFW) for HTTP/HTTPS</li>
</ol>
<hr>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo ufw allow <span class="s1">&#39;Nginx Full&#39;</span>   <span class="c1"># opens 80/tcp and 443/tcp</span>
</span></span><span class="line"><span class="cl">sudo ufw allow <span class="m">8000</span>           <span class="c1"># allow direct access to FastAPI for testing</span>
</span></span><span class="line"><span class="cl">sudo ufw status
</span></span></code></pre></div><ol start="8">
<li>Issue free HTTPS with Certbot</li>
</ol>
<hr>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install -y certbot python3-certbot-nginx
</span></span><span class="line"><span class="cl">sudo certbot --nginx -d example.com -d www.example.com
</span></span></code></pre></div><p>Certbot will configure the 443 server block and set up auto‑renewal. You can test renewal with:</p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo certbot renew --dry-run
</span></span></code></pre></div><ol start="9">
<li>Checks and monitoring</li>
</ol>
<hr>
<ul>
<li>Try: <code>curl -I https://example.com/healthz</code></li>
<li>App logs: <code>journalctl -u fastapi -f</code></li>
<li>Nginx logs: <code>/var/log/nginx/access.log</code> and <code>error.log</code></li>
</ul>
<ol start="10">
<li>Production optimizations</li>
</ol>
<hr>
<p>Add some production-ready configurations:</p>
      
        
<p><strong>Gunicorn production config:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u fastapi tee /opt/fastapi/gunicorn.conf.py &gt;/dev/null <span class="s">&lt;&lt;&#39;GUNICORN&#39;
</span></span></span><span class="line"><span class="cl"><span class="s"># Gunicorn configuration file
</span></span></span><span class="line"><span class="cl"><span class="s">bind = &#34;0.0.0.0:8000&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">worker_class = &#34;uvicorn.workers.UvicornWorker&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">workers = 2
</span></span></span><span class="line"><span class="cl"><span class="s">worker_connections = 1000
</span></span></span><span class="line"><span class="cl"><span class="s">max_requests = 1000
</span></span></span><span class="line"><span class="cl"><span class="s">max_requests_jitter = 100
</span></span></span><span class="line"><span class="cl"><span class="s">preload_app = True
</span></span></span><span class="line"><span class="cl"><span class="s">keepalive = 2
</span></span></span><span class="line"><span class="cl"><span class="s">timeout = 30
</span></span></span><span class="line"><span class="cl"><span class="s">graceful_timeout = 30
</span></span></span><span class="line"><span class="cl"><span class="s">GUNICORN</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Update systemd service to use config file</span>
</span></span><span class="line"><span class="cl">sudo sed -i <span class="s1">&#39;s|ExecStart=.*|ExecStart=/opt/fastapi/venv/bin/gunicorn -c /opt/fastapi/gunicorn.conf.py app.main:app|&#39;</span> /etc/systemd/system/fastapi.service
</span></span><span class="line"><span class="cl">sudo systemctl daemon-reload
</span></span><span class="line"><span class="cl">sudo systemctl restart fastapi
</span></span></code></pre></div><p><strong>Enhanced Nginx config with security headers:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo tee /etc/nginx/sites-available/example.com &gt;/dev/null <span class="s">&lt;&lt;&#39;NGINX&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">server {
</span></span></span><span class="line"><span class="cl"><span class="s">    listen 80;
</span></span></span><span class="line"><span class="cl"><span class="s">    listen [::]:80;
</span></span></span><span class="line"><span class="cl"><span class="s">    server_name example.com www.example.com;
</span></span></span><span class="line"><span class="cl"><span class="s">    return 301 https://$server_name$request_uri;
</span></span></span><span class="line"><span class="cl"><span class="s">}
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">server {
</span></span></span><span class="line"><span class="cl"><span class="s">    listen 443 ssl http2;
</span></span></span><span class="line"><span class="cl"><span class="s">    listen [::]:443 ssl http2;
</span></span></span><span class="line"><span class="cl"><span class="s">    server_name example.com www.example.com;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    # SSL configuration (handled by Certbot)
</span></span></span><span class="line"><span class="cl"><span class="s">    
</span></span></span><span class="line"><span class="cl"><span class="s">    # Security headers
</span></span></span><span class="line"><span class="cl"><span class="s">    add_header X-Frame-Options DENY;
</span></span></span><span class="line"><span class="cl"><span class="s">    add_header X-Content-Type-Options nosniff;
</span></span></span><span class="line"><span class="cl"><span class="s">    add_header X-XSS-Protection &#34;1; mode=block&#34;;
</span></span></span><span class="line"><span class="cl"><span class="s">    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    # Gzip compression
</span></span></span><span class="line"><span class="cl"><span class="s">    gzip on;
</span></span></span><span class="line"><span class="cl"><span class="s">    gzip_vary on;
</span></span></span><span class="line"><span class="cl"><span class="s">    gzip_types text/plain text/css application/json application/javascript text/xml application/xml;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    location / {
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_pass http://127.0.0.1:8000;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_set_header Host $host;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_set_header X-Real-IP $remote_addr;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_set_header X-Forwarded-Proto $scheme;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_read_timeout 60s;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_connect_timeout 60s;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_send_timeout 60s;
</span></span></span><span class="line"><span class="cl"><span class="s">        
</span></span></span><span class="line"><span class="cl"><span class="s">        # Buffer settings
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_buffering on;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_buffer_size 4k;
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_buffers 8 4k;
</span></span></span><span class="line"><span class="cl"><span class="s">    }
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    # Health check endpoint (no logging)
</span></span></span><span class="line"><span class="cl"><span class="s">    location /healthz {
</span></span></span><span class="line"><span class="cl"><span class="s">        proxy_pass http://127.0.0.1:8000;
</span></span></span><span class="line"><span class="cl"><span class="s">        access_log off;
</span></span></span><span class="line"><span class="cl"><span class="s">    }
</span></span></span><span class="line"><span class="cl"><span class="s">}
</span></span></span><span class="line"><span class="cl"><span class="s">NGINX</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo nginx -t <span class="o">&amp;&amp;</span> sudo systemctl reload nginx
</span></span></code></pre></div><ol start="11">
<li>Update and deployment strategies</li>
</ol>
<hr>
<p><strong>For systemd deployments:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Create deployment script</span>
</span></span><span class="line"><span class="cl">sudo tee /opt/fastapi/deploy.sh &gt;/dev/null <span class="s">&lt;&lt;&#39;DEPLOY&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="s">set -e
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">echo &#34;Starting deployment...&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s"># Pull latest code (if using git)
</span></span></span><span class="line"><span class="cl"><span class="s">cd /opt/fastapi
</span></span></span><span class="line"><span class="cl"><span class="s">sudo -u fastapi git pull origin main
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s"># Update dependencies
</span></span></span><span class="line"><span class="cl"><span class="s">sudo -u fastapi /opt/fastapi/venv/bin/pip install -r requirements.txt
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s"># Run any migrations or setup scripts here
</span></span></span><span class="line"><span class="cl"><span class="s"># sudo -u fastapi /opt/fastapi/venv/bin/python manage.py migrate
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s"># Test the app syntax
</span></span></span><span class="line"><span class="cl"><span class="s">sudo -u fastapi /opt/fastapi/venv/bin/python -c &#34;import app.main&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s"># Restart the service
</span></span></span><span class="line"><span class="cl"><span class="s">sudo systemctl restart fastapi
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s"># Wait a moment and check if it&#39;s running
</span></span></span><span class="line"><span class="cl"><span class="s">sleep 5
</span></span></span><span class="line"><span class="cl"><span class="s">sudo systemctl is-active --quiet fastapi &amp;&amp; echo &#34;Deployment successful!&#34; || echo &#34;Deployment failed!&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">echo &#34;Checking app health...&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">curl -f http://127.0.0.1:8000/healthz || echo &#34;Health check failed&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">DEPLOY</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo chmod +x /opt/fastapi/deploy.sh
</span></span></code></pre></div><p><strong>For PM2 deployments:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># PM2 deployment</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 stop fastapi-app
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /opt/fastapi
</span></span><span class="line"><span class="cl">sudo -u fastapi git pull origin main
</span></span><span class="line"><span class="cl">sudo -u fastapi /opt/fastapi/venv/bin/pip install -r requirements.txt
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 restart fastapi-app
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 save
</span></span></code></pre></div><p><strong>Zero-downtime deployment with PM2:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Update ecosystem.config.js for zero-downtime</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi tee /opt/fastapi/ecosystem.config.js &gt;/dev/null <span class="s">&lt;&lt;&#39;JS&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">module.exports = {
</span></span></span><span class="line"><span class="cl"><span class="s">  apps: [{
</span></span></span><span class="line"><span class="cl"><span class="s">    name: &#39;fastapi-app&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    script: &#39;/opt/fastapi/venv/bin/gunicorn&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    args: &#39;-c /opt/fastapi/gunicorn.conf.py app.main:app&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    cwd: &#39;/opt/fastapi&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    instances: 2,  // Multiple instances for zero-downtime
</span></span></span><span class="line"><span class="cl"><span class="s">    exec_mode: &#39;fork&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    autorestart: true,
</span></span></span><span class="line"><span class="cl"><span class="s">    watch: false,
</span></span></span><span class="line"><span class="cl"><span class="s">    max_memory_restart: &#39;1G&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s">    kill_timeout: 5000,
</span></span></span><span class="line"><span class="cl"><span class="s">    wait_ready: true,
</span></span></span><span class="line"><span class="cl"><span class="s">    listen_timeout: 10000,
</span></span></span><span class="line"><span class="cl"><span class="s">    env: {
</span></span></span><span class="line"><span class="cl"><span class="s">      NODE_ENV: &#39;production&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">    }
</span></span></span><span class="line"><span class="cl"><span class="s">  }]
</span></span></span><span class="line"><span class="cl"><span class="s">}
</span></span></span><span class="line"><span class="cl"><span class="s">JS</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Reload with zero downtime</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 reload fastapi-app
</span></span></code></pre></div><ol start="12">
<li>Monitoring and logging</li>
</ol>
<hr>
<p><strong>Basic monitoring with systemd:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Check service status</span>
</span></span><span class="line"><span class="cl">sudo systemctl status fastapi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># View logs in real-time</span>
</span></span><span class="line"><span class="cl">sudo journalctl -u fastapi -f
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check resource usage</span>
</span></span><span class="line"><span class="cl">sudo systemctl show fastapi --property<span class="o">=</span>MainPID
</span></span><span class="line"><span class="cl">ps aux <span class="p">|</span> grep <span class="k">$(</span>sudo systemctl show fastapi --property<span class="o">=</span>MainPID --value<span class="k">)</span>
</span></span></code></pre></div><p><strong>Basic monitoring with PM2:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Real-time monitoring dashboard</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 monit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check memory and CPU usage</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># View detailed process info</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 describe fastapi-app
</span></span></code></pre></div><p><strong>Log rotation setup:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># For systemd logs</span>
</span></span><span class="line"><span class="cl">sudo tee /etc/logrotate.d/fastapi &gt;/dev/null <span class="s">&lt;&lt;&#39;LOGROTATE&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">/var/log/nginx/access.log {
</span></span></span><span class="line"><span class="cl"><span class="s">    daily
</span></span></span><span class="line"><span class="cl"><span class="s">    missingok
</span></span></span><span class="line"><span class="cl"><span class="s">    rotate 30
</span></span></span><span class="line"><span class="cl"><span class="s">    compress
</span></span></span><span class="line"><span class="cl"><span class="s">    delaycompress
</span></span></span><span class="line"><span class="cl"><span class="s">    notifempty
</span></span></span><span class="line"><span class="cl"><span class="s">    create 644 www-data www-data
</span></span></span><span class="line"><span class="cl"><span class="s">    postrotate
</span></span></span><span class="line"><span class="cl"><span class="s">        sudo systemctl reload nginx &gt; /dev/null 2&gt;&amp;1
</span></span></span><span class="line"><span class="cl"><span class="s">    endscript
</span></span></span><span class="line"><span class="cl"><span class="s">}
</span></span></span><span class="line"><span class="cl"><span class="s">LOGROTATE</span>
</span></span></code></pre></div><h2 id="tips--troubleshooting">Tips &amp; troubleshooting</h2>
<p><strong>Common issues and solutions:</strong></p>
      
        
<p><strong>Permission denied error when testing uvicorn:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Wrong: This will cause permission error if run from /root</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi /opt/fastapi/venv/bin/uvicorn app.main:app --reload
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Correct: Always change directory first</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /opt/fastapi
</span></span><span class="line"><span class="cl">sudo -u fastapi /opt/fastapi/venv/bin/uvicorn app.main:app --reload --host 0.0.0.0 --port <span class="m">8000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Or run without reload flag for testing</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi /opt/fastapi/venv/bin/uvicorn app.main:app --host 0.0.0.0 --port <span class="m">8000</span>
</span></span></code></pre></div><p><strong>Root cause:</strong> Uvicorn with <code>--reload</code> tries to watch the current working directory. If you run from <code>/root</code>, the <code>fastapi</code> user cannot access it.</p>
      
        
<p><strong>502 Bad Gateway:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Check if FastAPI service is running</span>
</span></span><span class="line"><span class="cl">sudo systemctl status fastapi
</span></span><span class="line"><span class="cl"><span class="c1"># or for PM2</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 status
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check application logs</span>
</span></span><span class="line"><span class="cl">sudo journalctl -u fastapi -f --since <span class="s2">&#34;10 minutes ago&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># or for PM2</span>
</span></span><span class="line"><span class="cl">sudo -u fastapi pm2 logs fastapi-app --lines <span class="m">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Test direct connection to Gunicorn</span>
</span></span><span class="line"><span class="cl">curl -I http://127.0.0.1:8000/healthz
</span></span><span class="line"><span class="cl"><span class="c1"># Or test from outside</span>
</span></span><span class="line"><span class="cl">curl -I http://SERVER_IP:8000/healthz
</span></span></code></pre></div><p><strong>High memory usage:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Check memory consumption</span>
</span></span><span class="line"><span class="cl">sudo systemctl show fastapi --property<span class="o">=</span>MemoryCurrent
</span></span><span class="line"><span class="cl"><span class="c1"># Restart if memory is too high</span>
</span></span><span class="line"><span class="cl">sudo systemctl restart fastapi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># For PM2 - automatic restart on high memory</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Already configured with max_memory_restart: &#39;1G&#39;</span>
</span></span></code></pre></div><p><strong>Performance tuning:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Adjust workers based on CPU cores</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Rule of thumb: (2 x CPU cores) + 1</span>
</span></span><span class="line"><span class="cl">nproc  <span class="c1"># Check CPU cores</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Update gunicorn workers in config</span>
</span></span><span class="line"><span class="cl">sudo sed -i <span class="s1">&#39;s/workers = 2/workers = 3/&#39;</span> /opt/fastapi/gunicorn.conf.py
</span></span><span class="line"><span class="cl">sudo systemctl restart fastapi
</span></span></code></pre></div><p><strong>SSL certificate issues:</strong></p>
      
        
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Test certificate renewal</span>
</span></span><span class="line"><span class="cl">sudo certbot renew --dry-run
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check certificate expiry</span>
</span></span><span class="line"><span class="cl">sudo certbot certificates
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Manual renewal if needed</span>
</span></span><span class="line"><span class="cl">sudo certbot renew --force-renewal -d example.com
</span></span></code></pre></div><p><strong>Security Best Practices:</strong></p>
      
        
<ul>
<li>Non-root user (fastapi)</li>
<li>Firewall (UFW) configured</li>
<li>SSL/TLS encryption</li>
<li>Security headers in Nginx</li>
<li>No direct access to Gunicorn port</li>
<li>Consider: fail2ban, regular security updates</li>
<li>Consider: database connection encryption</li>
<li>Consider: rate limiting in Nginx</li>
</ul>
<h2 id="recommended-next-steps">Recommended next steps</h2>
<ul>
<li><strong>Monitoring</strong>: Set up Prometheus + Grafana for advanced metrics</li>
<li><strong>Backup</strong>: Database backups, SSL certificate backups</li>
<li><strong>CI/CD</strong>: GitHub Actions for automated testing and deployment</li>
<li><strong>Load balancing</strong>: Multiple app servers behind Nginx for high availability</li>
<li><strong>Caching</strong>: Redis for session storage and caching</li>
<li><strong>Database</strong>: PostgreSQL with connection pooling (SQLAlchemy + asyncpg)</li>
</ul>
<p>Related articles:</p>
      
        
<ul>
<li><a href="/2025/08/nginx-certbot-ubuntu-24-04-free-https.html">
  Nginx + Certbot on Ubuntu 24.04
</a>
 - SSL setup guide</li>
<li><a href="/2025/08/install-docker-on-ubuntu-24-04-with-compose-v2-and-rootless.html">
  Install Docker on Ubuntu 24.04
</a>
 - Containerized deployment option</li>
</ul>
<p>That&rsquo;s it! You now have a production-ready FastAPI deployment on Ubuntu 24.04 with multiple process management options (systemd vs PM2), HTTPS encryption, and comprehensive monitoring. Choose the approach that best fits your infrastructure and scaling needs. Happy coding!</p>
      
        
</p>
      
    

    
    <div class="bg-gray-100 dark:bg-gray-800 p-4 my-8 rounded">
      <h2 class="text-lg font-semibold mb-2">📌 Read Also</h2>
      
      
      
      
        
      
      
      <ul class="list-disc list-outside ml-5">
        
        <li>
          <a href="/2025/08/fastapi-tutorial-build-rest-api-from-scratch-beginner-guide.html" class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">FastAPI Tutorial Build REST API from Scratch (Beginner Guide)</a>
        </li>
        
        <li>
          <a href="/2025/08/fastapi-jwt-auth-oauth2-password-flow-pydantic-v2-sqlalchemy-2.html" class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">FastAPI JWT Auth with OAuth2 Password Flow (Pydantic v2 &#43; SQLAlchemy 2.0)</a>
        </li>
        
      </ul>
    </div>

    
    <div class="hidden lg:block">
      
<div class="my-8 py-6 border-t border-b border-gray-200 dark:border-gray-700">
  <div class="max-w-4xl mx-auto">
    
    
    <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-8 px-6 rounded-lg text-gray-500 dark:text-gray-400">
      📱 Ad placeholder: Responsive Banner (adapts to screen size)
    </div>
    
  </div>
</div>

    </div>

    
    
<div class="block lg:hidden my-8 px-2 mb-10">
  
  
  <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-4 px-6 rounded-lg text-gray-500 dark:text-gray-400">
    📱 Ad placeholder: Mobile Banner (320×100)
  </div>
  
</div>

    
    
    <div class="lg:hidden mt-8 pt-8 border-t border-gray-200 dark:border-gray-700">
      <h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Popular Posts</h3>
      <div class="grid gap-3">
        
        <a href="/2025/10/how-to-build-ai-llm-applications-in-go-openai-and-ollama-integration.html" class="block py-2 hover:text-[#0f7ea9] transition no-underline">
          <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Build AI/LLM Applications in Go - OpenAI and Ollama Integration</h4>
          <p class="text-xs text-gray-500 dark:text-gray-400">18 Oct 2025</p>
        </a>
        
        <a href="/2025/10/how-to-handle-file-uploads-in-go-validation-storage-and-security.html" class="block py-2 hover:text-[#0f7ea9] transition no-underline">
          <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Handle File Uploads in Go - Validation, Storage, and Security</h4>
          <p class="text-xs text-gray-500 dark:text-gray-400">17 Oct 2025</p>
        </a>
        
        <a href="/2025/10/how-to-implement-cicd-for-go-applications-with-github-actions.html" class="block py-2 hover:text-[#0f7ea9] transition no-underline">
          <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Implement CI/CD for Go Applications with GitHub Actions</h4>
          <p class="text-xs text-gray-500 dark:text-gray-400">17 Oct 2025</p>
        </a>
        
        <a href="/2025/10/how-to-work-with-mysql-in-go-connection-pooling-and-transactions.html" class="block py-2 hover:text-[#0f7ea9] transition no-underline">
          <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Work with MySQL in Go - Connection Pooling and Transactions Guide</h4>
          <p class="text-xs text-gray-500 dark:text-gray-400">17 Oct 2025</p>
        </a>
        
        <a href="/2025/10/how-to-use-mock-testing-in-go-with-testify-and-mockery.html" class="block py-2 hover:text-[#0f7ea9] transition no-underline">
          <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Use Mock Testing in Go with Testify and Mockery - Complete Guide</h4>
          <p class="text-xs text-gray-500 dark:text-gray-400">17 Oct 2025</p>
        </a>
        
      </div>
    </div>

    
    
<div class="my-8 py-6">
  <div class="max-w-4xl mx-auto">
    
    
    <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-12 px-6 rounded-lg text-gray-500 dark:text-gray-400">
      🔲 Ad placeholder: Multiplex (Multiple related ads)
    </div>
    
  </div>
</div>

    
    





<div class="not-prose my-12 -mx-4 sm:-mx-6 lg:mx-0">
  <div class="max-w-full">
    
    <div class="mb-8">
      <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-2">
        Frequently Asked Questions
      </h2>
      <p class="text-gray-600 dark:text-gray-400">
        Find quick answers to common questions
      </p>
    </div>

    
    <ul class="faq-list space-y-0 list-none p-0 m-0">
      
      <li
        class="faq-item border-b border-gray-200 dark:border-gray-700"
        itemscope
        itemprop="mainEntity"
        itemtype="https://schema.org/Question"
      >
        <details class="faq-details">
          <summary
            class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150"
            itemprop="name"
          >
            <h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">
              Should I use systemd or PM2 for managing my FastAPI application?
            </h3>

            
            <span class="faq-arrow flex-shrink-0 mt-1">
              <svg
                class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </span>
          </summary>

          
          <div
            class="pb-6 pt-2"
            itemscope
            itemprop="acceptedAnswer"
            itemtype="https://schema.org/Answer"
          >
            <div
              class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono"
              itemprop="text"
            >
              Use systemd if you want minimal overhead, native Ubuntu integration, and enterprise-grade process management with journald logging. Choose PM2 if you prefer easier monitoring with built-in dashboard, automatic log rotation, simpler clustering, and plan to manage multiple Node.js and Python services together. Systemd is recommended for most production deployments on Ubuntu.
            </div>
          </div>
        </details>
      </li>
      
      <li
        class="faq-item border-b border-gray-200 dark:border-gray-700"
        itemscope
        itemprop="mainEntity"
        itemtype="https://schema.org/Question"
      >
        <details class="faq-details">
          <summary
            class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150"
            itemprop="name"
          >
            <h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">
              How many Gunicorn workers should I configure?
            </h3>

            
            <span class="faq-arrow flex-shrink-0 mt-1">
              <svg
                class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </span>
          </summary>

          
          <div
            class="pb-6 pt-2"
            itemscope
            itemprop="acceptedAnswer"
            itemtype="https://schema.org/Answer"
          >
            <div
              class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono"
              itemprop="text"
            >
              The recommended formula is (2 x CPU cores) + 1. Check your CPU cores with &rsquo;nproc&rsquo; command. For example, a 2-core server should use 5 workers. Too few workers limit concurrency; too many waste memory and cause context switching overhead. Start with the formula and adjust based on your application&rsquo;s memory usage and traffic patterns.
            </div>
          </div>
        </details>
      </li>
      
      <li
        class="faq-item border-b border-gray-200 dark:border-gray-700"
        itemscope
        itemprop="mainEntity"
        itemtype="https://schema.org/Question"
      >
        <details class="faq-details">
          <summary
            class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150"
            itemprop="name"
          >
            <h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">
              Why do I get PermissionError when running uvicorn with --reload?
            </h3>

            
            <span class="faq-arrow flex-shrink-0 mt-1">
              <svg
                class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </span>
          </summary>

          
          <div
            class="pb-6 pt-2"
            itemscope
            itemprop="acceptedAnswer"
            itemtype="https://schema.org/Answer"
          >
            <div
              class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono"
              itemprop="text"
            >
              Uvicorn with &ndash;reload flag tries to watch the current working directory. If you run from /root or another directory the fastapi user cannot access, you&rsquo;ll get permission errors. Always cd /opt/fastapi first before running uvicorn, or run without the &ndash;reload flag for testing. In production with systemd, this isn&rsquo;t an issue since WorkingDirectory is properly set.
            </div>
          </div>
        </details>
      </li>
      
      <li
        class="faq-item border-b border-gray-200 dark:border-gray-700"
        itemscope
        itemprop="mainEntity"
        itemtype="https://schema.org/Question"
      >
        <details class="faq-details">
          <summary
            class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150"
            itemprop="name"
          >
            <h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">
              How do I troubleshoot 502 Bad Gateway errors?
            </h3>

            
            <span class="faq-arrow flex-shrink-0 mt-1">
              <svg
                class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </span>
          </summary>

          
          <div
            class="pb-6 pt-2"
            itemscope
            itemprop="acceptedAnswer"
            itemtype="https://schema.org/Answer"
          >
            <div
              class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono"
              itemprop="text"
            >
              Check if FastAPI is running with &lsquo;sudo systemctl status fastapi&rsquo; or &lsquo;sudo -u fastapi pm2 status&rsquo;. Test direct connection to Gunicorn with &lsquo;curl http://127.0.0.1:8000/healthz&rsquo;. Check application logs with &lsquo;sudo journalctl -u fastapi -f&rsquo; or &lsquo;sudo -u fastapi pm2 logs&rsquo;. Verify Nginx configuration with &lsquo;sudo nginx -t&rsquo;. Common causes include crashed application, wrong proxy_pass port, or firewall blocking local connections.
            </div>
          </div>
        </details>
      </li>
      
      <li
        class="faq-item border-b border-gray-200 dark:border-gray-700"
        itemscope
        itemprop="mainEntity"
        itemtype="https://schema.org/Question"
      >
        <details class="faq-details">
          <summary
            class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150"
            itemprop="name"
          >
            <h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">
              How often does Certbot auto-renew SSL certificates?
            </h3>

            
            <span class="faq-arrow flex-shrink-0 mt-1">
              <svg
                class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </span>
          </summary>

          
          <div
            class="pb-6 pt-2"
            itemscope
            itemprop="acceptedAnswer"
            itemtype="https://schema.org/Answer"
          >
            <div
              class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono"
              itemprop="text"
            >
              Certbot automatically checks for renewal twice daily and renews certificates that expire within 30 days. Let&rsquo;s Encrypt certificates are valid for 90 days. Test automatic renewal with &lsquo;sudo certbot renew &ndash;dry-run&rsquo;. The systemd timer /etc/systemd/system/certbot.timer handles automatic renewal. You can also manually renew with &lsquo;sudo certbot renew &ndash;force-renewal&rsquo; if needed.
            </div>
          </div>
        </details>
      </li>
      
      <li
        class="faq-item border-b border-gray-200 dark:border-gray-700"
        itemscope
        itemprop="mainEntity"
        itemtype="https://schema.org/Question"
      >
        <details class="faq-details">
          <summary
            class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150"
            itemprop="name"
          >
            <h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">
              What is the difference between Gunicorn and Uvicorn?
            </h3>

            
            <span class="faq-arrow flex-shrink-0 mt-1">
              <svg
                class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </span>
          </summary>

          
          <div
            class="pb-6 pt-2"
            itemscope
            itemprop="acceptedAnswer"
            itemtype="https://schema.org/Answer"
          >
            <div
              class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono"
              itemprop="text"
            >
              Uvicorn is an ASGI server that runs FastAPI applications directly and handles async/await. Gunicorn is a production-grade process manager that can spawn multiple Uvicorn workers for load balancing and zero-downtime reloads. In production, use Gunicorn with UvicornWorker (gunicorn -k uvicorn.workers.UvicornWorker) to get the best of both: Uvicorn&rsquo;s async capabilities with Gunicorn&rsquo;s process management.
            </div>
          </div>
        </details>
      </li>
      
    </ul>
  </div>
</div>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    
    
    {
      "@type": "Question",
      "name": "\"Should I use systemd or PM2 for managing my FastAPI application?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Use systemd if you want minimal overhead, native Ubuntu integration, and enterprise-grade process management with journald logging. Choose PM2 if you prefer easier monitoring with built-in dashboard, automatic log rotation, simpler clustering, and plan to manage multiple Node.js and Python services together. Systemd is recommended for most production deployments on Ubuntu.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"How many Gunicorn workers should I configure?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"The recommended formula is (2 x CPU cores) + 1. Check your CPU cores with 'nproc' command. For example, a 2-core server should use 5 workers. Too few workers limit concurrency; too many waste memory and cause context switching overhead. Start with the formula and adjust based on your application's memory usage and traffic patterns.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"Why do I get PermissionError when running uvicorn with --reload?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Uvicorn with --reload flag tries to watch the current working directory. If you run from /root or another directory the fastapi user cannot access, you'll get permission errors. Always cd /opt/fastapi first before running uvicorn, or run without the --reload flag for testing. In production with systemd, this isn't an issue since WorkingDirectory is properly set.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"How do I troubleshoot 502 Bad Gateway errors?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Check if FastAPI is running with 'sudo systemctl status fastapi' or 'sudo -u fastapi pm2 status'. Test direct connection to Gunicorn with 'curl http://127.0.0.1:8000/healthz'. Check application logs with 'sudo journalctl -u fastapi -f' or 'sudo -u fastapi pm2 logs'. Verify Nginx configuration with 'sudo nginx -t'. Common causes include crashed application, wrong proxy_pass port, or firewall blocking local connections.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"How often does Certbot auto-renew SSL certificates?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Certbot automatically checks for renewal twice daily and renews certificates that expire within 30 days. Let's Encrypt certificates are valid for 90 days. Test automatic renewal with 'sudo certbot renew --dry-run'. The systemd timer /etc/systemd/system/certbot.timer handles automatic renewal. You can also manually renew with 'sudo certbot renew --force-renewal' if needed.\""
      }
    }
    
    ,
    {
      "@type": "Question",
      "name": "\"What is the difference between Gunicorn and Uvicorn?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Uvicorn is an ASGI server that runs FastAPI applications directly and handles async/await. Gunicorn is a production-grade process manager that can spawn multiple Uvicorn workers for load balancing and zero-downtime reloads. In production, use Gunicorn with UvicornWorker (gunicorn -k uvicorn.workers.UvicornWorker) to get the best of both: Uvicorn's async capabilities with Gunicorn's process management.\""
      }
    }
    
  ]
}
</script>


<style>
  details.faq-details[open] .faq-arrow svg {
    transform: rotate(180deg);
  }
</style>


<script>
  document.addEventListener('DOMContentLoaded', function() {
    const faqItems = document.querySelectorAll('.faq-item');

    faqItems.forEach(function(item) {
      item.addEventListener('toggle', function() {
        if (this.open) {
          
          faqItems.forEach(function(otherItem) {
            if (otherItem !== item && otherItem.open) {
              otherItem.open = false;
            }
          });
        }
      });
    });
  });
</script>




  </article>



  
  <aside class="space-y-10 hidden lg:block">
    
    <div>
      <h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Popular Posts</h3>
      <ul
        class="space-y-3 list-disc list-outside pl-5 text-sm text-gray-800 dark:text-gray-200"
      >
        
        <li>
          <a href="/2025/10/how-to-build-ai-llm-applications-in-go-openai-and-ollama-integration.html" class="hover:text-[#0f7ea9] transition">How to Build AI/LLM Applications in Go - OpenAI and Ollama Integration</a>
        </li>
        
        <li>
          <a href="/2025/10/how-to-handle-file-uploads-in-go-validation-storage-and-security.html" class="hover:text-[#0f7ea9] transition">How to Handle File Uploads in Go - Validation, Storage, and Security</a>
        </li>
        
        <li>
          <a href="/2025/10/how-to-implement-cicd-for-go-applications-with-github-actions.html" class="hover:text-[#0f7ea9] transition">How to Implement CI/CD for Go Applications with GitHub Actions</a>
        </li>
        
        <li>
          <a href="/2025/10/how-to-work-with-mysql-in-go-connection-pooling-and-transactions.html" class="hover:text-[#0f7ea9] transition">How to Work with MySQL in Go - Connection Pooling and Transactions Guide</a>
        </li>
        
        <li>
          <a href="/2025/10/how-to-use-mock-testing-in-go-with-testify-and-mockery.html" class="hover:text-[#0f7ea9] transition">How to Use Mock Testing in Go with Testify and Mockery - Complete Guide</a>
        </li>
        
      </ul>
    </div>

    
  </aside>
</div>


<section id="comments" class="mt-12">
  <script
    src="https://giscus.app/client.js"
    data-repo="wikukarno/buanacoding"
    data-repo-id="R_kgD0Oj4jAw"
    data-category="General"
    data-category-id="DIC_kwD0Oj4jA84Cr_fx"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async
  ></script>
</section>





      </div>
    </main>

    

<div class="py-6">
  <div class="max-w-7xl mx-auto px-4">
    
    
    <div class="border border-dashed border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center text-xs py-8 px-4 rounded text-gray-500 dark:text-gray-400">
      <div class="text-lg mb-2">📱</div>
      <div>Ad placeholder: Footer Banner</div>
      <div class="text-xs opacity-70 mt-1">Responsive (300×250 desktop, 320×50 mobile)</div>
    </div>
    
  </div>
</div>


<div class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-white py-4 transition-colors duration-300">
  <div class="text-center space-x-4 text-sm font-medium">
    <a href="/about" class="hover:text-cyan-500 dark:hover:text-cyan-400">About</a>
    <span>-</span>
    <a href="/contact" class="hover:text-cyan-500 dark:hover:text-cyan-400">Contact</a>
    <span>-</span>
    <a href="/privacy-policy" class="hover:text-cyan-500 dark:hover:text-cyan-400">Privacy Policy</a>
    <span>-</span>
    <a href="/disclaimer" class="hover:text-cyan-500 dark:hover:text-cyan-400">Disclaimer</a>
  </div>
</div>


<footer class="text-center text-sm text-gray-500 dark:text-gray-400 py-4 border-t border-gray-200 dark:border-gray-700">
  &copy; 2025 buanacoding.com
</footer>



    
<button
  id="scrollToTop"
  class="fixed bottom-6 right-6 lg:bottom-6 lg:right-6 bg-[#0f7ea9] hover:bg-cyan-600 text-white p-3 rounded-full shadow transition duration-300 z-50"
  aria-label="Scroll to top"
>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    fill="none"
    class="w-4 h-4"
    viewBox="0 0 24 24"
    stroke="currentColor"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M5 15l7-7 7 7"
    />
  </svg>
</button>

<style>
 
body.floating-ad-active #scrollToTop {
  bottom: 100px !important;  
}

@media (min-width: 1024px) {
  body.floating-ad-active #scrollToTop {
    bottom: 1.5rem !important;  
  }
}
</style>


    

    <div id="google_translate_element" style="display:none"></div>
<script src="https://unpkg.com/feather-icons"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6"></script>

<script>
  feather.replace();
  const btn = document.getElementById("scrollToTop");
  const html = document.documentElement;
  const toggleBtn = document.getElementById("theme-toggle");
  const toggleBtnMobile = document.getElementById("theme-toggle-mobile");
  const iconSun = document.getElementById("icon-sun");
  const iconMoon = document.getElementById("icon-moon");
  const iconSunMobile = document.getElementById("icon-sun-mobile");
  const iconMoonMobile = document.getElementById("icon-moon-mobile");

  document.getElementById("menu-toggle")?.addEventListener("click", () => {
    document.getElementById("mobile-menu")?.classList.toggle("hidden");
  });

  btn.style.display = "none";

  window.addEventListener("scroll", () => {
    if (window.scrollY > 300) {
      btn.style.display = "flex";
    } else {
      btn.style.display = "none";
    }
  });

  btn.addEventListener("click", () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  function updateIcons(isDark) {
    iconSun.classList.toggle("hidden", !isDark);
    iconMoon.classList.toggle("hidden", isDark);
    iconSunMobile.classList.toggle("hidden", !isDark);
    iconMoonMobile.classList.toggle("hidden", isDark);
  }

  function setDarkMode(isDark) {
    html.setAttribute("data-theme", isDark ? "dark" : "light");
    localStorage.setItem("theme", isDark ? "dark" : "light");
    updateIcons(isDark);
  }

  const userPref = localStorage.getItem("theme");
  const systemPref = window.matchMedia("(prefers-color-scheme: dark)").matches;
  const isDark = userPref === "dark" || (!userPref && systemPref);
  setDarkMode(isDark);

  toggleBtn?.addEventListener("click", () => {
    const currentlyDark = html.getAttribute("data-theme") === "dark";
    setDarkMode(!currentlyDark);
  });
  toggleBtnMobile?.addEventListener("click", () => {
    const currentlyDark = html.getAttribute("data-theme") === "dark";
    setDarkMode(!currentlyDark);
  });

  document.querySelectorAll("pre").forEach((pre) => {
    const button = document.createElement("button");
    button.innerHTML = `
      <span>Copy</span>
    `;
    button.className = `
    copy-btn absolute top-2 right-2
    text-xs px-2 py-1 rounded flex items-center gap-1
    transition-colors duration-200
    bg-gray-200 text-gray-800 hover:bg-gray-300
    dark:bg-white/10 dark:text-white dark:hover:bg-white/20
  `.trim();

    const wrapper = document.createElement("div");
    wrapper.className = "relative";
    pre.parentNode.insertBefore(wrapper, pre);
    wrapper.appendChild(pre);
    wrapper.appendChild(button);

    button.addEventListener("click", () => {
      const code = pre.innerText;
      navigator.clipboard.writeText(code).then(() => {
        button.querySelector("span").innerText = "Copied!";
        setTimeout(() => {
          button.querySelector("span").innerText = "Copy";
        }, 2000);
      });
    });
  });

  const openBtn = document.getElementById("openSearchModal");
  const closeBtn = document.getElementById("closeSearchModal");
  const modal = document.getElementById("searchModal");

  openBtn.addEventListener("click", () => {
    console.log("Search modal opened");
    modal.classList.remove("hidden");
    document.getElementById("searchBox").focus();
  });

  closeBtn.addEventListener("click", () => {
    modal.classList.add("hidden");
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") modal.classList.add("hidden");
  });

  fetch("/index.json")
    .then((res) => res.json())
    .then((data) => {
      const fuse = new Fuse(data, {
        keys: ["title", "content"],
        threshold: 0.3,
      });

      const searchBox = document.getElementById("searchBox");
      const resultBox = document.getElementById("results");

      searchBox.addEventListener("input", function (e) {
        const query = e.target.value.trim();
        const searchAdBanner = document.getElementById("searchAdBanner");
        
        if (query.length < 2) {
          resultBox.innerHTML = "";
          
          if (searchAdBanner) {
            searchAdBanner.classList.remove("show");
            searchAdBanner.classList.add("hide");
            setTimeout(() => searchAdBanner.style.display = "none", 300);
          }
          return;
        }

        
        if (searchAdBanner) {
          searchAdBanner.style.display = "block";
          searchAdBanner.classList.remove("hide");
          searchAdBanner.classList.add("show");
        }

        const results = fuse.search(query);
        if (results.length === 0) {
          resultBox.innerHTML = `
            <li class='px-4 py-3 text-center text-gray-500 dark:text-gray-400'>
              <div class="mb-2">📄 No results found for "${query}"</div>
              <div class="text-xs">Try different keywords or browse categories below</div>
            </li>
          `;
        } else {
          
          let resultHTML = "";
          results.forEach((r, index) => {
            resultHTML += `
              <li class="px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition">
                <a href="${r.item.href}" class="block font-semibold text-gray-900 dark:text-white no-underline">${r.item.title}</a>
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${r.item.content.substring(0, 100)}...</p>
              </li>
            `;
            
            
            if ((index + 1) % 3 === 0 && index < results.length - 1) {
              resultHTML += `
                <li class="px-4 py-2 bg-blue-50 dark:bg-gray-800 border-l-4 border-blue-400">
                  <div class="text-xs text-blue-600 dark:text-blue-400 font-medium">📚 More related articles</div>
                </li>
              `;
            }
          });
          
          resultBox.innerHTML = resultHTML;
        }
      });
    });

    const openBtnMobile = document.getElementById("openSearchModalMobile");
    const closeBtnMobile = document.getElementById("closeSearchModal");
    const modalMobile = document.getElementById("searchModal");

    openBtnMobile.addEventListener("click", () => {
      console.log("Search modal opened (mobile)");
      modalMobile.classList.remove("hidden");
      document.getElementById("searchBox").focus();
    });
    closeBtnMobile.addEventListener("click", () => {
      modalMobile.classList.add("hidden");
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") modalMobile.classList.add("hidden");
    });

  
  (function () {
    function loadGoogleTranslate(cb, onfail) {
      if (window.google && window.google.translate && window.google.translate.TranslateElement) {
        cb && cb();
        return;
      }
      window.__gtReadyCallbacks = window.__gtReadyCallbacks || [];
      if (cb) window.__gtReadyCallbacks.push(cb);
      if (window.__gtLoading) return;
      window.__gtLoading = true;
      window.initGoogleTranslate = function () {
        try {
          new window.google.translate.TranslateElement({
            pageLanguage: 'en',
            includedLanguages: 'id',
            autoDisplay: false,
          }, 'google_translate_element');
        } catch (e) {}
        (window.__gtReadyCallbacks || []).forEach(function (fn) { try { fn(); } catch (e) {} });
        window.__gtReadyCallbacks = [];
      };
      var s = document.createElement('script');
      s.src = 'https://translate.google.com/translate_a/element.js?cb=initGoogleTranslate';
      s.defer = true;
      var failed = false;
      s.onerror = function(){ failed = true; onfail && onfail(); };
      setTimeout(function(){ if(!window.google || !window.google.translate){ failed = true; onfail && onfail(); } }, 4000);
      document.head.appendChild(s);
    }

    function setCookie(name, value) {
      document.cookie = name + '=' + value + '; path=/; expires=' + new Date(Date.now() + 365*24*3600*1000).toUTCString();
    }
    function deleteCookie(name) {
      document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/';
    }

    function showTranslateFallback() {
      if (document.getElementById('translate-fallback')) return;
      var bar = document.createElement('div');
      bar.id = 'translate-fallback';
      bar.style.cssText = 'position:fixed;bottom:12px;left:50%;transform:translateX(-50%);z-index:9999;background:#111827;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 4px 16px rgba(0,0,0,0.25);display:flex;gap:10px;align-items:center;';
      bar.innerHTML = '<span style="font-size:13px">Auto-translate tidak tersedia di perangkat ini.</span>' +
        '<button id="btnTryId" style="background:#0ea5e9;color:#fff;border:none;padding:6px 10px;border-radius:8px;font-size:12px">Coba versi Indonesia</button>' +
        '<button id="btnCloseTf" style="background:transparent;color:#fff;border:1px solid #fff3;padding:6px 10px;border-radius:8px;font-size:12px">Tutup</button>';
      document.body.appendChild(bar);
      document.getElementById('btnCloseTf').onclick = function(){ bar.remove(); };
      document.getElementById('btnTryId').onclick = function(){
        var idUrl = new URL(location.href);
        var p = location.pathname;
        if (!p.startsWith('/id/')) {
          idUrl.pathname = '/id' + (p.startsWith('/') ? p : '/' + p);
        }
        fetch(idUrl, { method: 'HEAD' }).then(function(r){
          if (r.ok) location.href = idUrl; else location.href = '/id/';
        }).catch(function(){ location.href = '/id/'; });
      };
    }

    function translateTo(lang) {
      loadGoogleTranslate(function () {
        var combo = document.querySelector('.goog-te-combo');
        if (combo) {
          combo.value = lang;
          combo.dispatchEvent(new Event('change'));
        } else {
          
          setCookie('googtrans', '/en/' + lang);
          location.reload();
        }
      }, showTranslateFallback);
    }

    function resetTranslate() {
      deleteCookie('googtrans');
      deleteCookie('GOOGTRANS');
    }

    document.querySelectorAll('.js-lang-link').forEach(function (a) {
      a.addEventListener('click', function (e) {
        var lang = a.getAttribute('data-lang');
        var has = a.getAttribute('data-has-trans') === 'true';
        if (lang === 'en') {
          resetTranslate();
          return; 
        }
        if (!has) {
          e.preventDefault();
          translateTo(lang);
        }
      });
    });
  })();
</script>

    
  </body>
</html>
