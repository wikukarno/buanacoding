<!doctype html><html lang=en data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Complete Production Security Guide | Buana Coding</title><meta name=description content="Complete Laravel security best practices guide for production. How to secure Laravel applications from various security risks and vulnerabilities."><meta name=keywords content="coding,programming,web development,app development,tutorial,developer tips"><link rel=canonical href=https://www.buanacoding.com/2025/09/laravel-security-best-practices-production.html><link rel=alternate hreflang=en href=https://www.buanacoding.com/2025/09/laravel-security-best-practices-production.html><meta property="og:type" content="article"><meta property="og:title" content="Complete Production Security Guide | Buana Coding"><meta property="og:description" content="Complete Laravel security best practices guide for production. How to secure Laravel applications from various security risks and vulnerabilities."><meta property="og:url" content="https://www.buanacoding.com/2025/09/laravel-security-best-practices-production.html"><meta property="og:image" content="https://www.buanacoding.com/images/og-image.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Complete Production Security Guide | Buana Coding"><meta name=twitter:description content="Complete Laravel security best practices guide for production. How to secure Laravel applications from various security risks and vulnerabilities."><meta name=twitter:image content="https://www.buanacoding.com/images/og-image.jpg"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Complete Production Security Guide | Buana Coding","description":"Complete Laravel security best practices guide for production. How to secure Laravel applications from various security risks and vulnerabilities.","inLanguage":"en","datePublished":"2025-09-08T12:15:00\u002b07:00","dateModified":"2025-09-08T12:15:00\u002b07:00","author":{"@type":"Person","name":"Wiku Karno"},"mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.buanacoding.com\/2025\/09\/laravel-security-best-practices-production.html"},"image":"https:\/\/www.buanacoding.com\/images\/og-image.jpg","publisher":{"@type":"Organization","name":"Buana Coding"}}</script><link rel=icon href=/favicon.ico type=image/x-icon><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel=stylesheet><link rel=stylesheet href="/style.css?v=1760918135"><link rel=stylesheet href="/css/overrides.css?v=1760918135"><link rel=stylesheet href="/css/syntax.css?v=1760918135"><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("consent","default",{ad_storage:"granted",ad_user_data:"granted",ad_personalization:"granted",analytics_storage:"granted"})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-0EN9J73FXF"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0EN9J73FXF")</script><script async src="https://fundingchoicesmessages.google.com/i/pub-3149036684216973?ers=1"></script><script>(function(){function e(){if(!window.frames.googlefcPresent)if(document.body){const e=document.createElement("iframe");e.style="width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;",e.style.display="none",e.name="googlefcPresent",document.body.appendChild(e)}else setTimeout(e,0)}e()})()</script><script>(function(){"use strict";function at(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}Z=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype?e:(e[t]=n.value,e)};function Ge(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t,n=0;n<e.length;++n)if(t=e[n],t&&t.Math==Math)return t;throw Error("Cannot find global object")}Pe=Ge(this);function c(e,t){if(t)a:{var n,o,s=Pe;e=e.split(".");for(n=0;n<e.length-1;n++){if(o=e[n],!(o in s))break a;s=s[o]}e=e[e.length-1],n=s[e],t=t(n),t!=n&&t!=null&&Z(s,e,{configurable:!0,writable:!0,value:t})}}function G(e){return e.raw=e}function b(e){var t=typeof Symbol!="undefined"&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if(typeof e.length=="number")return{next:at(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}function Xe(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}if(Se=typeof Object.create=="function"?Object.create:function(e){function t(){}return t.prototype=e,new t},typeof Object.setPrototypeOf=="function")R=Object.setPrototypeOf;else{a:{we={a:!0},V={};try{V.__proto__=we,P=V.a;break a}catch{}P=!1}R=P?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}W=R;function K(e,t){if(e.prototype=Se(t.prototype),e.prototype.constructor=e,W)W(e,t);else for(n in t)if(n!="prototype")if(Object.defineProperties){var n,s=Object.getOwnPropertyDescriptor(t,n);s&&Object.defineProperty(e,n,s)}else e[n]=t[n];e.A=t.prototype}function Q(){for(var t=Number(this),n=[],e=t;e<arguments.length;e++)n[e-t]=arguments[e];return n}c("Object.is",function(e){return e||function(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}}),c("Array.prototype.includes",function(e){return e||function(e,t){var s,o,n=this;n instanceof String&&(n=String(n)),s=n.length,t=t||0;for(t<0&&(t=Math.max(t+s,0));t<s;t++)if(o=n[t],o===e||Object.is(o,e))return!0;return!1}}),c("String.prototype.includes",function(e){return e||function(e,t){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(e,t||0)!==-1}}),c("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991}),c("Number.isFinite",function(e){return e||function(e){return typeof e=="number"&&!isNaN(e)&&e!==1/0&&e!==-(1/0)}}),c("Number.isInteger",function(e){return e||function(e){return!!Number.isFinite(e)&&e===Math.floor(e)}}),c("Number.isSafeInteger",function(e){return e||function(e){return Number.isInteger(e)&&(e<0?-e:e)<=Number.MAX_SAFE_INTEGER}}),c("Math.trunc",function(e){return e||function(e){if(e=Number(e),isNaN(e)||e===1/0||e===-(1/0)||e===0)return e;var t=Math.floor(e<0?-e:e);return e<0?-t:t}}),e=this||self;function _(t,n){a:{for(var s=["CLOSURE_FLAGS"],o=e,i=0;i<s.length;i++)if(o=o[s[i]],o==null){s=null;break a}s=o}return t=s&&s[t],t??n}function q(e){return e}function ct(t){e.setTimeout(function(){throw t},0)}var ae=_(610401301,!1),ot=_(188588736,!0),et=_(645172343,_(1,!0)),Oe=e.navigator,O=Oe?Oe.userAgentData||null:null;function L(e){return!!ae&&!!O&&O.brands.some(function(t){return(t=t.brand)&&t.indexOf(e)!=-1})}function s(t){var n;a:{if((n=e.navigator)&&(n=n.userAgent))break a;n=""}return n.indexOf(t)!=-1}function r(){return!!ae&&!!O&&O.brands.length>0}function F(){return r()?L("Chromium"):(s("Chrome")||s("CriOS"))&&!(r()?0:s("Edge"))||s("Silk")}be=!r()&&(s("Trident")||s("MSIE")),!s("Android")||F(),F(),s("Safari")&&(F()||(r()?0:s("Coast"))||(r()?0:s("Opera"))||(r()?0:s("Edge"))||(r()?L("Microsoft Edge"):s("Edg/"))||r()&&L("Opera")),M={},v=null,T=typeof Uint8Array!="undefined",He=!be&&typeof btoa=="function";function N(){return typeof BigInt=="function"}g=typeof Symbol=="function"&&typeof Symbol()=="symbol";function xe(e){return typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():e}var Z,Pe,Se,t,R,P,we,e,n,O,V,W,be,v,M,T,He,Te,m,g,X,oe,C,E,Ae,j,Fe,le,re,ie,x=xe(),H=xe("2ex"),ye=g?function(e,t){e[x]|=t}:function(e,t){e.g!==0[0]?e.g|=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}})},h=g?function(e){return e[x]|0}:function(e){return e.g|0},d=g?function(e){return e[x]}:function(e){return e.g},l=g?function(e,t){e[x]=t}:function(e,t){e.g!==0[0]?e.g=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}})};function it(e,t){l(t,(e|0)&-14591)}function U(e,t){l(t,(e|34)&-14557)}m={},X={};function Ie(e){return!(!e||typeof e!="object"||e.g!==X)}function S(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function y(e,t,n){if(!Array.isArray(e)||e.length)return!1;var s=h(e);return!!(s&1)||!!(t&&(Array.isArray(t)?t.includes(n):t.has(n)))&&(l(e,s|1),!0)}t=0,n=0;function J(e){var s=e>>>0;t=s,n=(e-s)/4294967296>>>0}function ee(e){if(e<0){J(-e);var s=b(A(t,n));e=s.next().value,s=s.next().value,t=e>>>0,n=s>>>0}else J(e)}function te(e,t){if(t>>>=0,e>>>=0,t<=2097151)var n=""+(4294967296*t+e);else N()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(n=(e>>>24|t<<8)&16777215,t=t>>16&65535,e=(e&16777215)+n*6777216+t*6710656,n+=t*8147497,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+ne(n)+ne(e));return n}function ne(e){return e=String(e),"0000000".slice(e.length)+e}function A(e,t){return t=~t,e?e=~e+1:t+=1,[e,t]}oe=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function $(e,t){return E=t,e=new e(t),E=0[0],e}function k(e,t,n){if(e==null&&(e=E),E=0[0],e==null){var o,i,s=96;n?(e=[n],s|=512):e=[],t&&(s=s&-16760833|(t&1023)<<14)}else{if(!Array.isArray(e))throw Error("narr");if(s=h(e),s&2048)throw Error("farr");if(s&64)return e;if(s|=64,n&&(s|=512,n!==e[0]))throw Error("mid");a:{if(n=e,o=n.length,o&&(i=o-1,S(n[i]))){if(s|=256,t=i-(+!!(s&512)-1),t>=1024)throw Error("pvtlmt");s=s&-16760833|(t&1023)<<14;break a}if(t){if(t=Math.max(t,o-(+!!(s&512)-1)),t>1024)throw Error("spvt");s=s&-16760833|(t&1023)<<14}}}return l(e,s),e}function st(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"boolean":return e?1:0;case"object":if(e)if(Array.isArray(e)){if(y(e,0[0],0))return}else if(T&&e!=null&&e instanceof Uint8Array){if(He){for(var n,o,i,a,c,l,t="",s=0,r=e.length-10240;s<r;)t+=String.fromCharCode.apply(null,e.subarray(s,s+=10240));t+=String.fromCharCode.apply(null,s?e.subarray(s):e),e=btoa(t)}else{if(t===0[0]&&(t=0),!v){v={},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),r=["+/=","+/","-_=","-_.","-_"];for(a=0;a<5;a++){n=s.concat(r[a].split("")),M[a]=n;for(o=0;o<n.length;o++)i=n[o],v[i]===0[0]&&(v[i]=o)}}t=M[t],s=Array(Math.floor(e.length/3)),r=t[64]||"";for(a=n=0;n<e.length-2;n+=3)c=e[n],l=e[n+1],i=e[n+2],o=t[c>>2],c=t[(c&3)<<4|l>>4],l=t[(l&15)<<2|i>>6],i=t[i&63],s[a++]=o+c+l+i;switch(o=0,i=r,e.length-n){case 2:o=e[n+1],i=t[(o&15)<<2]||r;case 1:e=e[n],s[a]=t[e>>2]+t[(e&3)<<4|o>>4]+i+r}e=s.join("")}return e}}return e}function nt(e,t,n){e=Array.prototype.slice.call(e);var i,o=e.length,s=t&256?e[o-1]:0[0];o+=s?-1:0;for(t=t&512?1:0;t<o;t++)e[t]=n(e[t]);if(s){t=e[t]={};for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=n(s[i]))}return e}function de(e,t,n,s,o){if(e!=null){if(Array.isArray(e))e=y(e,0[0],0)?0[0]:o&&h(e)&2?e:B(e,t,n,s!==0[0],o);else if(S(e)){var i,a={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=de(e[i],t,n,s,o));e=a}else e=t(e,s);return e}}function B(e,t,n,s,o){var i,a=s||n?h(e):0;s=s?!!(a&32):0[0],e=Array.prototype.slice.call(e);for(i=0;i<e.length;i++)e[i]=de(e[i],t,n,s,o);return n&&n(a,e),e}function We(e){return e.s===m?e.toJSON():st(e)}function me(e,t,n){if(n=n===0[0]?U:n,e!=null){if(T&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var s=h(e);return s&2?e:(t&&(t=s===0||!!(s&32)&&!(s&64||!(s&16))),t?(l(e,(s|34)&-12293),e):B(e,me,s&4?U:n,!0,!0))}return e.s===m&&(n=e.h,s=d(n),e=s&2?e:$(e.constructor,fe(n,s,!0))),e}}function fe(e,t,n){var s=n||t&2?U:it,o=!!(t&32);return e=nt(e,t,function(e){return me(e,o,s)}),ye(e,32|(n?2:0)),e}function pe(e,t){return e=e.h,ve(e,d(e),t)}function ge(e,t,n,s){if(t=s+(+!!(t&512)-1),!(t<0||t>=e.length||t>=n))return e[t]}function ve(e,t,n,s){if(n===-1)return null;var o,a,i=t>>14&1023||536870912;if(n>=i){if(t&256)return e[e.length-1][n]}else return a=e.length,s&&t&256&&(s=e[a-1][n],s!=null)?(ge(e,t,i,n)&&H!=null&&(e=(o=Te)!=null?o:Te={},o=e[H]||0,o>=4||(e[H]=o+1,o=Error(),o.__closure__error__context__984382||(o.__closure__error__context__984382={}),o.__closure__error__context__984382.severity="incident",ct(o))),s):ge(e,t,i,n)}function Y(e,t,n,s,o){var i,a=t>>14&1023||536870912;if(n>=a||o&&!et){if(i=t,t&256)o=e[e.length-1];else{if(s==null)return;o=e[a+(+!!(t&512)-1)]={},i|=256}o[n]=s,n<a&&(e[n+(+!!(t&512)-1)]=0[0]),i!==t&&l(e,i)}else e[n+(+!!(t&512)-1)]=s,t&256&&(e=e[e.length-1],n in e&&delete e[n])}function je(e,t){var a,r,s=he,c=c!==0[0]&&c,o=e.h,i=d(o),n=ve(o,i,t,c);return n!=null&&typeof n=="object"&&n.s===m?s=n:Array.isArray(n)?(a=h(n),r=a,r===0&&(r|=i&32),r|=i&2,r!==a&&l(n,r),s=new s(n)):s=0[0],s!==n&&s!=null&&Y(o,i,t,s,c),o=s,o==null?o:(e=e.h,i=d(e),i&2||(n=o,s=n.h,a=d(s),n=a&2?$(n.constructor,fe(s,a,!1)):n,n!==o&&(o=n,Y(e,i,t,o,c))),o)}function I(e,t){return e=pe(e,t),e==null||typeof e=="string"?e:0[0]}function _e(e,s){if(i=i===0[0]?0:i,e=pe(e,s),e!=null)if(s=typeof e,s==="number"?Number.isFinite(e):s!=="string"?0:oe.test(e)){if(typeof e=="number")e=e|0,!Number.isSafeInteger(e)&&(ee(e),s=t,o=n,(e=o&2147483648)&&(s=~s+1>>>0,o=~o>>>0,s==0&&(o=o+1>>>0)),s=o*4294967296+(s>>>0),e=e?-s:s);else if(s=Number(e)|0,Number.isSafeInteger(s))e=String(s);else if(s=e.indexOf("."),s!==-1&&(e=e.substring(0,s)),!(e[0]==="-"?e.length<20||e.length===20&&Number(e.substring(0,7))>-922337:e.length<19||e.length===19&&Number(e.substring(0,6))<922337)){if(e.length<16)ee(Number(e));else if(N())e=BigInt(e),t=Number(e&BigInt(4294967295))>>>0,n=Number(e>>BigInt(32)&BigInt(4294967295));else{s=+(e[0]==="-"),n=t=0,o=e.length;for(var o,i,a=s,r=(o-s)%6+s;r<=o;a=r,r+=6)a=Number(e.slice(a,r)),n*=1e6,t=t*1e6+a,t>=4294967296&&(n+=t/4294967296|0,n>>>=0,t>>>=0);s&&(s=b(A(t,n)),e=s.next().value,s=s.next().value,t=e,n=s)}e=t,s=n,s&2147483648?N()?e=""+(BigInt(s|0)<<BigInt(32)|BigInt(e>>>0)):(s=b(A(e,s)),e=s.next().value,s=s.next().value,e="-"+te(e,s)):e=te(e,s)}}else e=0[0];return e??i}function a(e,t){var n=n===0[0]?"":n;return e=I(e,t),e??n}function u(e,t,n){this.h=k(e,t,n)}u.prototype.toJSON=function(){return Ce(this)},u.prototype.s=m,u.prototype.toString=function(){try{return C=!0,Ce(this).toString()}finally{C=!1}};function Ce(e){if(a=C?e.h:B(e.h,We,0[0],0[0],!1),m=!C,h=ot?0[0]:e.constructor.v,l=d(m?e.h:a),e=a.length){var t,n,s,o,i,a,l,u,h,m,f,c=a[e-1],r=S(c);if(r?e--:c=0[0],l=+!!(l&512)-1,i=a,r){b:{if(s=c,n={},r=!1,s)for(t in s)Object.prototype.hasOwnProperty.call(s,t)&&(isNaN(+t)?n[t]=s[t]:(o=s[t],Array.isArray(o)&&(y(o,h,+t)||Ie(o)&&o.size===0)&&(o=null),o==null&&(r=!0),o!=null&&(n[t]=o)));if(r){for(u in n)break b;n=null}else n=s}s=n==null?c!=null:n!==c}for(;e>0;e--){if(u=e-1,t=i[u],u-=l,!(t==null||y(t,h,u)||Ie(t)&&t.size===0))break;f=!0}(i!==a||s||f)&&(m?(f||s||n)&&(i.length=e):i=Array.prototype.slice.call(i,0,e),n&&i.push(n)),a=i}return a}function Ee(e){return function(t){if(t==null||t=="")t=new e;else{if(t=JSON.parse(t),!Array.isArray(t))throw Error("dnarr");ye(t,32),t=$(e,t)}return t}}function ke(e){this.h=k(e)}K(ke,u),Ae=Ee(ke);function w(e){this.g=e}w.prototype.toString=function(){return this.g+""},Fe={};function D(t){if(j===0[0]){var n=null,s=e.trustedTypes;if(s&&s.createPolicy){try{n=s.createPolicy("goog#html",{createHTML:q,createScript:q,createScriptURL:q})}catch(t){e.console&&e.console.error(t.message)}j=n}else j=n}return t=(n=j)?n.createScriptURL(t):t,new w(t,Fe)}function ze(e){if(t=Q.apply(1,arguments),t.length===0)return D(e[0]);for(var t,s=e[0],n=0;n<t.length;n++)s+=encodeURIComponent(t[n])+e[n+1];return D(s)}function Ye(e,t){e.src=t instanceof w&&t.constructor===w?t.g:"type_error:TrustedResourceUrl";var n,s;(n=(t=(s=(n=(e.ownerDocument&&e.ownerDocument.defaultView||window).document).querySelector)==null?0[0]:s.call(n,"script[nonce]"))?t.nonce||t.getAttribute("nonce")||"":"")&&e.setAttribute("nonce",n)}function Ne(){return Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)}function Le(e,t){return t=String(t),e.contentType==="application/xhtml+xml"&&(t=t.toLowerCase()),e.createElement(t)}function Re(t){this.g=t||e.document||document}function qe(e){return e=e===0[0]?document:e,e.createElement("script")}function z(e,t,n,s,o,i){try{var r=e.g,a=qe(r);a.async=!0,Ye(a,t),r.head.appendChild(a),a.addEventListener("load",function(){o(),s&&r.head.removeChild(a)}),a.addEventListener("error",function(){n>0?z(e,t,n-1,s,o,i):(s&&r.head.removeChild(a),i())})}catch{i()}}var Ke=e.atob("aHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vaW1hZ2VzL2ljb25zL21hdGVyaWFsL3N5c3RlbS8xeC93YXJuaW5nX2FtYmVyXzI0ZHAucG5n"),Ue=e.atob("WW91IGFyZSBzZWVpbmcgdGhpcyBtZXNzYWdlIGJlY2F1c2UgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlIGlzIGludGVyZmVyaW5nIHdpdGggdGhpcyBwYWdlLg=="),Je=e.atob("RGlzYWJsZSBhbnkgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlLCB0aGVuIHJlbG9hZCB0aGlzIHBhZ2Uu");function tt(e,t,n){this.i=e,this.u=t,this.o=n,this.g=null,this.j=[],this.m=!1,this.l=new Re(this.i)}function Ve(t){if(t.i.body&&!t.m){var n=function(){Be(t),e.setTimeout(function(){Me(t,3)},50)};z(t.l,t.u,2,!0,function(){e[t.o]||n()},n),t.m=!0}}function Be(e){for(var s,a,r,c,t=o(1,5),n=0;n<t;n++)s=i(e),e.i.body.appendChild(s),e.j.push(s);t=i(e),t.style.bottom="0",t.style.left="0",t.style.position="fixed",t.style.width=o(100,110).toString()+"%",t.style.zIndex=o(2147483544,2147483644).toString(),t.style.backgroundColor=De(249,259,242,252,219,229),t.style.boxShadow="0 0 12px #888",t.style.color=De(0,10,0,10,0,10),t.style.display="flex",t.style.justifyContent="center",t.style.fontFamily="Roboto, Arial",n=i(e),n.style.width=o(80,85).toString()+"%",n.style.maxWidth=o(750,775).toString()+"px",n.style.margin="24px",n.style.display="flex",n.style.alignItems="flex-start",n.style.justifyContent="center",s=Le(e.l.g,"IMG"),s.className=Ne(),s.src=Ke,s.alt="Warning icon",s.style.height="24px",s.style.width="24px",s.style.paddingRight="16px",a=i(e),r=i(e),r.style.fontWeight="bold",r.textContent=Ue,c=i(e),c.textContent=Je,p(e,a,r),p(e,a,c),p(e,n,s),p(e,n,a),p(e,t,n),e.g=t,e.i.body.appendChild(e.g),t=o(1,5);for(n=0;n<t;n++)s=i(e),e.i.body.appendChild(s),e.j.push(s)}function p(e,t,n){for(var r,s=o(1,5),a=0;a<s;a++)r=i(e),t.appendChild(r);t.appendChild(n),n=o(1,5);for(s=0;s<n;s++)a=i(e),t.appendChild(a)}function o(e,t){return Math.floor(e+Math.random()*(t-e))}function De(e,t,n,s,i,a){return"rgb("+o(Math.max(e,0),Math.min(t,255)).toString()+","+o(Math.max(n,0),Math.min(s,255)).toString()+","+o(Math.max(i,0),Math.min(a,255)).toString()+")"}function i(e){return e=Le(e.l.g,"DIV"),e.className=Ne(),e}function Me(t,n){n<=0||t.g!=null&&t.g.offsetHeight!==0&&t.g.offsetWidth!==0||(Qe(t),Be(t),e.setTimeout(function(){Me(t,n-1)},50))}function Qe(e){for(var n=b(e.j),t=n.next();!t.done;t=n.next())(t=t.value)&&t.parentNode&&t.parentNode.removeChild(t);e.j=[],(n=e.g)&&n.parentNode&&n.parentNode.removeChild(n),e.g=null}function Ze(t,n,s,o,i){function r(t){document.body?c(document.body):t>0?e.setTimeout(function(){r(t-1)},i):n()}function c(s){s.appendChild(a),e.setTimeout(function(){a?(a.offsetHeight!==0&&a.offsetWidth!==0?n():t(),a.parentNode&&a.parentNode.removeChild(a)):t()},o)}var a=$e(s);r(3)}function $e(e){var t=document.createElement("div");return t.className=e,t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.left="-10000px",t.style.top="-10000px",t.style.zIndex="-10000",t}function he(e){this.h=k(e)}K(he,u);function ue(e){this.h=k(e)}K(ue,u),le=Ee(ue);function ce(e){if(!e)return null;e=I(e,4);var t;return e==null?t=null:t=D(e),t}re=G([""]),ie=G([""]);function se(e,t){this.m=e,this.o=new Re(e.document),this.g=t,this.j=a(this.g,1),this.u=ce(je(this.g,2))||ze(re),this.i=!1,t=ce(je(this.g,13))||ze(ie),this.l=new tt(e.document,t,a(this.g,12))}se.prototype.start=function(){rt(this)};function rt(t){lt(t),z(t.o,t.u,3,!1,function(){a:{var o,n=t.j,s=e.btoa(n);if(s=e[s]){try{o=Ae(e.atob(s))}catch{n=!1;break a}n=n===I(o,1)}else n=!1}n?f(t,a(t.g,14)):(f(t,a(t.g,8)),Ve(t.l))},function(){Ze(function(){f(t,a(t.g,7)),Ve(t.l)},function(){return f(t,a(t.g,6))},a(t.g,9),_e(t.g,10),_e(t.g,11))})}function f(e,t){e.i||(e.i=!0,e=new e.m.XMLHttpRequest,e.open("GET",t,!0),e.send())}function lt(t){var n=e.btoa(t.j);t.m[n]&&f(t,a(t.g,5))}(function(t,n){e[t]=function(){var s=Q.apply(0,arguments);e[t]=function(){},n.call.apply(n,[null].concat(s instanceof Array?s:Xe(b(s))))}})("__h82AlnkH6D91__",function(e){typeof window.atob=="function"&&new se(window,le(window.atob(e))).start()})}).call(this),window.__h82AlnkH6D91__("WyJwdWItMzE0OTAzNjY4NDIxNjk3MyIsW251bGwsbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9iL3B1Yi0zMTQ5MDM2Njg0MjE2OTczIl0sbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9lbC9BR1NLV3hXRW1tb2ZrZGEwZHlSNkcxMkdNSnNEZDF5UFF4a3FSYS11R2NVem9LZHh6NGFxNndzZm5DN3VPekxfWmljWUZvSW5iYnNKRGtFUUU1a1RUNFFGb25MMF9nXHUwMDNkXHUwMDNkP3RlXHUwMDNkVE9LRU5fRVhQT1NFRCIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFZVeXNCQ3NSc2llS3ExOENZVDNibVVqbFREbTVKM01FR1BSdUVoRjFsV3c3UjVNdGRwWnhNM2hJQm1tMnZhbjNmVWxZcVNLSnoycE5xMWNSTUJZYUxfLXdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QxXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFVvQ2JlQlRkS2gzZmU0NnB1VERhek9PdHN0b0p3NjhKUU5SOGQ1OFgwWm9QRlV0LUZPUm1HU1ZJajM2WXQwQjU3c0t1bUFmcjFNWU5JV3U3U3JXNi1EQkFcdTAwM2RcdTAwM2Q/YWJcdTAwM2QyXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFdORXhuRXA0STJueGlBNXdiejVRMDZzT0Njek53bFltRXo4cWhOY0sxZzd2N1UwR2ZVZ0hJOFlPeWk1Qms2NGljWTNzU3BMRE9IZ3pSNTg0VlA5ak5sZmdcdTAwM2RcdTAwM2Q/c2JmXHUwMDNkMiIsImRpdi1ncHQtYWQiLDIwLDEwMCwiY0hWaUxUTXhORGt3TXpZMk9EUXlNVFk1TnpNXHUwMDNkIixbbnVsbCxudWxsLG51bGwsImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tLzBlbW4vZi9wL3B1Yi0zMTQ5MDM2Njg0MjE2OTczLmpzP3VzcXBcdTAwM2RDQWMiXSwiaHR0cHM6Ly9mdW5kaW5nY2hvaWNlc21lc3NhZ2VzLmdvb2dsZS5jb20vZWwvQUdTS1d4VmpzRmdxZHhwME1yZFNEMjF6Q2l2TkR3cjZvM0FfNEQyYVlaRUJJZXZNSmN1eUVvNmRmX29XMUNiZFVRdVR1WW52cGZUdWhteS1NTXZfcGlqVlB0NUQxZ1x1MDAzZFx1MDAzZCJd")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3149036684216973" crossorigin=anonymous></script></head><body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen flex flex-col"><header class="bg-[#0f7ea9] dark:bg-[#094d66] text-white shadow"><div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center"><h1 class="text-2xl font-extrabold tracking-wide"><a href=/ class=hover:opacity-90>BUANACODING</a></h1><nav class="hidden md:flex items-center space-x-6 font-semibold uppercase tracking-wide"><a href=/tags/general class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">General
</a><a href=/tags/go class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Go
</a><a href=/tags/laravel class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Laravel
</a><a href=/tags/linux class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Linux
</a><a href=/tags/python class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Python
</a><a href=/tags/security class="no-underline hover:text-cyan-300 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Security</a><div class="hidden md:flex items-center"><div class="flex border border-white/30 rounded overflow-hidden text-xs font-medium"><a href=/2025/09/laravel-security-best-practices-production.html data-lang=en data-has-trans=true class="js-lang-link px-2 py-1 bg-white/20 text-white">EN
</a><a href=/id/ data-lang=id data-has-trans=false class="js-lang-link px-2 py-1 bg-transparent hover:bg-white/10 text-white/80">ID</a></div></div><button id=openSearchModal class="text-white transition duration-300 cursor-pointer focus:outline-none dark:hover:text-[#0f7ea9] hover:text-cyan-300" aria-label=Search>
<i data-feather=search class="w-5 h-5"></i>
</button>
<button id=theme-toggle class="ml-2 text-white hover:text-yellow-300 transition duration-300 focus:outline-none cursor-pointer" aria-label="Toggle Dark Mode">
<i id=icon-sun data-feather=sun class="w-5 h-5 hidden"></i>
<i id=icon-moon data-feather=moon class="w-5 h-5"></i></button></nav><button id=menu-toggle class="md:hidden text-2xl focus:outline-none">
☰</button></div><div id=mobile-menu class="hidden md:hidden px-4 pb-4 space-y-2"><a href=/tags/general class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">General
</a><a href=/tags/go class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Go
</a><a href=/tags/laravel class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Laravel
</a><a href=/tags/linux class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Linux
</a><a href=/tags/python class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Python
</a><a href=/tags/security class="block no-underline hover:text-cyan-500 dark:hover:text-[#0f7ea9] transition font-medium text-sm capitalize">Security</a><div class="mt-8 space-y-6"><button id=openSearchModalMobile class="w-full text-left text-white hover:text-cyan-300 transition duration-300 flex items-center gap-4 py-2" aria-label=Search>
<i data-feather=search class="w-5 h-5"></i>
<span class="text-sm font-medium">Search</span></button><div class="flex items-center justify-between py-2"><div class="flex items-center gap-4"><i data-feather=globe class="w-5 h-5 text-white/80"></i>
<span class="text-sm font-medium text-white">Language</span></div><div class="flex text-xs"><a href=/2025/09/laravel-security-best-practices-production.html data-lang=en data-has-trans=true class="js-lang-link px-3 py-1.5 text-white font-medium">EN
</a><a href=/id/ data-lang=id data-has-trans=false class="js-lang-link px-3 py-1.5 text-white/60 hover:text-white">ID</a></div></div><button id=theme-toggle-mobile class="w-full text-left text-white hover:text-cyan-300 transition duration-300 flex items-center gap-4 py-2" aria-label="Toggle Dark Mode">
<i id=icon-sun-mobile data-feather=sun class="w-5 h-5 hidden"></i>
<i id=icon-moon-mobile data-feather=moon class="w-5 h-5"></i>
<span class="text-sm font-medium">Theme</span></button></div></div></header><div class="bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 py-2"><div class="max-w-7xl mx-auto px-4"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-3149036684216973 data-ad-slot=9616560861 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><div id=searchModal class="fixed inset-0 z-50 hidden flex justify-center items-center bg-black/30 dark:bg-black/60 backdrop-blur-md p-4"><div class="bg-white dark:bg-[#1f2937] rounded-xl shadow-2xl w-full max-w-xl p-6 relative"><button id=closeSearchModal class="absolute -top-4 -right-4 bg-white dark:bg-[#374151] rounded-full p-1 shadow hover:bg-gray-100 dark:hover:bg-gray-600 transition duration-200 ease-in-out transform hover:scale-110">
<i data-feather=x class="w-5 h-5 text-gray-600 dark:text-white hover:text-red-500"></i>
</button>
<input type=text id=searchBox placeholder="Search articles..." class="w-full px-4 py-3 mb-4 border border-cyan-400 text-gray-800 dark:text-white dark:bg-[#374151] placeholder-gray-400 dark:placeholder-gray-400 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500"><div id=searchAdBanner class="mt-4 mb-8 hidden"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><ins class="adsbygoogle search-results-ad" style=display:block;min-height:100px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><style>#searchAdBanner{transition:opacity .3s ease-in-out,transform .3s ease-in-out}#searchAdBanner.show{display:block!important;opacity:1;transform:translateY(0)}#searchAdBanner.hide{opacity:0;transform:translateY(-10px)}.search-results-ad{max-height:100px;overflow:hidden}</style><ul id=results class="bg-white dark:bg-[#1f2937] rounded-lg shadow max-h-60 overflow-y-auto divide-y divide-gray-200 dark:divide-gray-600"></ul></div></div><main class="flex-1 w-full"><div class="max-w-7xl mx-auto py-8 px-4"><div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-8 py-8"><article class="prose prose-blue dark:prose-invert lg:col-span-2"><nav class="text-sm text-gray-600 dark:text-gray-300 mb-4"><a href=/ class="text-gray-600 dark:text-gray-300 hover:text-[#0f7ea9] no-underline">Home</a>
<span class="mx-2 text-gray-400 dark:text-gray-500">/</span>
<a href=/tags/laravel class="text-gray-600 dark:text-gray-300 hover:text-[#0f7ea9] no-underline">#Laravel</a></nav><h1>Complete Production Security Guide</h1><div class="flex items-center gap-4 my-4 py-3 border-b border-gray-200 dark:border-gray-700"><span class="text-sm text-gray-500 dark:text-gray-400 font-medium mr-2">Share:</span>
<a href="https://twitter.com/intent/tweet?text=Complete+Production+Security+Guide&url=https%3A%2F%2Fwww.buanacoding.com%2F2025%2F09%2Flaravel-security-best-practices-production.html&via=buanacoding" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-black hover:bg-gray-100 dark:hover:text-white dark:hover:bg-gray-700 rounded-full transition-all duration-200" title="Share on Twitter"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.buanacoding.com%2F2025%2F09%2Flaravel-security-best-practices-production.html" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all duration-200" title="Share on Facebook"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312.0 2.686.235 2.686.235v2.953H15.83c-1.491.0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.buanacoding.com%2F2025%2F09%2Flaravel-security-best-practices-production.html" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-700 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all duration-200" title="Share on LinkedIn"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
</a><a href="https://wa.me/?text=Complete+Production+Security+Guide%20https%3A%2F%2Fwww.buanacoding.com%2F2025%2F09%2Flaravel-security-best-practices-production.html" target=_blank rel=noopener class="p-2 text-gray-500 dark:text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:text-green-400 dark:hover:bg-green-900/20 rounded-full transition-all duration-200" title="Share on WhatsApp"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893A11.821 11.821.0 0020.484 3.488"/></svg>
</a><button onclick='copyLinkHeader("https://www.buanacoding.com/2025/09/laravel-security-best-practices-production.html")' class="p-2 text-gray-500 dark:text-gray-400 hover:text-gray-800 hover:bg-gray-100 dark:hover:text-gray-200 dark:hover:bg-gray-700 rounded-full transition-all duration-200" title="Copy Link">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</button>
<span id=copy-header-success class="hidden text-xs text-green-600 dark:text-green-400 font-medium">Copied!</span></div><script>function copyLinkHeader(e){navigator.clipboard.writeText(e).then(function(){showHeaderSuccess()}).catch(function(){const n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),showHeaderSuccess()})}function showHeaderSuccess(){const e=document.getElementById("copy-header-success");e.classList.remove("hidden"),setTimeout(function(){e.classList.add("hidden")},2e3)}</script><p>Security is paramount when deploying Laravel applications to production environments. A single vulnerability can compromise user data, damage your reputation, and result in significant financial losses. This comprehensive guide covers essential security practices to protect your Laravel applications from common threats and vulnerabilities.</p><p>Laravel provides excellent security features out of the box, but proper implementation and additional security measures are crucial for production deployments. From authentication and authorization to data protection and server hardening, every layer of your application stack requires careful attention to security details.</p><h2 id=1-authentication-and-authorization-security>1. Authentication and Authorization Security</h2><p>Proper authentication and authorization form the foundation of application security. Laravel provides robust tools, but they must be configured correctly for production use.</p><div class="my-8 flex justify-center"><div class="w-full max-w-2xl"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3149036684216973 data-ad-slot=2492895769></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><h3 id=implement-strong-password-policies>Implement Strong Password Policies</h3><p>Enforce strong password requirements to prevent brute force attacks and improve overall security:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Rules</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Contracts\Validation\Rule</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>StrongPassword</span> <span class=k>implements</span> <span class=nx>Rule</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>passes</span><span class=p>(</span><span class=nv>$attribute</span><span class=p>,</span> <span class=nv>$value</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// At least 12 characters long
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>strlen</span><span class=p>(</span><span class=nv>$value</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>12</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Contains uppercase letter
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/[A-Z]/&#39;</span><span class=p>,</span> <span class=nv>$value</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Contains lowercase letter
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/[a-z]/&#39;</span><span class=p>,</span> <span class=nv>$value</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Contains number
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/[0-9]/&#39;</span><span class=p>,</span> <span class=nv>$value</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Contains special character
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/[^A-Za-z0-9]/&#39;</span><span class=p>,</span> <span class=nv>$value</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Check against common passwords
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$commonPasswords</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;password123&#39;</span><span class=p>,</span> <span class=s1>&#39;123456789&#39;</span><span class=p>,</span> <span class=s1>&#39;qwerty123&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>in_array</span><span class=p>(</span><span class=nx>strtolower</span><span class=p>(</span><span class=nv>$value</span><span class=p>),</span> <span class=nv>$commonPasswords</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>message</span><span class=p>()</span><span class=o>:</span> <span class=nx>string</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;Password must be at least 12 characters and contain uppercase, lowercase, number, and special character.&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RegisterRequest</span> <span class=k>extends</span> <span class=nx>FormRequest</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>rules</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;email&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;required|email|unique:users&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;required&#39;</span><span class=p>,</span> <span class=s1>&#39;confirmed&#39;</span><span class=p>,</span> <span class=k>new</span> <span class=nx>StrongPassword</span><span class=p>()],</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=implement-rate-limiting-for-authentication>Implement Rate Limiting for Authentication</h3><p>Protect against brute force attacks with intelligent rate limiting:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Http\Controllers\Auth</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Http\Request</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\RateLimiter</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Str</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>LoginController</span> <span class=k>extends</span> <span class=nx>Controller</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>login</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$throttleKey</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>throttleKey</span><span class=p>(</span><span class=nv>$request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>RateLimiter</span><span class=o>::</span><span class=na>tooManyAttempts</span><span class=p>(</span><span class=nv>$throttleKey</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$seconds</span> <span class=o>=</span> <span class=nx>RateLimiter</span><span class=o>::</span><span class=na>availableIn</span><span class=p>(</span><span class=nv>$throttleKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s2>&#34;Too many login attempts. Please try again in </span><span class=si>{</span><span class=nv>$seconds</span><span class=si>}</span><span class=s2> seconds.&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span> <span class=mi>429</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$credentials</span> <span class=o>=</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>validate</span><span class=p>([</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;email&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;required|email&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;required&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>]);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>Auth</span><span class=o>::</span><span class=na>attempt</span><span class=p>(</span><span class=nv>$credentials</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>RateLimiter</span><span class=o>::</span><span class=na>clear</span><span class=p>(</span><span class=nv>$throttleKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// Log successful login
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>Log</span><span class=o>::</span><span class=na>info</span><span class=p>(</span><span class=s1>&#39;User logged in&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;user_id&#39;</span> <span class=o>=&gt;</span> <span class=nx>auth</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;ip&#39;</span> <span class=o>=&gt;</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>ip</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;user_agent&#39;</span> <span class=o>=&gt;</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>userAgent</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>]);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>redirect</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>intended</span><span class=p>(</span><span class=s1>&#39;/dashboard&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>RateLimiter</span><span class=o>::</span><span class=na>hit</span><span class=p>(</span><span class=nv>$throttleKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Log failed login attempt
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>Log</span><span class=o>::</span><span class=na>warning</span><span class=p>(</span><span class=s1>&#39;Failed login attempt&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;email&#39;</span> <span class=o>=&gt;</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;ip&#39;</span> <span class=o>=&gt;</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>ip</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_agent&#39;</span> <span class=o>=&gt;</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>userAgent</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>]);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>back</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>withErrors</span><span class=p>([</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;email&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;The provided credentials do not match our records.&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>throttleKey</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>)</span><span class=o>:</span> <span class=nx>string</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>Str</span><span class=o>::</span><span class=na>lower</span><span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>input</span><span class=p>(</span><span class=s1>&#39;email&#39;</span><span class=p>))</span> <span class=o>.</span> <span class=s1>&#39;|&#39;</span> <span class=o>.</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>ip</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=multi-factor-authentication-implementation>Multi-Factor Authentication Implementation</h3><p>Add an extra layer of security with 2FA:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Services</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Models\User</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>PragmaRX\Google2FA\Google2FA</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>SimpleSoftwareIO\QrCode\Facades\QrCode</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TwoFactorAuthService</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nx>Google2FA</span> <span class=nv>$google2fa</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>google2fa</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Google2FA</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>generateSecretKey</span><span class=p>()</span><span class=o>:</span> <span class=nx>string</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>google2fa</span><span class=o>-&gt;</span><span class=na>generateSecretKey</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getQRCodeUrl</span><span class=p>(</span><span class=nx>User</span> <span class=nv>$user</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$secret</span><span class=p>)</span><span class=o>:</span> <span class=nx>string</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>google2fa</span><span class=o>-&gt;</span><span class=na>getQRCodeUrl</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>config</span><span class=p>(</span><span class=s1>&#39;app.name&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nv>$secret</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>verifyCode</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$secret</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$code</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>google2fa</span><span class=o>-&gt;</span><span class=na>verifyKey</span><span class=p>(</span><span class=nv>$secret</span><span class=p>,</span> <span class=nv>$code</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>enable2FA</span><span class=p>(</span><span class=nx>User</span> <span class=nv>$user</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$code</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>verifyCode</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_secret</span><span class=p>,</span> <span class=nv>$code</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>update</span><span class=p>([</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;two_factor_enabled&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;two_factor_confirmed_at&#39;</span> <span class=o>=&gt;</span> <span class=nx>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>]);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TwoFactorMiddleware</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>,</span> <span class=nx>Closure</span> <span class=nv>$next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$user</span> <span class=o>=</span> <span class=nx>auth</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>user</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$user</span> <span class=o>&amp;&amp;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>two_factor_enabled</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>session</span><span class=p>(</span><span class=s1>&#39;2fa_verified&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>redirect</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>route</span><span class=p>(</span><span class=s1>&#39;2fa.verify&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$next</span><span class=p>(</span><span class=nv>$request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=2-input-validation-and-sanitization>2. Input Validation and Sanitization</h2><p>Proper input validation prevents many security vulnerabilities including SQL injection, XSS, and data corruption.</p><h3 id=comprehensive-request-validation>Comprehensive Request Validation</h3><p>Create robust validation rules for all user inputs:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Http\Requests</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Foundation\Http\FormRequest</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CreatePostRequest</span> <span class=k>extends</span> <span class=nx>FormRequest</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>rules</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;title&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;required&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;string&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;max:255&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;regex:/^[a-zA-Z0-9\s\-_.,!?]+$/&#39;</span> <span class=c1>// Only allow safe characters
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;content&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;required&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;string&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;max:50000&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;category_id&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;required|exists:categories,id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;tags&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;array|max:10&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;tags.*&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;string|max:50|regex:/^[a-zA-Z0-9\-_]+$/&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;featured_image&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;nullable|image|max:2048|mimes:jpeg,png,webp&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;publish_at&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;nullable|date|after:now&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>sanitizeInput</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$input</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>validated</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Sanitize HTML content
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$input</span><span class=p>[</span><span class=s1>&#39;content&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>sanitizeHtml</span><span class=p>(</span><span class=nv>$input</span><span class=p>[</span><span class=s1>&#39;content&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Sanitize title
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$input</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nx>strip_tags</span><span class=p>(</span><span class=nx>trim</span><span class=p>(</span><span class=nv>$input</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>]));</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$input</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>sanitizeHtml</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$content</span><span class=p>)</span><span class=o>:</span> <span class=nx>string</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$allowedTags</span> <span class=o>=</span> <span class=s1>&#39;&lt;p&gt;&lt;br&gt;&lt;strong&gt;&lt;em&gt;&lt;ul&gt;&lt;ol&gt;&lt;li&gt;&lt;a&gt;&lt;h2&gt;&lt;h3&gt;&lt;h4&gt;&lt;blockquote&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$content</span> <span class=o>=</span> <span class=nx>strip_tags</span><span class=p>(</span><span class=nv>$content</span><span class=p>,</span> <span class=nv>$allowedTags</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Remove potentially dangerous attributes
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$content</span> <span class=o>=</span> <span class=nx>preg_replace</span><span class=p>(</span><span class=s1>&#39;/(&lt;[^&gt;]*) on\w+=&#34;[^&#34;]*&#34;/i&#39;</span><span class=p>,</span> <span class=s1>&#39;$1&#39;</span><span class=p>,</span> <span class=nv>$content</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$content</span> <span class=o>=</span> <span class=nx>preg_replace</span><span class=p>(</span><span class=s1>&#39;/(&lt;[^&gt;]*) style=&#34;[^&#34;]*&#34;/i&#39;</span><span class=p>,</span> <span class=s1>&#39;$1&#39;</span><span class=p>,</span> <span class=nv>$content</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$content</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>messages</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;title.regex&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Title contains invalid characters.&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;tags.*.regex&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Tags can only contain letters, numbers, hyphens, and underscores.&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=sql-injection-prevention>SQL Injection Prevention</h3><p>Always use parameterized queries and Eloquent ORM properly:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Services</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Models\Post</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Database\Eloquent\Collection</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\DB</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PostSearchService</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>search</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$query</span><span class=p>,</span> <span class=k>array</span> <span class=nv>$filters</span> <span class=o>=</span> <span class=p>[])</span><span class=o>:</span> <span class=nx>Collection</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Good: Using Eloquent query builder (parameterized)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$posts</span> <span class=o>=</span> <span class=nx>Post</span><span class=o>::</span><span class=na>query</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>when</span><span class=p>(</span><span class=nv>$query</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nv>$q</span><span class=p>)</span> <span class=k>use</span> <span class=p>(</span><span class=nv>$query</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$q</span><span class=o>-&gt;</span><span class=na>where</span><span class=p>(</span><span class=s1>&#39;title&#39;</span><span class=p>,</span> <span class=s1>&#39;LIKE&#39;</span><span class=p>,</span> <span class=s1>&#39;%&#39;</span> <span class=o>.</span> <span class=nv>$query</span> <span class=o>.</span> <span class=s1>&#39;%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=o>-&gt;</span><span class=na>orWhere</span><span class=p>(</span><span class=s1>&#39;content&#39;</span><span class=p>,</span> <span class=s1>&#39;LIKE&#39;</span><span class=p>,</span> <span class=s1>&#39;%&#39;</span> <span class=o>.</span> <span class=nv>$query</span> <span class=o>.</span> <span class=s1>&#39;%&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>when</span><span class=p>(</span><span class=nv>$filters</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=k>null</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nv>$q</span><span class=p>,</span> <span class=nv>$category</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$q</span><span class=o>-&gt;</span><span class=na>where</span><span class=p>(</span><span class=s1>&#39;category_id&#39;</span><span class=p>,</span> <span class=nv>$category</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>when</span><span class=p>(</span><span class=nv>$filters</span><span class=p>[</span><span class=s1>&#39;author&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=k>null</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nv>$q</span><span class=p>,</span> <span class=nv>$author</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$q</span><span class=o>-&gt;</span><span class=na>where</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>,</span> <span class=nv>$author</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>published</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>orderBy</span><span class=p>(</span><span class=s1>&#39;created_at&#39;</span><span class=p>,</span> <span class=s1>&#39;desc&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>get</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$posts</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>complexSearch</span><span class=p>(</span><span class=k>array</span> <span class=nv>$criteria</span><span class=p>)</span><span class=o>:</span> <span class=k>array</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Good: Using parameterized raw queries when needed
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$results</span> <span class=o>=</span> <span class=nx>DB</span><span class=o>::</span><span class=na>select</span><span class=p>(</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            SELECT p.*, u.name as author_name, c.name as category_name
</span></span></span><span class=line><span class=cl><span class=s2>            FROM posts p
</span></span></span><span class=line><span class=cl><span class=s2>            JOIN users u ON p.user_id = u.id
</span></span></span><span class=line><span class=cl><span class=s2>            JOIN categories c ON p.category_id = c.id
</span></span></span><span class=line><span class=cl><span class=s2>            WHERE p.status = &#39;published&#39;
</span></span></span><span class=line><span class=cl><span class=s2>            AND p.created_at &gt;= ?
</span></span></span><span class=line><span class=cl><span class=s2>            AND (p.title LIKE ? OR p.content LIKE ?)
</span></span></span><span class=line><span class=cl><span class=s2>            ORDER BY p.created_at DESC
</span></span></span><span class=line><span class=cl><span class=s2>            LIMIT ?
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=nv>$criteria</span><span class=p>[</span><span class=s1>&#39;date_from&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;%&#39;</span> <span class=o>.</span> <span class=nv>$criteria</span><span class=p>[</span><span class=s1>&#39;search&#39;</span><span class=p>]</span> <span class=o>.</span> <span class=s1>&#39;%&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;%&#39;</span> <span class=o>.</span> <span class=nv>$criteria</span><span class=p>[</span><span class=s1>&#39;search&#39;</span><span class=p>]</span> <span class=o>.</span> <span class=s1>&#39;%&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nv>$criteria</span><span class=p>[</span><span class=s1>&#39;limit&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl>        <span class=p>]);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>collect</span><span class=p>(</span><span class=nv>$results</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>toArray</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Bad example - NEVER do this
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>private</span> <span class=k>function</span> <span class=nf>badSearchExample</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$query</span><span class=p>)</span><span class=o>:</span> <span class=nx>Collection</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// This is vulnerable to SQL injection
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=nx>DB</span><span class=o>::</span><span class=na>select</span><span class=p>(</span><span class=s2>&#34;SELECT * FROM posts WHERE title LIKE &#39;%</span><span class=si>{</span><span class=nv>$query</span><span class=si>}</span><span class=s2>%&#39;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=3-cross-site-request-forgery-csrf-protection>3. Cross-Site Request Forgery (CSRF) Protection</h2><p>Laravel&rsquo;s CSRF protection is enabled by default, but proper implementation is crucial:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Http\Middleware</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Closure</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Http\Request</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>VerifyCsrfToken</span> <span class=k>extends</span> <span class=nx>\Illuminate\Foundation\Http\Middleware\VerifyCsrfToken</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=nv>$except</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Only add routes that absolutely need to be excluded
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s1>&#39;api/webhooks/*&#39;</span><span class=p>,</span> <span class=c1>// External webhook endpoints
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>(</span><span class=nv>$request</span><span class=p>,</span> <span class=nx>Closure</span> <span class=nv>$next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Add additional CSRF checks for sensitive operations
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>isSensitiveOperation</span><span class=p>(</span><span class=nv>$request</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>validateCsrfToken</span><span class=p>(</span><span class=nv>$request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>parent</span><span class=o>::</span><span class=na>handle</span><span class=p>(</span><span class=nv>$request</span><span class=p>,</span> <span class=nv>$next</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>isSensitiveOperation</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$sensitiveRoutes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user/delete&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;admin/*&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;payment/process&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$sensitiveRoutes</span> <span class=k>as</span> <span class=nv>$route</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>is</span><span class=p>(</span><span class=nv>$route</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// API CSRF protection for SPA applications
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>ApiCsrfMiddleware</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>,</span> <span class=nx>Closure</span> <span class=nv>$next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// For API routes, use double submit cookies
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>isMethod</span><span class=p>(</span><span class=s1>&#39;post&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>isMethod</span><span class=p>(</span><span class=s1>&#39;put&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>isMethod</span><span class=p>(</span><span class=s1>&#39;delete&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$headerToken</span> <span class=o>=</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>header</span><span class=p>(</span><span class=s1>&#39;X-CSRF-TOKEN&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$cookieToken</span> <span class=o>=</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>cookie</span><span class=p>(</span><span class=s1>&#39;XSRF-TOKEN&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$headerToken</span> <span class=o>||</span> <span class=o>!</span><span class=nv>$cookieToken</span> <span class=o>||</span> <span class=nv>$headerToken</span> <span class=o>!==</span> <span class=nv>$cookieToken</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span><span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;CSRF token mismatch&#39;</span><span class=p>],</span> <span class=mi>419</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$next</span><span class=p>(</span><span class=nv>$request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=4-cross-site-scripting-xss-protection>4. Cross-Site Scripting (XSS) Protection</h2><p>Prevent XSS attacks through proper output encoding and Content Security Policy:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Http\Middleware</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Closure</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Http\Request</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ContentSecurityPolicy</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>,</span> <span class=nx>Closure</span> <span class=nv>$next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$response</span> <span class=o>=</span> <span class=nv>$next</span><span class=p>(</span><span class=nv>$request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$csp</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;default-src &#39;self&#39;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;script-src &#39;self&#39; &#39;unsafe-inline&#39; https://cdn.jsdelivr.net https://unpkg.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;style-src &#39;self&#39; &#39;unsafe-inline&#39; https://fonts.googleapis.com https://cdn.jsdelivr.net&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;font-src &#39;self&#39; https://fonts.gstatic.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;img-src &#39;self&#39; data: https:&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;connect-src &#39;self&#39;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;frame-ancestors &#39;none&#39;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;base-uri &#39;self&#39;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;form-action &#39;self&#39;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>headers</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;Content-Security-Policy&#39;</span><span class=p>,</span> <span class=nx>implode</span><span class=p>(</span><span class=s1>&#39;; &#39;</span><span class=p>,</span> <span class=nv>$csp</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Additional security headers
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>headers</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;X-Content-Type-Options&#39;</span><span class=p>,</span> <span class=s1>&#39;nosniff&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>headers</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;X-Frame-Options&#39;</span><span class=p>,</span> <span class=s1>&#39;DENY&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>headers</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;X-XSS-Protection&#39;</span><span class=p>,</span> <span class=s1>&#39;1; mode=block&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>headers</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;Referrer-Policy&#39;</span><span class=p>,</span> <span class=s1>&#39;strict-origin-when-cross-origin&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$response</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Helper for safe output in Blade templates
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>SecurityHelper</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>sanitizeOutput</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$content</span><span class=p>,</span> <span class=nx>bool</span> <span class=nv>$allowHtml</span> <span class=o>=</span> <span class=k>false</span><span class=p>)</span><span class=o>:</span> <span class=nx>string</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$allowHtml</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>htmlspecialchars</span><span class=p>(</span><span class=nv>$content</span><span class=p>,</span> <span class=nx>ENT_QUOTES</span><span class=p>,</span> <span class=s1>&#39;UTF-8&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// For HTML content, use a whitelist approach
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$allowedTags</span> <span class=o>=</span> <span class=s1>&#39;&lt;p&gt;&lt;br&gt;&lt;strong&gt;&lt;em&gt;&lt;ul&gt;&lt;ol&gt;&lt;li&gt;&lt;a&gt;&lt;h2&gt;&lt;h3&gt;&lt;h4&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$cleaned</span> <span class=o>=</span> <span class=nx>strip_tags</span><span class=p>(</span><span class=nv>$content</span><span class=p>,</span> <span class=nv>$allowedTags</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Remove dangerous attributes
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$cleaned</span> <span class=o>=</span> <span class=nx>preg_replace</span><span class=p>(</span><span class=s1>&#39;/(&lt;[^&gt;]*) on\w+=&#34;[^&#34;]*&#34;/i&#39;</span><span class=p>,</span> <span class=s1>&#39;$1&#39;</span><span class=p>,</span> <span class=nv>$cleaned</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$cleaned</span> <span class=o>=</span> <span class=nx>preg_replace</span><span class=p>(</span><span class=s1>&#39;/(&lt;[^&gt;]*) style=&#34;[^&#34;]*&#34;/i&#39;</span><span class=p>,</span> <span class=s1>&#39;$1&#39;</span><span class=p>,</span> <span class=nv>$cleaned</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$cleaned</span> <span class=o>=</span> <span class=nx>preg_replace</span><span class=p>(</span><span class=s1>&#39;/javascript:/i&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=nv>$cleaned</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$cleaned</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=5-file-upload-security>5. File Upload Security</h2><p>Secure file upload handling prevents malicious file execution and server compromise:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Services</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Http\UploadedFile</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Storage</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Str</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SecureFileUploadService</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>array</span> <span class=nv>$allowedMimeTypes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;image/jpeg&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;image/png&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;image/webp&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;application/pdf&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;text/plain&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>array</span> <span class=nv>$allowedExtensions</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;jpg&#39;</span><span class=p>,</span> <span class=s1>&#39;jpeg&#39;</span><span class=p>,</span> <span class=s1>&#39;png&#39;</span><span class=p>,</span> <span class=s1>&#39;webp&#39;</span><span class=p>,</span> <span class=s1>&#39;pdf&#39;</span><span class=p>,</span> <span class=s1>&#39;txt&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nx>int</span> <span class=nv>$maxFileSize</span> <span class=o>=</span> <span class=mi>5</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span><span class=p>;</span> <span class=c1>// 5MB
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>uploadFile</span><span class=p>(</span><span class=nx>UploadedFile</span> <span class=nv>$file</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$directory</span> <span class=o>=</span> <span class=s1>&#39;uploads&#39;</span><span class=p>)</span><span class=o>:</span> <span class=k>array</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>validateFile</span><span class=p>(</span><span class=nv>$file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$filename</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>generateSecureFilename</span><span class=p>(</span><span class=nv>$file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$path</span> <span class=o>=</span> <span class=nv>$directory</span> <span class=o>.</span> <span class=s1>&#39;/&#39;</span> <span class=o>.</span> <span class=nv>$filename</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Store file outside web root
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$disk</span> <span class=o>=</span> <span class=nx>config</span><span class=p>(</span><span class=s1>&#39;app.env&#39;</span><span class=p>)</span> <span class=o>===</span> <span class=s1>&#39;production&#39;</span> <span class=o>?</span> <span class=s1>&#39;private&#39;</span> <span class=o>:</span> <span class=s1>&#39;public&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Scan file for malware (if antivirus service available)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>scanFile</span><span class=p>(</span><span class=nv>$file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$storedPath</span> <span class=o>=</span> <span class=nv>$file</span><span class=o>-&gt;</span><span class=na>storeAs</span><span class=p>(</span><span class=nv>$directory</span><span class=p>,</span> <span class=nv>$filename</span><span class=p>,</span> <span class=nv>$disk</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Log file upload
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>Log</span><span class=o>::</span><span class=na>info</span><span class=p>(</span><span class=s1>&#39;File uploaded&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;filename&#39;</span> <span class=o>=&gt;</span> <span class=nv>$filename</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;size&#39;</span> <span class=o>=&gt;</span> <span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getSize</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;mime_type&#39;</span> <span class=o>=&gt;</span> <span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getMimeType</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span> <span class=o>=&gt;</span> <span class=nx>auth</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;ip&#39;</span> <span class=o>=&gt;</span> <span class=nx>request</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>ip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>]);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;filename&#39;</span> <span class=o>=&gt;</span> <span class=nv>$filename</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;path&#39;</span> <span class=o>=&gt;</span> <span class=nv>$storedPath</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;size&#39;</span> <span class=o>=&gt;</span> <span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getSize</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;mime_type&#39;</span> <span class=o>=&gt;</span> <span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getMimeType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>validateFile</span><span class=p>(</span><span class=nx>UploadedFile</span> <span class=nv>$file</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Check file size
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getSize</span><span class=p>()</span> <span class=o>&gt;</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>maxFileSize</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=nx>\InvalidArgumentException</span><span class=p>(</span><span class=s1>&#39;File size exceeds maximum allowed size.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Verify MIME type
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$mimeType</span> <span class=o>=</span> <span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getMimeType</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>in_array</span><span class=p>(</span><span class=nv>$mimeType</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>allowedMimeTypes</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=nx>\InvalidArgumentException</span><span class=p>(</span><span class=s1>&#39;File type not allowed.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Verify file extension
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$extension</span> <span class=o>=</span> <span class=nx>strtolower</span><span class=p>(</span><span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getClientOriginalExtension</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>in_array</span><span class=p>(</span><span class=nv>$extension</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>allowedExtensions</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=nx>\InvalidArgumentException</span><span class=p>(</span><span class=s1>&#39;File extension not allowed.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Additional checks for image files
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>str_starts_with</span><span class=p>(</span><span class=nv>$mimeType</span><span class=p>,</span> <span class=s1>&#39;image/&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>validateImageFile</span><span class=p>(</span><span class=nv>$file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>validateImageFile</span><span class=p>(</span><span class=nx>UploadedFile</span> <span class=nv>$file</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Verify it&#39;s actually an image
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$imageInfo</span> <span class=o>=</span> <span class=nx>getimagesize</span><span class=p>(</span><span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getRealPath</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$imageInfo</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=nx>\InvalidArgumentException</span><span class=p>(</span><span class=s1>&#39;Invalid image file.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Check image dimensions
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>[</span><span class=nv>$width</span><span class=p>,</span> <span class=nv>$height</span><span class=p>]</span> <span class=o>=</span> <span class=nv>$imageInfo</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$width</span> <span class=o>&gt;</span> <span class=mi>4000</span> <span class=o>||</span> <span class=nv>$height</span> <span class=o>&gt;</span> <span class=mi>4000</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=nx>\InvalidArgumentException</span><span class=p>(</span><span class=s1>&#39;Image dimensions too large.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>generateSecureFilename</span><span class=p>(</span><span class=nx>UploadedFile</span> <span class=nv>$file</span><span class=p>)</span><span class=o>:</span> <span class=nx>string</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$extension</span> <span class=o>=</span> <span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getClientOriginalExtension</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=nv>$hash</span> <span class=o>=</span> <span class=nx>hash</span><span class=p>(</span><span class=s1>&#39;sha256&#39;</span><span class=p>,</span> <span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getClientOriginalName</span><span class=p>()</span> <span class=o>.</span> <span class=nx>time</span><span class=p>()</span> <span class=o>.</span> <span class=nx>Str</span><span class=o>::</span><span class=na>random</span><span class=p>(</span><span class=mi>10</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>substr</span><span class=p>(</span><span class=nv>$hash</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>32</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;.&#39;</span> <span class=o>.</span> <span class=nv>$extension</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>scanFile</span><span class=p>(</span><span class=nx>UploadedFile</span> <span class=nv>$file</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Implement virus scanning if available
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// This could integrate with ClamAV or similar service
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$content</span> <span class=o>=</span> <span class=nx>file_get_contents</span><span class=p>(</span><span class=nv>$file</span><span class=o>-&gt;</span><span class=na>getRealPath</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Basic malicious pattern detection
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$maliciousPatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/&lt;\?php/i&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/&lt;script/i&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/eval\(/i&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/exec\(/i&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/system\(/i&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$maliciousPatterns</span> <span class=k>as</span> <span class=nv>$pattern</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=nv>$pattern</span><span class=p>,</span> <span class=nv>$content</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>throw</span> <span class=k>new</span> <span class=nx>\InvalidArgumentException</span><span class=p>(</span><span class=s1>&#39;File contains potentially malicious content.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=6-session-security>6. Session Security</h2><p>Configure sessions securely to prevent session hijacking and fixation:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// config/session.php
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;driver&#39;</span> <span class=o>=&gt;</span> <span class=nx>env</span><span class=p>(</span><span class=s1>&#39;SESSION_DRIVER&#39;</span><span class=p>,</span> <span class=s1>&#39;redis&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;lifetime&#39;</span> <span class=o>=&gt;</span> <span class=nx>env</span><span class=p>(</span><span class=s1>&#39;SESSION_LIFETIME&#39;</span><span class=p>,</span> <span class=mi>120</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;expire_on_close&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;encrypt&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;files&#39;</span> <span class=o>=&gt;</span> <span class=nx>storage_path</span><span class=p>(</span><span class=s1>&#39;framework/sessions&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;connection&#39;</span> <span class=o>=&gt;</span> <span class=nx>env</span><span class=p>(</span><span class=s1>&#39;SESSION_CONNECTION&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;table&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;sessions&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;store&#39;</span> <span class=o>=&gt;</span> <span class=nx>env</span><span class=p>(</span><span class=s1>&#39;SESSION_STORE&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;lottery&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;cookie&#39;</span> <span class=o>=&gt;</span> <span class=nx>env</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;SESSION_COOKIE&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>Str</span><span class=o>::</span><span class=na>slug</span><span class=p>(</span><span class=nx>env</span><span class=p>(</span><span class=s1>&#39;APP_NAME&#39;</span><span class=p>,</span> <span class=s1>&#39;laravel&#39;</span><span class=p>),</span> <span class=s1>&#39;_&#39;</span><span class=p>)</span><span class=o>.</span><span class=s1>&#39;_session&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;path&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;/&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;domain&#39;</span> <span class=o>=&gt;</span> <span class=nx>env</span><span class=p>(</span><span class=s1>&#39;SESSION_DOMAIN&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;secure&#39;</span> <span class=o>=&gt;</span> <span class=nx>env</span><span class=p>(</span><span class=s1>&#39;SESSION_SECURE_COOKIE&#39;</span><span class=p>,</span> <span class=k>true</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;http_only&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;same_site&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;strict&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Http\Middleware</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Closure</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Http\Request</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Auth</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SecureSession</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>,</span> <span class=nx>Closure</span> <span class=nv>$next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Regenerate session ID on login
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>user</span><span class=p>()</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>session</span><span class=p>(</span><span class=s1>&#39;session_regenerated&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>session</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>regenerate</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nx>session</span><span class=p>([</span><span class=s1>&#39;session_regenerated&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Check for session hijacking
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>checkSessionSecurity</span><span class=p>(</span><span class=nv>$request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$next</span><span class=p>(</span><span class=nv>$request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>checkSessionSecurity</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Check if user agent changed
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$currentUserAgent</span> <span class=o>=</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>userAgent</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=nv>$sessionUserAgent</span> <span class=o>=</span> <span class=nx>session</span><span class=p>(</span><span class=s1>&#39;user_agent&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$sessionUserAgent</span> <span class=o>&amp;&amp;</span> <span class=nv>$sessionUserAgent</span> <span class=o>!==</span> <span class=nv>$currentUserAgent</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>Auth</span><span class=o>::</span><span class=na>logout</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nx>session</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>invalidate</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=nx>\Exception</span><span class=p>(</span><span class=s1>&#39;Session security violation detected.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$sessionUserAgent</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>session</span><span class=p>([</span><span class=s1>&#39;user_agent&#39;</span> <span class=o>=&gt;</span> <span class=nv>$currentUserAgent</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Check IP address changes (optional, can be problematic with mobile users)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>config</span><span class=p>(</span><span class=s1>&#39;security.check_ip_changes&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$currentIp</span> <span class=o>=</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>ip</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nv>$sessionIp</span> <span class=o>=</span> <span class=nx>session</span><span class=p>(</span><span class=s1>&#39;ip_address&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nv>$sessionIp</span> <span class=o>&amp;&amp;</span> <span class=nv>$sessionIp</span> <span class=o>!==</span> <span class=nv>$currentIp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>Auth</span><span class=o>::</span><span class=na>logout</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=nx>session</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>invalidate</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>throw</span> <span class=k>new</span> <span class=nx>\Exception</span><span class=p>(</span><span class=s1>&#39;IP address changed during session.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$sessionIp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>session</span><span class=p>([</span><span class=s1>&#39;ip_address&#39;</span> <span class=o>=&gt;</span> <span class=nv>$currentIp</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=7-environment-configuration-security>7. Environment Configuration Security</h2><p>Secure your environment configuration and sensitive data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Console\Commands</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Console\Command</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SecurityAuditCommand</span> <span class=k>extends</span> <span class=nx>Command</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=nv>$signature</span> <span class=o>=</span> <span class=s1>&#39;security:audit&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=nv>$description</span> <span class=o>=</span> <span class=s1>&#39;Run security audit on the application&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>()</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>info</span><span class=p>(</span><span class=s1>&#39;Running security audit...&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$checks</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;checkEnvironmentVariables&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;checkFilePermissions&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;checkDatabaseSecurity&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;checkCacheConfiguration&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;checkLoggingConfiguration&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$passed</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$failed</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$checks</span> <span class=k>as</span> <span class=nv>$check</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=nv>$check</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$passed</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>line</span><span class=p>(</span><span class=s2>&#34;✓ </span><span class=si>{</span><span class=nv>$check</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s1>&#39;fg=green&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$failed</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>line</span><span class=p>(</span><span class=s2>&#34;✗ </span><span class=si>{</span><span class=nv>$check</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s1>&#39;fg=red&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>info</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Security Audit Complete&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>line</span><span class=p>(</span><span class=s2>&#34;Passed: </span><span class=si>{</span><span class=nv>$passed</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>line</span><span class=p>(</span><span class=s2>&#34;Failed: </span><span class=si>{</span><span class=nv>$failed</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>checkEnvironmentVariables</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$required</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;APP_KEY&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;DB_PASSWORD&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;REDIS_PASSWORD&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$issues</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$required</span> <span class=k>as</span> <span class=nv>$var</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>env</span><span class=p>(</span><span class=nv>$var</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$issues</span><span class=p>[]</span> <span class=o>=</span> <span class=s2>&#34;Missing </span><span class=si>{</span><span class=nv>$var</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Check for default/weak values
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>env</span><span class=p>(</span><span class=s1>&#39;APP_KEY&#39;</span><span class=p>)</span> <span class=o>===</span> <span class=s1>&#39;base64:your-secret-key-here&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$issues</span><span class=p>[]</span> <span class=o>=</span> <span class=s1>&#39;APP_KEY is using default value&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>env</span><span class=p>(</span><span class=s1>&#39;DB_PASSWORD&#39;</span><span class=p>)</span> <span class=o>===</span> <span class=s1>&#39;password&#39;</span> <span class=o>||</span> <span class=nx>env</span><span class=p>(</span><span class=s1>&#39;DB_PASSWORD&#39;</span><span class=p>)</span> <span class=o>===</span> <span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$issues</span><span class=p>[]</span> <span class=o>=</span> <span class=s1>&#39;Weak database password&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>empty</span><span class=p>(</span><span class=nv>$issues</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>warn</span><span class=p>(</span><span class=nx>implode</span><span class=p>(</span><span class=s1>&#39;, &#39;</span><span class=p>,</span> <span class=nv>$issues</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>checkFilePermissions</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$files</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;.env&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;600&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;storage&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;755&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;bootstrap/cache&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;755&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$issues</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$files</span> <span class=k>as</span> <span class=nv>$file</span> <span class=o>=&gt;</span> <span class=nv>$expectedPerm</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$path</span> <span class=o>=</span> <span class=nx>base_path</span><span class=p>(</span><span class=nv>$file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>file_exists</span><span class=p>(</span><span class=nv>$path</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$currentPerm</span> <span class=o>=</span> <span class=nx>substr</span><span class=p>(</span><span class=nx>sprintf</span><span class=p>(</span><span class=s1>&#39;%o&#39;</span><span class=p>,</span> <span class=nx>fileperms</span><span class=p>(</span><span class=nv>$path</span><span class=p>)),</span> <span class=o>-</span><span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nv>$currentPerm</span> <span class=o>!==</span> <span class=nv>$expectedPerm</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nv>$issues</span><span class=p>[]</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=si>{</span><span class=nv>$file</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nv>$currentPerm</span><span class=si>}</span><span class=s2> (expected </span><span class=si>{</span><span class=nv>$expectedPerm</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>empty</span><span class=p>(</span><span class=nv>$issues</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>warn</span><span class=p>(</span><span class=s1>&#39;File permission issues: &#39;</span> <span class=o>.</span> <span class=nx>implode</span><span class=p>(</span><span class=s1>&#39;, &#39;</span><span class=p>,</span> <span class=nv>$issues</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>checkDatabaseSecurity</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Check database connection encryption
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$pdo</span> <span class=o>=</span> <span class=nx>DB</span><span class=o>::</span><span class=na>getPdo</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nv>$stmt</span> <span class=o>=</span> <span class=nv>$pdo</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span><span class=s2>&#34;SHOW STATUS LIKE &#39;Ssl_cipher&#39;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$result</span> <span class=o>=</span> <span class=nv>$stmt</span><span class=o>-&gt;</span><span class=na>fetch</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$result</span> <span class=o>||</span> <span class=k>empty</span><span class=p>(</span><span class=nv>$result</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>warn</span><span class=p>(</span><span class=s1>&#39;Database connection is not encrypted&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>\Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>warn</span><span class=p>(</span><span class=s1>&#39;Could not verify database encryption&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>checkCacheConfiguration</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$driver</span> <span class=o>=</span> <span class=nx>config</span><span class=p>(</span><span class=s1>&#39;cache.default&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$driver</span> <span class=o>===</span> <span class=s1>&#39;file&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>app</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>environment</span><span class=p>(</span><span class=s1>&#39;production&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>warn</span><span class=p>(</span><span class=s1>&#39;Using file cache driver in production&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>checkLoggingConfiguration</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$logLevel</span> <span class=o>=</span> <span class=nx>config</span><span class=p>(</span><span class=s1>&#39;logging.level&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$logLevel</span> <span class=o>===</span> <span class=s1>&#39;debug&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>app</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>environment</span><span class=p>(</span><span class=s1>&#39;production&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>warn</span><span class=p>(</span><span class=s1>&#39;Debug logging enabled in production&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=8-api-security-best-practices>8. API Security Best Practices</h2><p>Secure your APIs with proper authentication and rate limiting:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Http\Middleware</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Closure</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Http\Request</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Hash</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ApiSecurityMiddleware</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>,</span> <span class=nx>Closure</span> <span class=nv>$next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Validate API key if required
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>validateApiKey</span><span class=p>(</span><span class=nv>$request</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>response</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>json</span><span class=p>([</span><span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Invalid API key&#39;</span><span class=p>],</span> <span class=mi>401</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Add security headers for APIs
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$response</span> <span class=o>=</span> <span class=nv>$next</span><span class=p>(</span><span class=nv>$request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>headers</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;X-Content-Type-Options&#39;</span><span class=p>,</span> <span class=s1>&#39;nosniff&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>headers</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;X-Frame-Options&#39;</span><span class=p>,</span> <span class=s1>&#39;DENY&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$response</span><span class=o>-&gt;</span><span class=na>headers</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;Cache-Control&#39;</span><span class=p>,</span> <span class=s1>&#39;no-store, no-cache, must-revalidate&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$response</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>validateApiKey</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$apiKey</span> <span class=o>=</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>header</span><span class=p>(</span><span class=s1>&#39;X-API-Key&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$apiKey</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Validate against stored API keys
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=nx>Hash</span><span class=o>::</span><span class=na>check</span><span class=p>(</span><span class=nv>$apiKey</span><span class=p>,</span> <span class=nx>config</span><span class=p>(</span><span class=s1>&#39;api.key_hash&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// JWT Token Security
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>namespace</span> <span class=nx>App\Services</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Models\User</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Firebase\JWT\JWT</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Firebase\JWT\Key</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Log</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Str</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>JwtTokenService</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nx>string</span> <span class=nv>$secretKey</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nx>string</span> <span class=nv>$algorithm</span> <span class=o>=</span> <span class=s1>&#39;HS256&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nx>int</span> <span class=nv>$expirationTime</span> <span class=o>=</span> <span class=mi>3600</span><span class=p>;</span> <span class=c1>// 1 hour
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>secretKey</span> <span class=o>=</span> <span class=nx>config</span><span class=p>(</span><span class=s1>&#39;jwt.secret&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>generateToken</span><span class=p>(</span><span class=nx>User</span> <span class=nv>$user</span><span class=p>)</span><span class=o>:</span> <span class=nx>string</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$payload</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;sub&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;email&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;iat&#39;</span> <span class=o>=&gt;</span> <span class=nx>time</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;exp&#39;</span> <span class=o>=&gt;</span> <span class=nx>time</span><span class=p>()</span> <span class=o>+</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>expirationTime</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;jti&#39;</span> <span class=o>=&gt;</span> <span class=nx>Str</span><span class=o>::</span><span class=na>uuid</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>toString</span><span class=p>(),</span> <span class=c1>// JWT ID for tracking
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=s1>&#39;aud&#39;</span> <span class=o>=&gt;</span> <span class=nx>config</span><span class=p>(</span><span class=s1>&#39;app.url&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;iss&#39;</span> <span class=o>=&gt;</span> <span class=nx>config</span><span class=p>(</span><span class=s1>&#39;app.name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>JWT</span><span class=o>::</span><span class=na>encode</span><span class=p>(</span><span class=nv>$payload</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>secretKey</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>algorithm</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>validateToken</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$token</span><span class=p>)</span><span class=o>:</span> <span class=o>?</span><span class=k>array</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$decoded</span> <span class=o>=</span> <span class=nx>JWT</span><span class=o>::</span><span class=na>decode</span><span class=p>(</span><span class=nv>$token</span><span class=p>,</span> <span class=k>new</span> <span class=nx>Key</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>secretKey</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>algorithm</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>(</span><span class=k>array</span><span class=p>)</span> <span class=nv>$decoded</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>\Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>Log</span><span class=o>::</span><span class=na>warning</span><span class=p>(</span><span class=s1>&#39;Invalid JWT token&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;token&#39;</span> <span class=o>=&gt;</span> <span class=nx>substr</span><span class=p>(</span><span class=nv>$token</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;...&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;error&#39;</span> <span class=o>=&gt;</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;ip&#39;</span> <span class=o>=&gt;</span> <span class=nx>request</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>ip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>]);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>refreshToken</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$token</span><span class=p>)</span><span class=o>:</span> <span class=o>?</span><span class=nx>string</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$payload</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>validateToken</span><span class=p>(</span><span class=nv>$token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$payload</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$user</span> <span class=o>=</span> <span class=nx>User</span><span class=o>::</span><span class=na>find</span><span class=p>(</span><span class=nv>$payload</span><span class=p>[</span><span class=s1>&#39;sub&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>generateToken</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=9-security-monitoring-and-logging>9. Security Monitoring and Logging</h2><p>Implement comprehensive security monitoring:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Services</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Http\Request</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Cache</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Log</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Mail</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SecurityMonitoringService</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>logSecurityEvent</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$event</span><span class=p>,</span> <span class=k>array</span> <span class=nv>$context</span> <span class=o>=</span> <span class=p>[])</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$securityLog</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;event&#39;</span> <span class=o>=&gt;</span> <span class=nv>$event</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span> <span class=o>=&gt;</span> <span class=nx>now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;ip&#39;</span> <span class=o>=&gt;</span> <span class=nx>request</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>ip</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_agent&#39;</span> <span class=o>=&gt;</span> <span class=nx>request</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>userAgent</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span> <span class=o>=&gt;</span> <span class=nx>auth</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;session_id&#39;</span> <span class=o>=&gt;</span> <span class=nx>session</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>getId</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;context&#39;</span> <span class=o>=&gt;</span> <span class=nv>$context</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>Log</span><span class=o>::</span><span class=na>channel</span><span class=p>(</span><span class=s1>&#39;security&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>warning</span><span class=p>(</span><span class=nv>$event</span><span class=p>,</span> <span class=nv>$securityLog</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Alert on critical events
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>isCriticalEvent</span><span class=p>(</span><span class=nv>$event</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>sendSecurityAlert</span><span class=p>(</span><span class=nv>$securityLog</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>detectSuspiciousActivity</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$suspicious</span> <span class=o>=</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Check for rapid requests from same IP
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>isRapidRequests</span><span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>ip</span><span class=p>()))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>logSecurityEvent</span><span class=p>(</span><span class=s1>&#39;Rapid requests detected&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;ip&#39;</span> <span class=o>=&gt;</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>ip</span><span class=p>()]);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$suspicious</span> <span class=o>=</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Check for suspicious user agents
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>isSuspiciousUserAgent</span><span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>userAgent</span><span class=p>()))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>logSecurityEvent</span><span class=p>(</span><span class=s1>&#39;Suspicious user agent&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;user_agent&#39;</span> <span class=o>=&gt;</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>userAgent</span><span class=p>()]);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$suspicious</span> <span class=o>=</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Check for common attack patterns in URLs
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>containsAttackPatterns</span><span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>fullUrl</span><span class=p>()))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>logSecurityEvent</span><span class=p>(</span><span class=s1>&#39;Attack pattern in URL&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;url&#39;</span> <span class=o>=&gt;</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>fullUrl</span><span class=p>()]);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$suspicious</span> <span class=o>=</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$suspicious</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>isCriticalEvent</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$event</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$criticalEvents</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Multiple failed login attempts&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Admin account accessed&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Database query error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;File upload violation&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Potential SQL injection&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>in_array</span><span class=p>(</span><span class=nv>$event</span><span class=p>,</span> <span class=nv>$criticalEvents</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>sendSecurityAlert</span><span class=p>(</span><span class=k>array</span> <span class=nv>$logData</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Send notification to security team
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// This could be email, Slack, or external security service
</span></span></span><span class=line><span class=cl><span class=c1></span>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>config</span><span class=p>(</span><span class=s1>&#39;security.alerts.email&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>Mail</span><span class=o>::</span><span class=na>to</span><span class=p>(</span><span class=nx>config</span><span class=p>(</span><span class=s1>&#39;security.alerts.email&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=o>-&gt;</span><span class=na>send</span><span class=p>(</span><span class=k>new</span> <span class=nx>SecurityAlertMail</span><span class=p>(</span><span class=nv>$logData</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Note: You need to create SecurityAlertMail class:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// php artisan make:mail SecurityAlertMail
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>isRapidRequests</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$ip</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$key</span> <span class=o>=</span> <span class=s2>&#34;rapid_requests:</span><span class=si>{</span><span class=nv>$ip</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$requests</span> <span class=o>=</span> <span class=nx>Cache</span><span class=o>::</span><span class=na>get</span><span class=p>(</span><span class=nv>$key</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>Cache</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=nv>$key</span><span class=p>,</span> <span class=nv>$requests</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>60</span><span class=p>);</span> <span class=c1>// Track for 1 minute
</span></span></span><span class=line><span class=cl><span class=c1></span>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$requests</span> <span class=o>&gt;</span> <span class=mi>100</span><span class=p>;</span> <span class=c1>// More than 100 requests per minute
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>isSuspiciousUserAgent</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$userAgent</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$suspiciousPatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/sqlmap/i&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/nmap/i&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/nikto/i&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/curl/i&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/wget/i&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/python/i&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$suspiciousPatterns</span> <span class=k>as</span> <span class=nv>$pattern</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=nv>$pattern</span><span class=p>,</span> <span class=nv>$userAgent</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>containsAttackPatterns</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$url</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$attackPatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/\.\./i&#39;</span><span class=p>,</span> <span class=c1>// Directory traversal
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=s1>&#39;/union\s+select/i&#39;</span><span class=p>,</span> <span class=c1>// SQL injection
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=s1>&#39;/&lt;script/i&#39;</span><span class=p>,</span> <span class=c1>// XSS
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=s1>&#39;/eval\(/i&#39;</span><span class=p>,</span> <span class=c1>// Code injection
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=s1>&#39;/base64_decode/i&#39;</span> <span class=c1>// Potential malicious code
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$attackPatterns</span> <span class=k>as</span> <span class=nv>$pattern</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=nv>$pattern</span><span class=p>,</span> <span class=nv>$url</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=10-production-deployment-security-checklist>10. Production Deployment Security Checklist</h2><p>Final security checklist for production deployment:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. Environment Configuration</span>
</span></span><span class=line><span class=cl>php artisan config:cache
</span></span><span class=line><span class=cl>php artisan route:cache
</span></span><span class=line><span class=cl>php artisan view:cache
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. File Permissions</span>
</span></span><span class=line><span class=cl>chmod <span class=m>644</span> .env
</span></span><span class=line><span class=cl>chmod -R <span class=m>755</span> storage
</span></span><span class=line><span class=cl>chmod -R <span class=m>755</span> bootstrap/cache
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Remove Development Tools</span>
</span></span><span class=line><span class=cl>composer install --no-dev --optimize-autoloader
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. Clear Sensitive Caches</span>
</span></span><span class=line><span class=cl>php artisan cache:clear
</span></span><span class=line><span class=cl>php artisan config:clear
</span></span><span class=line><span class=cl>php artisan route:clear
</span></span><span class=line><span class=cl>php artisan view:clear
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. Set Proper Directory Permissions</span>
</span></span><span class=line><span class=cl>find storage -type f -exec chmod <span class=m>644</span> <span class=o>{}</span> <span class=se>\;</span>
</span></span><span class=line><span class=cl>find storage -type d -exec chmod <span class=m>755</span> <span class=o>{}</span> <span class=se>\;</span>
</span></span></code></pre></div><p>Create a deployment security script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Console\Commands</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SecurityDeployCommand</span> <span class=k>extends</span> <span class=nx>Command</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=nv>$signature</span> <span class=o>=</span> <span class=s1>&#39;security:deploy&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=nv>$description</span> <span class=o>=</span> <span class=s1>&#39;Run security checks before deployment&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>()</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>info</span><span class=p>(</span><span class=s1>&#39;Running pre-deployment security checks...&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$checks</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Environment variables are secure&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Debug mode is disabled&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;APP_KEY is properly set&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Database credentials are secure&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;File permissions are correct&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Sensitive files are protected&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$checks</span> <span class=k>as</span> <span class=nv>$check</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>runSecurityCheck</span><span class=p>(</span><span class=nv>$check</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>line</span><span class=p>(</span><span class=s2>&#34;✓ </span><span class=si>{</span><span class=nv>$check</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s1>&#39;fg=green&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>line</span><span class=p>(</span><span class=s2>&#34;✗ </span><span class=si>{</span><span class=nv>$check</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s1>&#39;fg=red&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=s1>&#39;Security check failed. Deployment aborted.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>info</span><span class=p>(</span><span class=s1>&#39;All security checks passed. Ready for deployment.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>runSecurityCheck</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$check</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=p>(</span><span class=nv>$check</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=s1>&#39;Debug mode is disabled&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=o>!</span><span class=nx>config</span><span class=p>(</span><span class=s1>&#39;app.debug&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=s1>&#39;APP_KEY is properly set&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>config</span><span class=p>(</span><span class=s1>&#39;app.key&#39;</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>config</span><span class=p>(</span><span class=s1>&#39;app.key&#39;</span><span class=p>)</span> <span class=o>!==</span> <span class=s1>&#39;base64:your-secret-key-here&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>Security is not a one-time setup but an ongoing process that requires constant vigilance and updates. These best practices provide a solid foundation for securing your Laravel applications in production environments.</p><p>Regular security audits, monitoring, and staying updated with the latest security patches are essential for maintaining a secure application. Remember that security is only as strong as its weakest link, so ensure all team members understand and follow these practices.</p><p>The investment in proper security measures pays dividends in protecting your users&rsquo; data, maintaining trust, and avoiding costly security breaches. Start implementing these practices early in your development process rather than trying to retrofit security into an existing application.</p><p>Ready to build better Laravel applications? Master the art of <a href=/2025/09/clean-code-laravel-project-structure.html>Clean Code and Project Structure
</a>or supercharge your apps with our comprehensive <a href=/2025/09/laravel-performance-optimization-15-techniques.html>Performance Optimization Guide
</a>.</p></p><div class="bg-gray-100 dark:bg-gray-800 p-4 my-8 rounded"><h2 class="text-lg font-semibold mb-2">📌 Read Also</h2><ul class="list-disc list-outside ml-5"><li><a href=/2025/09/laravel-queue-jobs-background-processing-tutorial.html class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">Easy Background Processing Tutorial</a></li><li><a href=/2025/09/laravel-production-monitoring-error-tracking.html class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">Error Tracking Tools and Techniques</a></li><li><a href=/2025/09/laravel-octane-boost-performance-tutorial.html class="text-gray-900 dark:text-white hover:text-[#0f7ea9] no-underline">Boost Performance with High-Speed Application Server</a></li></ul></div><div class="hidden lg:block"><div class="my-8 py-6 border-t border-b border-gray-200 dark:border-gray-700"><div class="max-w-4xl mx-auto"><div class="text-center mb-3"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block;min-height:90px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></div><div class="block lg:hidden my-8 px-2 mb-10"><div class="text-center mb-2"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block;min-height:50px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><div class="lg:hidden mt-8 pt-8 border-t border-gray-200 dark:border-gray-700"><h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Popular Posts</h3><div class="grid gap-3"><a href=/2025/10/how-to-implement-message-queuing-with-rabbitmq-in-go.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Implement Message Queuing with RabbitMQ in Go</h4><p class="text-xs text-gray-500 dark:text-gray-400">20 Oct 2025</p></a><a href=/2025/10/how-to-build-ai-llm-applications-in-go-openai-and-ollama-integration.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Build AI/LLM Applications in Go - OpenAI and Ollama Integration</h4><p class="text-xs text-gray-500 dark:text-gray-400">18 Oct 2025</p></a><a href=/2025/10/how-to-handle-file-uploads-in-go-validation-storage-and-security.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Handle File Uploads in Go - Validation, Storage, and Security</h4><p class="text-xs text-gray-500 dark:text-gray-400">17 Oct 2025</p></a><a href=/2025/10/how-to-implement-cicd-for-go-applications-with-github-actions.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Implement CI/CD for Go Applications with GitHub Actions</h4><p class="text-xs text-gray-500 dark:text-gray-400">17 Oct 2025</p></a><a href=/2025/10/how-to-work-with-mysql-in-go-connection-pooling-and-transactions.html class="block py-2 hover:text-[#0f7ea9] transition no-underline"><h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1">How to Work with MySQL in Go - Connection Pooling and Transactions Guide</h4><p class="text-xs text-gray-500 dark:text-gray-400">17 Oct 2025</p></a></div></div><div class="my-8 py-6"><div class="max-w-4xl mx-auto"><div class="text-center mb-3"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block data-ad-format=autorelaxed data-ad-client=ca-pub-3149036684216973 data-ad-slot=7106179106></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><div class="not-prose my-12 -mx-4 sm:-mx-6 lg:mx-0"><div class=max-w-full><div class=mb-8><h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-2">Frequently Asked Questions</h2><p class="text-gray-600 dark:text-gray-400">Find quick answers to common questions</p></div><ul class="faq-list space-y-0 list-none p-0 m-0"><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">Is Laravel secure by default, or do I need additional security measures?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Laravel provides excellent security features out of the box: CSRF protection, SQL injection prevention via Eloquent, XSS protection in Blade, bcrypt password hashing, and encrypted cookies. However, you must configure these correctly and add production measures: disable debug mode (APP_DEBUG=false), set strong APP_KEY, use HTTPS, implement rate limiting, configure proper file permissions (storage/ and bootstrap/cache/ writable, .env at 600), and never commit secrets to Git. Laravel&rsquo;s security is strong when configured properly but requires production hardening.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">What's the difference between CSRF and XSS protection in Laravel?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>CSRF (Cross-Site Request Forgery) protects against malicious requests from other sites by validating tokens on state-changing requests (POST, PUT, DELETE). Laravel automatically adds @csrf to forms and validates tokens in VerifyCsrfToken middleware. XSS (Cross-Site Scripting) protects against injecting malicious scripts into your pages. Laravel&rsquo;s Blade {{ }} syntax automatically escapes output using htmlspecialchars(). Use {!! !!} only for trusted HTML. CSRF validates request origin; XSS sanitizes output. Both are essential and enabled by default.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">Should I encrypt my .env file in production?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>No, don&rsquo;t encrypt .env—instead, protect it with file permissions (chmod 600 .env) and ensure it&rsquo;s never committed to Git (.env in .gitignore by default). The .env file needs to be readable by PHP to load configs. For sensitive production secrets, use server environment variables instead of .env, or secret management services like AWS Secrets Manager, HashiCorp Vault, or Laravel Vapor Secrets. Keep .env outside web root, restrict file permissions to owner-only (600), and use separate .env files per environment. Never email or share .env files.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">What's the best way to protect API endpoints in Laravel?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Layer multiple protections: use Sanctum or Passport for token authentication, implement rate limiting (RateLimiter with throttle middleware at 60 requests/minute for general APIs, 5/minute for login), validate all inputs with Form Requests, add IP whitelisting for sensitive endpoints, use HTTPS only (force with middleware), log all API requests for monitoring, implement API versioning for controlled changes, and use scopes/abilities to limit token permissions. For public APIs, require API keys and rotate them periodically. Monitor for abuse patterns and block suspicious IPs automatically.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">Why should I never disable CSRF protection in Laravel?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>Disabling CSRF exposes your application to attacks where malicious sites can submit forms on behalf of authenticated users—stealing data, changing passwords, making purchases, or deleting accounts. Even if your app uses Vue/React SPA, use Sanctum&rsquo;s stateful authentication which maintains CSRF protection. Only exclude webhook endpoints receiving external POST requests (like /api/webhooks/*) from CSRF. For AJAX requests, include X-CSRF-TOKEN header. The performance overhead is negligible, and the security risk of disabling it is severe. If CSRF causes issues, fix the implementation rather than disabling protection.</div></div></details></li><li class="faq-item border-b border-gray-200 dark:border-gray-700" itemscope itemprop=mainEntity itemtype=https://schema.org/Question><details class=faq-details><summary class="cursor-pointer list-none py-5 md:py-6 flex items-start justify-between gap-6 select-none focus:outline-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-150" itemprop=name><h3 class="font-semibold text-base md:text-lg text-gray-900 dark:text-white leading-[1.6] m-0 flex-1">Is multi-factor authentication (2FA) necessary for Laravel applications?</h3><span class="faq-arrow flex-shrink-0 mt-1"><svg class="w-5 h-5 text-gray-600 dark:text-gray-400 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg></span></summary><div class="pb-6 pt-2" itemscope itemprop=acceptedAnswer itemtype=https://schema.org/Answer><div class="text-gray-700 dark:text-gray-300 leading-[1.7] text-[15px] md:text-base prose prose-gray dark:prose-invert max-w-none prose-p:my-2.5 prose-p:leading-[1.7] prose-code:bg-gray-100 dark:prose-code:bg-gray-700 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm prose-code:font-mono" itemprop=text>2FA is essential for admin panels, financial applications, and any app handling sensitive data or PII. For general applications, implement 2FA as optional for users but mandatory for admin/privileged accounts. Use established libraries like Google2FA (TOTP) or Laravel Fortify with 2FA features rather than building from scratch. 2FA dramatically reduces account takeover risk even if passwords are compromised. Store recovery codes encrypted, implement backup authentication methods (recovery codes, SMS), and require 2FA re-verification for sensitive operations like password changes or adding payment methods.</div></div></details></li></ul></div></div><script type=application/ld+json>{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"\"Is Laravel secure by default, or do I need additional security measures?\"","acceptedAnswer":{"@type":"Answer","text":"\"Laravel provides excellent security features out of the box: CSRF protection, SQL injection prevention via Eloquent, XSS protection in Blade, bcrypt password hashing, and encrypted cookies. However, you must configure these correctly and add production measures: disable debug mode (APP_DEBUG=false), set strong APP_KEY, use HTTPS, implement rate limiting, configure proper file permissions (storage/ and bootstrap/cache/ writable, .env at 600), and never commit secrets to Git. Laravel's security is strong when configured properly but requires production hardening.\""}},{"@type":"Question","name":"\"What's the difference between CSRF and XSS protection in Laravel?\"","acceptedAnswer":{"@type":"Answer","text":"\"CSRF (Cross-Site Request Forgery) protects against malicious requests from other sites by validating tokens on state-changing requests (POST, PUT, DELETE). Laravel automatically adds @csrf to forms and validates tokens in VerifyCsrfToken middleware. XSS (Cross-Site Scripting) protects against injecting malicious scripts into your pages. Laravel's Blade {{ }} syntax automatically escapes output using htmlspecialchars(). Use {!! !!} only for trusted HTML. CSRF validates request origin; XSS sanitizes output. Both are essential and enabled by default.\""}},{"@type":"Question","name":"\"Should I encrypt my .env file in production?\"","acceptedAnswer":{"@type":"Answer","text":"\"No, don't encrypt .env—instead, protect it with file permissions (chmod 600 .env) and ensure it's never committed to Git (.env in .gitignore by default). The .env file needs to be readable by PHP to load configs. For sensitive production secrets, use server environment variables instead of .env, or secret management services like AWS Secrets Manager, HashiCorp Vault, or Laravel Vapor Secrets. Keep .env outside web root, restrict file permissions to owner-only (600), and use separate .env files per environment. Never email or share .env files.\""}},{"@type":"Question","name":"\"What's the best way to protect API endpoints in Laravel?\"","acceptedAnswer":{"@type":"Answer","text":"\"Layer multiple protections: use Sanctum or Passport for token authentication, implement rate limiting (RateLimiter with throttle middleware at 60 requests/minute for general APIs, 5/minute for login), validate all inputs with Form Requests, add IP whitelisting for sensitive endpoints, use HTTPS only (force with middleware), log all API requests for monitoring, implement API versioning for controlled changes, and use scopes/abilities to limit token permissions. For public APIs, require API keys and rotate them periodically. Monitor for abuse patterns and block suspicious IPs automatically.\""}},{"@type":"Question","name":"\"Why should I never disable CSRF protection in Laravel?\"","acceptedAnswer":{"@type":"Answer","text":"\"Disabling CSRF exposes your application to attacks where malicious sites can submit forms on behalf of authenticated users—stealing data, changing passwords, making purchases, or deleting accounts. Even if your app uses Vue/React SPA, use Sanctum's stateful authentication which maintains CSRF protection. Only exclude webhook endpoints receiving external POST requests (like /api/webhooks/*) from CSRF. For AJAX requests, include X-CSRF-TOKEN header. The performance overhead is negligible, and the security risk of disabling it is severe. If CSRF causes issues, fix the implementation rather than disabling protection.\""}},{"@type":"Question","name":"\"Is multi-factor authentication (2FA) necessary for Laravel applications?\"","acceptedAnswer":{"@type":"Answer","text":"\"2FA is essential for admin panels, financial applications, and any app handling sensitive data or PII. For general applications, implement 2FA as optional for users but mandatory for admin/privileged accounts. Use established libraries like Google2FA (TOTP) or Laravel Fortify with 2FA features rather than building from scratch. 2FA dramatically reduces account takeover risk even if passwords are compromised. Store recovery codes encrypted, implement backup authentication methods (recovery codes, SMS), and require 2FA re-verification for sensitive operations like password changes or adding payment methods.\""}}]}</script><style>details.faq-details[open] .faq-arrow svg{transform:rotate(180deg)}</style><script>document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".faq-item");e.forEach(function(t){t.addEventListener("toggle",function(){this.open&&e.forEach(function(e){e!==t&&e.open&&(e.open=!1)})})})})</script></article><aside class="space-y-10 hidden lg:block"><div><h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Popular Posts</h3><ul class="space-y-3 list-disc list-outside pl-5 text-sm text-gray-800 dark:text-gray-200"><li><a href=/2025/10/how-to-implement-message-queuing-with-rabbitmq-in-go.html class="hover:text-[#0f7ea9] transition">How to Implement Message Queuing with RabbitMQ in Go</a></li><li><a href=/2025/10/how-to-build-ai-llm-applications-in-go-openai-and-ollama-integration.html class="hover:text-[#0f7ea9] transition">How to Build AI/LLM Applications in Go - OpenAI and Ollama Integration</a></li><li><a href=/2025/10/how-to-handle-file-uploads-in-go-validation-storage-and-security.html class="hover:text-[#0f7ea9] transition">How to Handle File Uploads in Go - Validation, Storage, and Security</a></li><li><a href=/2025/10/how-to-implement-cicd-for-go-applications-with-github-actions.html class="hover:text-[#0f7ea9] transition">How to Implement CI/CD for Go Applications with GitHub Actions</a></li><li><a href=/2025/10/how-to-work-with-mysql-in-go-connection-pooling-and-transactions.html class="hover:text-[#0f7ea9] transition">How to Work with MySQL in Go - Connection Pooling and Transactions Guide</a></li></ul></div></aside></div><section id=comments class=mt-12><script src=https://giscus.app/client.js data-repo=wikukarno/buanacoding data-repo-id=R_kgD0Oj4jAw data-category=General data-category-id=DIC_kwD0Oj4jA84Cr_fx data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></section></div></main><div class=py-6><div class="max-w-7xl mx-auto px-4"><div class="text-center mb-3"><span class="text-xs text-gray-400 dark:text-gray-500 uppercase tracking-wide font-medium">Advertisement</span></div><div class="flex justify-center"><ins class=adsbygoogle style=display:block;min-height:90px;max-width:100% data-ad-client=ca-pub-3149036684216973 data-ad-slot=3879195288 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><div class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-white py-4 transition-colors duration-300"><div class="text-center space-x-4 text-sm font-medium"><a href=/about class="hover:text-cyan-500 dark:hover:text-cyan-400">About</a>
<span>-</span>
<a href=/contact class="hover:text-cyan-500 dark:hover:text-cyan-400">Contact</a>
<span>-</span>
<a href=/privacy-policy class="hover:text-cyan-500 dark:hover:text-cyan-400">Privacy Policy</a>
<span>-</span>
<a href=/disclaimer class="hover:text-cyan-500 dark:hover:text-cyan-400">Disclaimer</a></div></div><footer class="text-center text-sm text-gray-500 dark:text-gray-400 py-4 border-t border-gray-200 dark:border-gray-700">&copy; 2025 buanacoding.com</footer><button id=scrollToTop class="fixed bottom-6 right-6 lg:bottom-6 lg:right-6 bg-[#0f7ea9] hover:bg-cyan-600 text-white p-3 rounded-full shadow transition duration-300 z-50" aria-label="Scroll to top">
<svg fill="none" class="w-4 h-4" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/></svg></button><style>body.floating-ad-active #scrollToTop{bottom:100px!important}@media(min-width:1024px){body.floating-ad-active #scrollToTop{bottom:1.5rem!important}}</style><div id=google_translate_element style=display:none></div><script src=https://unpkg.com/feather-icons></script><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.4.6></script><script>feather.replace();const btn=document.getElementById("scrollToTop"),html=document.documentElement,toggleBtn=document.getElementById("theme-toggle"),toggleBtnMobile=document.getElementById("theme-toggle-mobile"),iconSun=document.getElementById("icon-sun"),iconMoon=document.getElementById("icon-moon"),iconSunMobile=document.getElementById("icon-sun-mobile"),iconMoonMobile=document.getElementById("icon-moon-mobile");document.getElementById("menu-toggle")?.addEventListener("click",()=>{document.getElementById("mobile-menu")?.classList.toggle("hidden")}),btn.style.display="none",window.addEventListener("scroll",()=>{window.scrollY>300?btn.style.display="flex":btn.style.display="none"}),btn.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});function updateIcons(e){iconSun.classList.toggle("hidden",!e),iconMoon.classList.toggle("hidden",e),iconSunMobile.classList.toggle("hidden",!e),iconMoonMobile.classList.toggle("hidden",e)}function setDarkMode(e){html.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light"),updateIcons(e)}const userPref=localStorage.getItem("theme"),systemPref=window.matchMedia("(prefers-color-scheme: dark)").matches,isDark=userPref==="dark"||!userPref&&systemPref;setDarkMode(isDark),toggleBtn?.addEventListener("click",()=>{const e=html.getAttribute("data-theme")==="dark";setDarkMode(!e)}),toggleBtnMobile?.addEventListener("click",()=>{const e=html.getAttribute("data-theme")==="dark";setDarkMode(!e)}),document.querySelectorAll("pre").forEach(e=>{const t=document.createElement("button");t.innerHTML=`
      <span>Copy</span>
    `,t.className=`
    copy-btn absolute top-2 right-2
    text-xs px-2 py-1 rounded flex items-center gap-1
    transition-colors duration-200
    bg-gray-200 text-gray-800 hover:bg-gray-300
    dark:bg-white/10 dark:text-white dark:hover:bg-white/20
  `.trim();const n=document.createElement("div");n.className="relative",e.parentNode.insertBefore(n,e),n.appendChild(e),n.appendChild(t),t.addEventListener("click",()=>{const n=e.innerText;navigator.clipboard.writeText(n).then(()=>{t.querySelector("span").innerText="Copied!",setTimeout(()=>{t.querySelector("span").innerText="Copy"},2e3)})})});const openBtn=document.getElementById("openSearchModal"),closeBtn=document.getElementById("closeSearchModal"),modal=document.getElementById("searchModal");openBtn.addEventListener("click",()=>{console.log("Search modal opened"),modal.classList.remove("hidden"),document.getElementById("searchBox").focus()}),closeBtn.addEventListener("click",()=>{modal.classList.add("hidden")}),document.addEventListener("keydown",e=>{e.key==="Escape"&&modal.classList.add("hidden")}),fetch("/index.json").then(e=>e.json()).then(e=>{const n=new Fuse(e,{keys:["title","content"],threshold:.3}),s=document.getElementById("searchBox"),t=document.getElementById("results");s.addEventListener("input",function(e){const o=e.target.value.trim(),s=document.getElementById("searchAdBanner");if(o.length<2){t.innerHTML="",s&&(s.classList.remove("show"),s.classList.add("hide"),setTimeout(()=>s.style.display="none",300));return}s&&(s.style.display="block",s.classList.remove("hide"),s.classList.add("show"));const i=n.search(o);if(i.length===0)t.innerHTML=`
            <li class='px-4 py-3 text-center text-gray-500 dark:text-gray-400'>
              <div class="mb-2">📄 No results found for "${o}"</div>
              <div class="text-xs">Try different keywords or browse categories below</div>
            </li>
          `;else{let e="";i.forEach((t,n)=>{e+=`
              <li class="px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition">
                <a href="${t.item.href}" class="block font-semibold text-gray-900 dark:text-white no-underline">${t.item.title}</a>
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${t.item.content.substring(0,100)}...</p>
              </li>
            `,(n+1)%3===0&&n<i.length-1&&(e+=`
                <li class="px-4 py-2 bg-blue-50 dark:bg-gray-800 border-l-4 border-blue-400">
                  <div class="text-xs text-blue-600 dark:text-blue-400 font-medium">📚 More related articles</div>
                </li>
              `)}),t.innerHTML=e}})});const openBtnMobile=document.getElementById("openSearchModalMobile"),closeBtnMobile=document.getElementById("closeSearchModal"),modalMobile=document.getElementById("searchModal");openBtnMobile.addEventListener("click",()=>{console.log("Search modal opened (mobile)"),modalMobile.classList.remove("hidden"),document.getElementById("searchBox").focus()}),closeBtnMobile.addEventListener("click",()=>{modalMobile.classList.add("hidden")}),document.addEventListener("keydown",e=>{e.key==="Escape"&&modalMobile.classList.add("hidden")}),function(){function t(e,t){if(window.google&&window.google.translate&&window.google.translate.TranslateElement){e&&e();return}if(window.__gtReadyCallbacks=window.__gtReadyCallbacks||[],e&&window.__gtReadyCallbacks.push(e),window.__gtLoading)return;window.__gtLoading=!0,window.initGoogleTranslate=function(){try{new window.google.translate.TranslateElement({pageLanguage:"en",includedLanguages:"id",autoDisplay:!1},"google_translate_element")}catch{}(window.__gtReadyCallbacks||[]).forEach(function(e){try{e()}catch{}}),window.__gtReadyCallbacks=[]};var s,n=document.createElement("script");n.src="https://translate.google.com/translate_a/element.js?cb=initGoogleTranslate",n.defer=!0,s=!1,n.onerror=function(){s=!0,t&&t()},setTimeout(function(){(!window.google||!window.google.translate)&&(s=!0,t&&t())},4e3),document.head.appendChild(n)}function n(e,t){document.cookie=e+"="+t+"; path=/; expires="+new Date(Date.now()+365*24*3600*1e3).toUTCString()}function e(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"}function s(){if(document.getElementById("translate-fallback"))return;var e=document.createElement("div");e.id="translate-fallback",e.style.cssText="position:fixed;bottom:12px;left:50%;transform:translateX(-50%);z-index:9999;background:#111827;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 4px 16px rgba(0,0,0,0.25);display:flex;gap:10px;align-items:center;",e.innerHTML='<span style="font-size:13px">Auto-translate tidak tersedia di perangkat ini.</span><button id="btnTryId" style="background:#0ea5e9;color:#fff;border:none;padding:6px 10px;border-radius:8px;font-size:12px">Coba versi Indonesia</button><button id="btnCloseTf" style="background:transparent;color:#fff;border:1px solid #fff3;padding:6px 10px;border-radius:8px;font-size:12px">Tutup</button>',document.body.appendChild(e),document.getElementById("btnCloseTf").onclick=function(){e.remove()},document.getElementById("btnTryId").onclick=function(){var t=new URL(location.href),e=location.pathname;e.startsWith("/id/")||(t.pathname="/id"+(e.startsWith("/")?e:"/"+e)),fetch(t,{method:"HEAD"}).then(function(e){e.ok?location.href=t:location.href="/id/"}).catch(function(){location.href="/id/"})}}function o(e){t(function(){var t=document.querySelector(".goog-te-combo");t?(t.value=e,t.dispatchEvent(new Event("change"))):(n("googtrans","/en/"+e),location.reload())},s)}function i(){e("googtrans"),e("GOOGTRANS")}document.querySelectorAll(".js-lang-link").forEach(function(e){e.addEventListener("click",function(t){var n=e.getAttribute("data-lang"),s=e.getAttribute("data-has-trans")==="true";if(n==="en"){i();return}s||(t.preventDefault(),o(n))})})}()</script></body></html>